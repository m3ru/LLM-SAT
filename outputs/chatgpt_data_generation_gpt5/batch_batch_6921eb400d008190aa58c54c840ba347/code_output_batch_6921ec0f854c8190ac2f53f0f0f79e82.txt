{"id": "batch_req_6921ec794d148190bdda9d0c414b1652", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "b92c66e4c46d78aea14b92a39d737b3c", "body": {"id": "resp_0c260f1bb85f35b8006921ec717bf4819f8a70efe34d0b3ff5", "object": "response", "created_at": 1763830897, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0c260f1bb85f35b8006921ec71be20819f89e54d484731f56b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-based restart trigger\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    {\n      // Tie-break: if glue/decision rate also triggers, prefer that\n      // So, delay return and check glue+decision rate trigger first\n    }\n  else\n    {\n      // If conflict limit not reached, only glue/decision rate may fire\n      // fall through\n    }\n\n  // EWMA values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Static: store initial_decision_rate_ewma per stable/unstable mode\n  static double initial_decision_rate_ewma[2] = {0,0};\n\n  const int mode = solver->stable ? 1 : 0;\n\n  // On first call, initialize initial_decision_rate_ewma\n  if (initial_decision_rate_ewma[mode] == 0)\n    initial_decision_rate_ewma[mode] = decision_rate;\n\n  // Thresholds\n  const double glue_factor = solver->stable ? 1.1 : 1.2;\n  const double decision_rate_factor = 0.85;\n\n  bool glue_decision_trigger = false;\n  if (fast_glue > glue_factor * slow_glue &&\n      decision_rate < decision_rate_factor * initial_decision_rate_ewma[mode])\n    glue_decision_trigger = true;\n\n  // Tie-breaking: prefer glue/decision rate trigger\n  if (glue_decision_trigger)\n    {\n      kissat_extremely_verbose (solver,\n        \"adaptive restart: glue %.2f > %.2f*%.2f and decision-rate %.2f < %.2f*%.2f (initial %.2f)\",\n        fast_glue, glue_factor, slow_glue, decision_rate, decision_rate_factor, initial_decision_rate_ewma[mode], initial_decision_rate_ewma[mode]);\n      // After triggering, reset initial_decision_rate_ewma\n      initial_decision_rate_ewma[mode] = decision_rate;\n      return true;\n    }\n\n  // Otherwise, check conflict limit\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    {\n      kissat_extremely_verbose (solver,\n        \"adaptive restart: conflict limit %ld >= %ld\",\n        CONFLICTS, solver->limits.restart.conflicts);\n      return true;\n    }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 581, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1397}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec79414881909c5c038f7ffb659f", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "390417e01f37a803ec174ecdf21ba012", "body": {"id": "resp_0f2ae4cc216d2ec9006921ec15686c81a1b5c15dfbaae785f3", "object": "response", "created_at": 1763830805, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0f2ae4cc216d2ec9006921ec15b27081a191bb4e0425cb3ec6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Get current statistics and moving averages\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Static variable to store initial decision rate EWMA\n  static double initial_decision_rate_ewma = 0.0;\n  static bool initialized = false;\n\n  // Initialize the initial decision rate if not yet set\n  if (!initialized || !initial_decision_rate_ewma) {\n    initial_decision_rate_ewma = decision_rate;\n    initialized = true;\n  }\n\n  // Set glue margin multiplier\n  const double glue_margin = solver->stable ? 1.1 : 1.2;\n  const double rate_margin = 0.85;\n\n  // Compute glue and decision rate conditions\n  const bool glue_trigger = (fast_glue > glue_margin * slow_glue);\n  const bool rate_trigger = (decision_rate < rate_margin * initial_decision_rate_ewma);\n\n  // Prefer glue/decision trigger over conflict limit trigger\n  if (glue_trigger && rate_trigger) {\n    kissat_extremely_verbose (solver,\n      \"adaptive glue-rate hybrid restart: fast_glue %.2f > %.2f * slow_glue %.2f AND \"\n      \"decision_rate %.2f < %.2f * initial_decision_rate %.2f\",\n      fast_glue, glue_margin, slow_glue, decision_rate, rate_margin, initial_decision_rate_ewma);\n\n    // Reset the initial decision rate after restart\n    initial_decision_rate_ewma = decision_rate;\n    return true;\n  }\n\n  // Conflict limit trigger (lower priority)\n  if (conflicts >= conflict_limit) {\n    kissat_extremely_verbose (solver,\n      \"adaptive glue-rate hybrid restart: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n      conflicts, conflict_limit);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 496, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1312}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec7945bc8190aa0ecf11f12e69fa", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "e0a9a3f376ea355bcc2f5b3d28e3f93f", "body": {"id": "resp_05c4692a2bf0ef76006921ec1a56c4819188b251bca12f4a70", "object": "response", "created_at": 1763830810, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_05c4692a2bf0ef76006921ec1a93cc81918e36bb4b52386aaf", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n  // Compute fast and slow glue, and decision rate\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Store and update initial_decision_rate_ewma in solver struct\n  // We assume solver->initial_decision_rate is present and initialized on solver creation\n  double *initial_decision_rate = &solver->initial_decision_rate;\n\n  const double glue_margin = solver->stable ? 1.1 : 1.2;\n  const double rate_margin = 0.85;\n\n  bool glue_decision_trigger = false;\n  if ((fast_glue > glue_margin * slow_glue) && (decision_rate < rate_margin * (*initial_decision_rate)))\n    glue_decision_trigger = true;\n\n  bool conflict_trigger = (conflicts >= conflict_limit);\n\n  // Tie-breaking: prefer glue/decision trigger, then conflict, then level, then earliest\n  if (glue_decision_trigger)\n  {\n    kissat_extremely_verbose (\n      solver,\n      \"restart: glue-dec-rate triggered: fast_glue %g > %.2f * slow_glue %g and decision_rate %g < %.2f * initial_decision_rate %g\",\n      fast_glue, glue_margin, slow_glue, decision_rate, rate_margin, *initial_decision_rate);\n\n    // Reset the initial_decision_rate_ewma to current value after restart\n    *initial_decision_rate = decision_rate;\n    return true;\n  }\n\n  if (conflict_trigger)\n  {\n    kissat_extremely_verbose (\n      solver,\n      \"restart: conflict triggered: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n      conflicts, conflict_limit);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 472, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1288}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec7943d48190a56c664ff4cbdf9f", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "f7253c80e63e39fa4000ad72d9e13eea", "body": {"id": "resp_000037f461bf0021006921ec1fd71081a2ae157d7e7e3cee6b", "object": "response", "created_at": 1763830815, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_000037f461bf0021006921ec20216081a2938f9d1d76412704", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather relevant values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Use an initial decision rate for reference (store in solver struct)\n  double *initial_decision_rate_ptr = &solver->initial_decision_rate_ewma;\n  if (*initial_decision_rate_ptr <= 0)\n    *initial_decision_rate_ptr = decision_rate;\n  const double initial_decision_rate = *initial_decision_rate_ptr;\n\n  // Compute glue/decision rate triggers\n  const double glue_margin = solver->stable ? 1.1 : 1.2;\n  const double rate_margin = 0.85;\n  bool glue_triggered = (fast_glue > glue_margin * slow_glue);\n  bool rate_triggered = (decision_rate < rate_margin * initial_decision_rate);\n\n  // Conflict limit trigger\n  bool conflict_triggered = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Tie-breaking: prefer glue/decision rate trigger if both fire\n  if ((glue_triggered && rate_triggered) ||\n      (glue_triggered && conflict_triggered && rate_triggered))\n  {\n    kissat_extremely_verbose (solver,\n      \"adaptive glue-rate restart: fast_glue %g > %g * slow_glue %g and decision_rate %g < %g * initial_decision_rate %g\",\n      fast_glue, glue_margin, slow_glue, decision_rate, rate_margin, initial_decision_rate);\n    *initial_decision_rate_ptr = decision_rate;\n    return true;\n  }\n\n  // If only conflict trigger fires, check tie-breaking: prefer glue/rate, else restart if level > 0\n  if (conflict_triggered)\n  {\n    kissat_extremely_verbose (solver,\n      \"adaptive restart: conflict limit %ld reached (conflicts %ld, limit %ld)\",\n      solver->limits.restart.conflicts, CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  // If only glue/rate trigger fires (possibly in stable phase with reduced margin)\n  if (glue_triggered && rate_triggered)\n  {\n    kissat_extremely_verbose (solver,\n      \"adaptive glue-rate restart: fast_glue %g > %g * slow_glue %g and decision_rate %g < %g * initial_decision_rate %g\",\n      fast_glue, glue_margin, slow_glue, decision_rate, rate_margin, initial_decision_rate);\n    *initial_decision_rate_ptr = decision_rate;\n    return true;\n  }\n\n  // Stable phase: fallback to reluctant\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 647, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1463}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec79439881908bbc373bf114e621", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "e35b869c53be94d73585ca2607ecf3e1", "body": {"id": "resp_08c5a0e23d9d3af3006921ec261ee4819f978cf3c8830e5431", "object": "response", "created_at": 1763830822, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08c5a0e23d9d3af3006921ec2658c8819fa36c4ed77a4fb497", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Fetch current conflict and decision statistics\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n  // Decision rate moving average\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Store initial decision rate in solver struct if not set\n  if (solver->initial_decision_rate_ewma < 0)\n    solver->initial_decision_rate_ewma = decision_rate;\n\n  double initial_decision_rate = solver->initial_decision_rate_ewma;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // Compute glue thresholds depending on stable/unstable\n  const double glue_factor = solver->stable ? 1.1 : 1.2;\n  const double glue_limit = glue_factor * slow_glue;\n\n  // Decision rate threshold\n  const double decision_rate_limit = 0.85 * initial_decision_rate;\n\n  // Glue+decision trigger\n  bool glue_decision_trigger = (fast_glue > glue_limit) &&\n                               (decision_rate < decision_rate_limit);\n\n  // Conflict trigger\n  bool conflict_trigger = (conflicts >= conflict_limit);\n\n  // Prefer glue/decision trigger if both fire\n  if (glue_decision_trigger) {\n    // Reset initial decision rate to current for next period\n    solver->initial_decision_rate_ewma = decision_rate;\n    kissat_extremely_verbose (solver,\n      \"restart (glue/decision trigger): fast_glue=%.2f slow_glue=%.2f (limit=%.2f) decision_rate=%.2f (limit=%.2f)\",\n      fast_glue, slow_glue, glue_limit, decision_rate, decision_rate_limit);\n    return solver->level > 0;\n  }\n\n  if (conflict_trigger) {\n    kissat_extremely_verbose (solver,\n      \"restart (conflict trigger): conflicts=%\" PRIu64 \" limit=%\" PRIu64, conflicts, conflict_limit);\n    return solver->level > 0;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 504, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1320}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec7944088190bae180a3f2131568", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "98ada25b76fba22a5197757959bbc7e7", "body": {"id": "resp_0658d68247f3fc58006921ec2b617481a29fbb79192f0fa755", "object": "response", "created_at": 1763830827, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0658d68247f3fc58006921ec2badf081a28dcd8288ab269927", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n  const bool conflict_limit_trigger = (conflicts >= conflict_limit);\n\n  // Get averages\n  const double fast_glue = solver->averages[solver->stable].fast_glue.value;\n  const double slow_glue = solver->averages[solver->stable].slow_glue.value;\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Track/reset initial_decision_rate_ewma on first call or after restart\n  static double initial_decision_rate_ewma = 0.0;\n  static uint64_t last_restart_conflicts = 0;\n  if (!initial_decision_rate_ewma || last_restart_conflicts != conflict_limit) {\n    initial_decision_rate_ewma = decision_rate;\n    last_restart_conflicts = conflict_limit;\n  }\n\n  // Hybrid glue/decision trigger\n  const double glue_margin = solver->stable ? 1.1 : 1.2;\n  const double rate_margin = 0.85;\n  const bool glue_condition = (fast_glue > glue_margin * slow_glue);\n  const bool rate_condition = (decision_rate < rate_margin * initial_decision_rate_ewma);\n  const bool glue_rate_trigger = glue_condition && rate_condition;\n\n  // Tie-breaking: prefer glue/decision trigger, then conflict limit, then level > 0\n  if (glue_rate_trigger) {\n    initial_decision_rate_ewma = decision_rate; // reset after trigger\n    return true;\n  }\n  if (conflict_limit_trigger)\n    return true;\n  if (solver->level > 0)\n    return false;\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 429, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1245}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec79469c8190823013acaaa89c44", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "bc3875780671aa2dded21749aa093aa9", "body": {"id": "resp_0548594bc1f0bee4006921ec513984819eba33620a4a2b8483", "object": "response", "created_at": 1763830865, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0548594bc1f0bee4006921ec517644819e9e0ce6e00e405c3f", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  const uint64_t conflicts = CONFLICTS;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n  // Read glue averages and decision rate average for current stage\n  const int mode = solver->stable;\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // We need to store and use the initial decision rate EWMA (per stage)\n  double *initial_decision_rate_ptr = &solver->averages[mode].initial_decision_rate;\n  double initial_decision_rate = *initial_decision_rate_ptr;\n\n  // On first call, or if initial_decision_rate is zero, set it\n  if (initial_decision_rate == 0.0) {\n    *initial_decision_rate_ptr = decision_rate;\n    initial_decision_rate = decision_rate;\n  }\n\n  // Compute restart thresholds\n  const double glue_factor = mode ? 1.1 : 1.2;\n  const double dr_factor = 0.85;\n\n  bool glue_decision_trigger =\n    (fast_glue > glue_factor * slow_glue) &&\n    (decision_rate < dr_factor * initial_decision_rate);\n\n  // Tie-breaking: glue/decision trigger preferred\n  if (glue_decision_trigger) {\n    kissat_extremely_verbose(\n      solver,\n      \"restarting: glue/decision trigger (fast_glue %.2f > %.2f * slow_glue %.2f, decision_rate %.2f < %.2f * initial_decision_rate %.2f)\",\n      fast_glue, glue_factor, slow_glue, decision_rate, dr_factor, initial_decision_rate\n    );\n    // Reset initial_decision_rate after restart as per algorithm\n    *initial_decision_rate_ptr = decision_rate;\n    return true;\n  }\n\n  // Otherwise, check conflict limit\n  if (conflicts >= conflict_limit) {\n    kissat_extremely_verbose(\n      solver,\n      \"restarting: conflict limit trigger (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      conflicts, conflict_limit\n    );\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 517, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1333}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec7944e48190af05075625ab9969", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "9a7a254b0547bd0b6d5043ba8736db64", "body": {"id": "resp_0b4fd0d1ea2a6ece006921ec30372081a294788acfe29c5e45", "object": "response", "created_at": 1763830832, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0b4fd0d1ea2a6ece006921ec307ed081a2affb2d88ac4e933f", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Always allow restart if conflict limit reached, but glue/decision triggers take precedence\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n  double *initial_decision_rate_ptr = &solver->initial_decision_rate_ewma;\n\n  // Initialize initial_decision_rate_ewma if never set\n  if (*initial_decision_rate_ptr <= 0.0)\n    *initial_decision_rate_ptr = decision_rate;\n\n  const double glue_threshold = solver->stable ? 1.1 : 1.2;\n  const double rate_threshold = 0.85;\n\n  bool glue_trigger =\n      (fast_glue > glue_threshold * slow_glue) &&\n      (decision_rate < rate_threshold * (*initial_decision_rate_ptr));\n\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  if (glue_trigger) {\n    kissat_extremely_verbose(\n        solver,\n        \"adaptive glue-rate hybrid restart: fast_glue %g > %g * slow_glue %g AND decision_rate %g < %g * initial_decision_rate %g\",\n        fast_glue, glue_threshold, slow_glue, decision_rate, rate_threshold,\n        *initial_decision_rate_ptr);\n    *initial_decision_rate_ptr = decision_rate; // Reset after glue-based restart\n    return true;\n  }\n\n  if (conflict_trigger) {\n    kissat_extremely_verbose(\n        solver,\n        \"adaptive glue-rate hybrid restart: conflict limit reached (%\" PRIu64\n        \" >= %\" PRIu64 \")\",\n        CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 424, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1240}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec7945788190bb75f2b51451d655", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "99d77611b1a68655d0b6c6fdfeef7e6c", "body": {"id": "resp_0326270cfbc9eedd006921ec56fcec819cb691f18ffaa019e1", "object": "response", "created_at": 1763830870, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0326270cfbc9eedd006921ec574cdc819cb159633863eaace0", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Alias for stats and averages\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // We need an initial EWMA of decision rate to compare against.\n  // Store in solver->initial_decision_rate if not already set\n  if (!solver->initial_decision_rate_set) {\n    solver->initial_decision_rate = decision_rate;\n    solver->initial_decision_rate_set = true;\n  }\n\n  // Select margin for glue comparison based on stable/unstable\n  const double glue_margin = solver->stable ? 1.1 : 1.2;\n  const double rate_margin = 0.85;\n\n  // Glue/rate trigger\n  bool glue_rate_trigger = false;\n  if (fast_glue > glue_margin * slow_glue &&\n      decision_rate < rate_margin * solver->initial_decision_rate) {\n    glue_rate_trigger = true;\n  }\n\n  // Conflict trigger\n  bool conflict_trigger = conflicts >= conflict_limit;\n\n  // Tie-breaking: glue/rate trigger preferred if both fire\n  if (glue_rate_trigger) {\n    kissat_extremely_verbose (solver,\n      \"adaptive glue-rate restart: fast_glue %.2f > %.2f*slow_glue %.2f\"\n      \" and decision_rate %.2f < %.2f*initial_decision_rate %.2f\",\n      fast_glue, glue_margin, slow_glue,\n      decision_rate, rate_margin, solver->initial_decision_rate\n    );\n\n    // After restart, reset initial decision rate EWMA\n    solver->initial_decision_rate = decision_rate;\n    return true;\n  }\n\n  if (conflict_trigger) {\n    kissat_extremely_verbose (solver,\n      \"conflict restart: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n      conflicts, conflict_limit\n    );\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 498, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1314}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec7942388190bc86d29da0702bdd", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "7116703a8b49e107d5776601fa4e0371", "body": {"id": "resp_0c1692f8d705f14e006921ec35451881a3804eef1f2d1d9c02", "object": "response", "created_at": 1763830837, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0c1692f8d705f14e006921ec35980481a38c26db6d35899487", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger\n  bool conflict_limit_triggered =\n    (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Gather averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Static storage for initial_decision_rate_ewma\n  static double initial_decision_rate_ewma = 0.0;\n  static bool initialized = false;\n\n  // Initialize initial_decision_rate_ewma on first call or after restart\n  if (!initialized || solver->statistics.conflicts == 0)\n  {\n    initial_decision_rate_ewma = decision_rate;\n    initialized = true;\n  }\n\n  // Compute glue/decision rate trigger\n  // Thresholds differ between stable/unstable\n  const double glue_factor = solver->stable ? 1.1 : 1.2;\n  const double decision_factor = 0.85;\n\n  bool glue_triggered =\n    (fast > glue_factor * slow) &&\n    (decision_rate < decision_factor * initial_decision_rate_ewma);\n\n  // If both triggers fire, prefer glue/decision rate trigger\n  if (glue_triggered)\n  {\n    kissat_extremely_verbose (solver,\n      \"restart by glue/decision rate: fast_glue %.2f > %.2f * slow_glue %.2f, decision_rate %.2f < %.2f * initial_decision_rate %.2f\",\n      fast, glue_factor, slow, decision_rate, decision_factor, initial_decision_rate_ewma);\n\n    // After triggering, reset initial_decision_rate_ewma\n    initial_decision_rate_ewma = decision_rate;\n    return true;\n  }\n\n  // Otherwise, check for conflict limit\n  if (conflict_limit_triggered)\n  {\n    kissat_extremely_verbose (solver,\n      \"restart by conflict limit: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 495, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1311}, "user": null, "metadata": {}}}, "error": null}
