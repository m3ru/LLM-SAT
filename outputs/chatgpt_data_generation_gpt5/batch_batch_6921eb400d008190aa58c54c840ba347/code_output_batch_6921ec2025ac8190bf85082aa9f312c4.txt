{"id": "batch_req_6921ec66bac881909085e4171da7c914", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "37c14890983cec71cf928b617468e53b", "body": {"id": "resp_03fe8f235a494607006921ec2439608196bec36bfcb6533670", "object": "response", "created_at": 1763830820, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_03fe8f235a494607006921ec24847881969722c9ada19d81d5", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // AGDR parameters\n  double T_low = 0.9, T_high = 1.2;\n\n  // In stable stage, thresholds are less aggressive\n  if (solver->stable) {\n    T_low *= 1.05;\n    T_high *= 1.05;\n  }\n\n  // Compute fast/slow glue ratio\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Prevent division by zero\n  if (slow == 0.0)\n    return false;\n\n  const double R = fast / slow;\n\n  // Enforce minimum interval between restarts\n  static uint64_t last_restart_conflict = 0;\n  const uint64_t MIN_INTERVAL = 50;\n  uint64_t conflicts = CONFLICTS;\n\n  // Only restart if minimum interval has passed\n  if (conflicts < last_restart_conflict + MIN_INTERVAL)\n    return false;\n\n  // AGDR restart logic\n  if (R < T_low) {\n    // Making progress, do NOT restart\n    return false;\n  } else if (R > T_high) {\n    // Stagnating: trigger restart, update last_restart_conflict\n    kissat_extremely_verbose (\n      solver,\n      \"AGDR restart: glue ratio R=%.3f > T_high=%.3f (fast_glue=%.3f, slow_glue=%.3f)\",\n      R, T_high, fast, slow\n    );\n    last_restart_conflict = conflicts;\n    return true;\n  }\n\n  // Tie-breaker: Also restart if both R > T_high and conflicts exceeds conflict limit\n  if (R > T_high && conflicts >= solver->limits.restart.conflicts) {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDR tie-breaker restart: glue ratio R=%.3f > T_high=%.3f and conflicts=%\" PRIu64 \" >= limit=%\" PRIu64,\n      R, T_high, conflicts, solver->limits.restart.conflicts\n    );\n    last_restart_conflict = conflicts;\n    return true;\n  }\n\n  // Fallback: restart due to classic conflict limit (if glue ratio doesn't trigger)\n  if (conflicts >= solver->limits.restart.conflicts) {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDR classic restart: conflicts=%\" PRIu64 \" >= limit=%\" PRIu64,\n      conflicts, solver->limits.restart.conflicts\n    );\n    last_restart_conflict = conflicts;\n    return true;\n  }\n\n  // Otherwise, do not restart\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 599, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1961}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec66c88c8190a77849e0ce8ff8dc", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "8575271d631e19df63048cc9ed3defd0", "body": {"id": "resp_0f3bfa61f604673a006921ec292ae08194b22573bce71758d7", "object": "response", "created_at": 1763830825, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0f3bfa61f604673a006921ec29606c8194b78fbeed16ec0bda", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // AGDR parameters\n  const double base_t_low = 0.9, base_t_high = 1.2;\n  double t_low = base_t_low, t_high = base_t_high;\n  if (solver->stable) {\n    t_low *= 1.05;\n    t_high *= 1.05;\n  }\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Avoid division by zero (should not happen, but just in case)\n  if (slow <= 0.0)\n    return false;\n\n  const double ratio = fast / slow;\n\n  // Minimum conflict interval between restarts\n  static const uint64_t min_restart_interval = 50;\n  static uint64_t last_restart_conflicts = 0; // persists across calls\n\n  const uint64_t curr_conflicts = CONFLICTS;\n  bool recently_restarted = (curr_conflicts < last_restart_conflicts + min_restart_interval);\n\n  // Verbose reporting\n  kissat_extremely_verbose (solver,\n    \"AGDR: ratio fast/slow glue = %g, thresholds [%g, %g]%s, last_restart at %\" PRIu64,\n    ratio, t_low, t_high,\n    solver->stable ? \" (stable stage)\" : \"\",\n    last_restart_conflicts);\n\n  // Progress: lower recent glue, don't restart\n  if (ratio < t_low)\n    return false;\n\n  // Stagnation: higher recent glue, consider restart\n  if (ratio > t_high && !recently_restarted) {\n    kissat_extremely_verbose (solver,\n      \"AGDR: triggering restart (ratio %g > %g, conflicts since last restart: %\" PRIu64 \")\",\n      ratio, t_high, curr_conflicts - last_restart_conflicts);\n    last_restart_conflicts = curr_conflicts;\n    return true;\n  }\n\n  // Tie-breaker: if both ratio and conflict limit reached, prefer glue ratio\n  if (ratio > t_high && curr_conflicts >= solver->limits.restart.conflicts && !recently_restarted) {\n    last_restart_conflicts = curr_conflicts;\n    return true;\n  }\n\n  // Fallback: classic conflict limit (if not recently restarted)\n  if (curr_conflicts >= solver->limits.restart.conflicts && !recently_restarted) {\n    last_restart_conflicts = curr_conflicts;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 565, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1927}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec66b8a48190b72cedc306e6206b", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "20e33483b33160470cd7b58fb3990f92", "body": {"id": "resp_05724c396efbe383006921ec2e21ac81909c5d734803690021", "object": "response", "created_at": 1763830830, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_05724c396efbe383006921ec2e6a948190bf0bef2c1b5b9fe0", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Adaptive Glue Decay Restart (AGDR) parameters\n  double t_low  = 0.9;\n  double t_high = 1.2;\n\n  // If stable stage, relax thresholds by 1.05\n  if (solver->stable)\n  {\n    t_low  *= 1.05;\n    t_high *= 1.05;\n  }\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Avoid division by zero\n  if (slow == 0.0)\n    return false;\n\n  const double ratio = fast / slow;\n\n  // Enforce minimum interval of 50 conflicts between restarts\n  static uint64_t last_restart_conflict = 0;\n  const uint64_t current_conflict = solver->statistics.conflicts;\n  const uint64_t conflicts_since_last_restart = current_conflict - last_restart_conflict;\n  const uint64_t min_conflicts_between_restarts = 50;\n\n  // Only restart if enough conflicts have passed since last restart\n  bool min_interval_ok = (conflicts_since_last_restart >= min_conflicts_between_restarts);\n\n  // AGDR logic:\n  // - If ratio > t_high, consider restart (if interval ok)\n  // - If ratio < t_low, do NOT restart (making progress)\n  // - If in between, fall back to original policy (conflict limit, etc.)\n\n  if (ratio > t_high && min_interval_ok)\n  {\n    last_restart_conflict = current_conflict;\n    kissat_extremely_verbose (solver,\n      \"AGDR restart: ratio %.3f > high threshold %.3f (fast %.2f, slow %.2f), min interval OK\",\n      ratio, t_high, fast, slow);\n    return true;\n  }\n\n  if (ratio < t_low)\n  {\n    kissat_extremely_verbose (solver,\n      \"AGDR skip restart: ratio %.3f < low threshold %.3f (fast %.2f, slow %.2f), progress being made\",\n      ratio, t_low, fast, slow);\n    return false;\n  }\n\n  // If not decided by AGDR, fall back to conflict limit or, if stable, reluctant trigger.\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // Default margin-based policy for the non-stable phase\n  const double margin = (100.0 + GET_OPTION (restartmargin)) / 100.0;\n  const double limit = margin * slow;\n  kissat_extremely_verbose (solver,\n    \"fallback restart: glue limit %g = %.2f * %g (slow glue) %c %g (fast glue)\",\n    limit, margin, slow,\n    (limit > fast    ? '>'\n     : limit == fast ? '='\n                     : '<'),\n    fast);\n  return (limit <= fast);\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 680, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 2042}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec66b9b88190829791acd0ef80cd", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "ad5362e4e573c61919e923d3439306eb", "body": {"id": "resp_09d382e87dbf7b5b006921ec6146e481958635a30b801b4251", "object": "response", "created_at": 1763830881, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_09d382e87dbf7b5b006921ec61786c8195a2ce1c758f5b96bb", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // AGDR: Adaptive Glue Decay Restart\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Avoid division by zero\n  if (slow <= 0.0)\n    return false;\n\n  const double ratio = fast / slow;\n\n  // Default thresholds\n  double t_low = 0.9, t_high = 1.2;\n\n  // If in stable phase, thresholds are less aggressive\n  if (solver->stable) {\n    t_low *= 1.05;\n    t_high *= 1.05;\n  }\n\n  // Minimum interval between restarts (hard-coded as 50 conflicts)\n  static uint64_t last_restart_conflicts = 0;\n  const uint64_t min_interval = 50;\n  uint64_t current_conflicts = solver->statistics.conflicts;\n\n  // Only update last_restart_conflicts if a restart actually happens\n  bool restart_due_to_ratio = false;\n  bool restart_due_to_conflicts = false;\n\n  // AGDR logic\n  if (ratio > t_high) {\n    if (current_conflicts >= last_restart_conflicts + min_interval) {\n      restart_due_to_ratio = true;\n    }\n  } else if (ratio < t_low) {\n    // Making progress, do not restart\n    return false;\n  }\n\n  // Standard \"conflicts\" based restart as tie-breaker\n  if (!restart_due_to_ratio && current_conflicts >= solver->limits.restart.conflicts) {\n    if (solver->stable)\n      restart_due_to_conflicts = kissat_reluctant_triggered (&solver->reluctant);\n    else\n      restart_due_to_conflicts = true;\n  }\n\n  // Logging for AGDR\n  kissat_extremely_verbose (solver,\n    \"AGDR restart: ratio=%.3f (fast/slow), thresholds [%.3f, %.3f], stable=%d, last_restart=%\" PRIu64 \", now=%\" PRIu64,\n    ratio, t_low, t_high, solver->stable, last_restart_conflicts, current_conflicts);\n\n  if (restart_due_to_ratio || restart_due_to_conflicts) {\n    last_restart_conflicts = current_conflicts;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 528, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1890}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec66b6d881909e936724037c8c34", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "289d47fe22b00f51d547d31264be1b71", "body": {"id": "resp_0a80671465a1f16d006921ec3384b48196a5a335a375dcce81", "object": "response", "created_at": 1763830835, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0a80671465a1f16d006921ec33c6dc81969c20f1b87ff9427c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Enforce minimum interval between restarts\n    static uint64_t last_restart_conflicts = 0;\n    const uint64_t min_conflicts_between_restarts = 50;\n    uint64_t current_conflicts = solver->statistics.conflicts;\n\n    // Fast and slow glue averages, always available\n    const double fast = AVERAGE(fast_glue);\n    const double slow = AVERAGE(slow_glue);\n\n    // Avoid division by zero\n    if (slow <= 0.0)\n        return false;\n\n    const double ratio = fast / slow;\n\n    // AGDR thresholds\n    double t_low = 0.9, t_high = 1.2;\n    if (solver->stable) {\n        t_low *= 1.05;\n        t_high *= 1.05;\n    }\n\n    // Only allow restart if enough conflicts passed since last restart\n    if (current_conflicts < last_restart_conflicts + min_conflicts_between_restarts)\n        return false;\n\n    // AGDR policy\n    if (ratio < t_low)\n        return false;\n\n    if (ratio > t_high) {\n        last_restart_conflicts = current_conflicts;\n        kissat_extremely_verbose(solver,\n            \"AGDR restart: ratio %.4f > T_high %.4f (fast %.2f / slow %.2f), at %llu conflicts\",\n            ratio, t_high, fast, slow, current_conflicts);\n        return true;\n    }\n\n    // Standard fallback: restart if conflict limit passed, if ratio is not low\n    if (current_conflicts >= solver->limits.restart.conflicts) {\n        last_restart_conflicts = current_conflicts;\n        kissat_extremely_verbose(solver,\n            \"AGDR fallback restart: conflict limit %llu reached at %llu\",\n            solver->limits.restart.conflicts, current_conflicts);\n        return true;\n    }\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 444, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1806}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec66bc088190bddbb8656c3059cf", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "b311a6309e510f2b9e354c95c29466c8", "body": {"id": "resp_0458d364078495b2006921ec3897e081938838fff2c861b8a1", "object": "response", "created_at": 1763830840, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0458d364078495b2006921ec3907a881938c8c91293de391ad", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Enforce minimum interval between restarts\n  static uint64_t last_restart_conflicts = 0;\n  const uint64_t current_conflicts = solver->statistics.conflicts;\n  const uint64_t min_restart_interval = 50;\n  if (current_conflicts < last_restart_conflicts + min_restart_interval)\n    return false;\n\n  // Get averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  if (slow <= 0.0) // Avoid division by zero or negative slow\n    return false;\n\n  const double ratio = fast / slow;\n\n  // Base thresholds\n  double t_low = 0.9, t_high = 1.2;\n\n  // Relax thresholds in stable phase\n  if (solver->stable) {\n    t_low *= 1.05;\n    t_high *= 1.05;\n  }\n\n  // Restart if ratio > t_high (stagnation)\n  if (ratio > t_high) {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDR restart: ratio %g > high threshold %.3f (fast glue %g / slow glue %g)\",\n      ratio, t_high, fast, slow);\n    last_restart_conflicts = current_conflicts;\n    return true;\n  }\n\n  // No restart if making progress\n  if (ratio < t_low) {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDR: making progress, ratio %g < low threshold %.3f (fast glue %g / slow glue %g)\",\n      ratio, t_low, fast, slow);\n    return false;\n  }\n\n  // Tie-breaker: if above conflict limit and in between thresholds, restart\n  if (current_conflicts >= solver->limits.restart.conflicts) {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDR: conflict limit hit (%\" PRIu64 \" >= %\" PRIu64 \"), restart\",\n      current_conflicts, solver->limits.restart.conflicts);\n    last_restart_conflicts = current_conflicts;\n    return true;\n  }\n\n  // Otherwise, do not restart\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 502, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1864}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec66bd848190adde3627b1678f17", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "26135f1956db957a574423b8bdc08c88", "body": {"id": "resp_06133e39caca4bda006921ec2442f081968c89a3ddd16dd9be", "object": "response", "created_at": 1763830820, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_06133e39caca4bda006921ec248ff08196a992cafaf694686e", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Adaptive Glue Decay Restart (AGDR) parameters\n  const double T_LOW_BASE = 0.9, T_HIGH_BASE = 1.2;\n  const double STABLE_FACTOR = 1.05;\n  double t_low = T_LOW_BASE, t_high = T_HIGH_BASE;\n  if (solver->stable) {\n    t_low *= STABLE_FACTOR;\n    t_high *= STABLE_FACTOR;\n  }\n\n  // Compute the ratio R = fast_glue / slow_glue\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  double ratio = (slow > 0.0) ? (fast / slow) : 0.0;\n\n  // Enforce minimum interval between restarts\n  static uint64_t last_restart_conflicts = 0;\n  const uint64_t MIN_INTERVAL = 50;\n  uint64_t conflicts = CONFLICTS;\n  uint64_t interval = conflicts - last_restart_conflicts;\n\n  // Check for restart trigger\n  bool restart = false;\n  if (ratio > t_high && interval >= MIN_INTERVAL) {\n    restart = true;\n  } else if (conflicts >= solver->limits.restart.conflicts && interval >= MIN_INTERVAL) {\n    // Prefer restarting due to glue ratio if both triggers fire, but allow conflict limit as fallback\n    restart = (ratio > t_high) || (ratio >= t_low && ratio <= t_high);\n  }\n\n  // Only perform restart if not making rapid progress\n  if (ratio < t_low)\n    restart = false;\n\n  if (restart)\n    last_restart_conflicts = conflicts;\n\n  kissat_extremely_verbose (\n    solver,\n    \"AGDR: ratio R=%.4f, thresholds [%.4f, %.4f], interval=%\" PRIu64 \", conflicts=%\" PRIu64 \"%s\",\n    ratio, t_low, t_high, interval, conflicts, restart ? \" => restart\" : \"\"\n  );\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 469, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1831}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec66bd4c8190b6ca8014d25d58c3", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "949730a9fa416d894557b0eceaab1a3a", "body": {"id": "resp_034fa46f6336ad87006921ec244a248195bb9f05e2ab93bf20", "object": "response", "created_at": 1763830820, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_034fa46f6336ad87006921ec2487b081958d60d542a79cbb87", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // AGDR: Adaptive Glue Decay Restart thresholds\n  double t_low = 0.9, t_high = 1.2;\n  if (solver->stable) {\n    t_low *= 1.05;\n    t_high *= 1.05;\n  }\n\n  // Compute glue averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Avoid division by zero\n  if (slow == 0.0)\n    return false;\n\n  const double ratio = fast / slow;\n\n  // Enforce minimum interval between restarts: at least 50 conflicts since last restart limit\n  // We want at least 50 conflicts past the last restart limit\n  const uint64_t min_conflicts_between_restarts = 50;\n  const uint64_t conflicts = CONFLICTS;\n  const uint64_t last_restart_limit = solver->limits.restart.conflicts;\n  bool min_interval_ok = (conflicts >= last_restart_limit + min_conflicts_between_restarts);\n\n  // Decision logic\n  if (ratio < t_low)\n    return false; // Making progress, do not restart\n\n  if (ratio > t_high && min_interval_ok)\n    return true; // Stagnating, trigger restart\n\n  // Also allow restart if ratio > t_high and already over limit (tie-breaker)\n  if (ratio > t_high && conflicts >= last_restart_limit)\n    return true;\n\n  // Otherwise, default to regular restart if over the conflict limit\n  if (conflicts < last_restart_limit)\n    return false;\n\n  // In stable mode: use reluctant restarts after conflict limit\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 424, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1786}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec66bbb481909686cf786be4bf54", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "b0acc74f673432f5061542f22cd6b128", "body": {"id": "resp_00024b723bdc0344006921ec3d194c81949360c615edcff522", "object": "response", "created_at": 1763830845, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_00024b723bdc0344006921ec3d56ac8194ad0e6885a6f52ae5", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Enforce minimum conflict interval between restarts\n  static uint64_t last_restart_conflicts = 0;\n  const uint64_t min_restart_interval = 50;\n  const uint64_t conflicts = solver->statistics.conflicts;\n\n  // Compute fast/slow glue averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Avoid division by zero\n  if (slow == 0.0)\n    return false;\n\n  const double ratio = fast / slow;\n\n  // Default thresholds\n  double t_low = 0.9, t_high = 1.2;\n\n  // If in stable stage, relax thresholds\n  if (solver->stable) {\n    t_low *= 1.05;\n    t_high *= 1.05;\n  }\n\n  // AGDR logic\n  if (ratio < t_low)\n    return false;\n\n  const bool stagnating = (ratio > t_high);\n\n  // Only restart if minimum interval passed\n  if (stagnating) {\n    if (conflicts >= last_restart_conflicts + min_restart_interval) {\n      kissat_extremely_verbose (solver,\n        \"AGDR restart: fast/slow glue ratio %.3f > high threshold %.3f\",\n        ratio, t_high);\n      last_restart_conflicts = conflicts;\n      return true;\n    } else {\n      // Not enough conflicts since last restart\n      return false;\n    }\n  }\n\n  // Standard conflict-budget restart if limit reached and interval passed\n  if (CONFLICTS >= solver->limits.restart.conflicts) {\n    if (conflicts >= last_restart_conflicts + min_restart_interval) {\n      kissat_extremely_verbose (solver,\n        \"AGDR restart: conflict limit %llu reached (interval OK)\",\n        (unsigned long long) solver->limits.restart.conflicts);\n      last_restart_conflicts = conflicts;\n      return true;\n    }\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 459, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1821}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec66c5c4819083194ae0016cfc88", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "732c52a3944cba1c39d3617e4f3a17e2", "body": {"id": "resp_064c17a05d651e49006921ec2452548195aa1fe40f75af1d0a", "object": "response", "created_at": 1763830820, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_064c17a05d651e49006921ec2493f08195a484086970e80c67", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Adaptive Glue Decay Restart (AGDR) parameters\n  double T_low = 0.9;\n  double T_high = 1.2;\n\n  // In stable mode, thresholds are relaxed\n  if (solver->stable) {\n    T_low *= 1.05;\n    T_high *= 1.05;\n  }\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Prevent division by zero\n  if (slow == 0.0)\n    return false;\n\n  const double R = fast / slow;\n\n  // Maintain a minimum interval of 50 conflicts between restarts\n  static uint64_t last_restart_conflicts = 0;\n  const uint64_t conflicts = solver->statistics.conflicts;\n\n  // Do not restart if not enough conflicts since last restart\n  if (conflicts < last_restart_conflicts + 50)\n    goto no_restart;\n\n  // Progress: R below lower threshold, do not restart\n  if (R < T_low)\n    goto no_restart;\n\n  // Stagnation: R above upper threshold -> trigger restart\n  if (R > T_high) {\n    last_restart_conflicts = conflicts;\n    kissat_extremely_verbose (solver,\n      \"AGDR: R=%.3f > T_high=%.3f (fast=%.3f slow=%.3f) -- restart\",\n      R, T_high, fast, slow);\n    return true;\n  }\n\n  // Traditional conflict limit as tie-breaker (but prefer glue-based restart if both trigger)\n  if (conflicts >= solver->limits.restart.conflicts) {\n    last_restart_conflicts = conflicts;\n    kissat_extremely_verbose (solver,\n      \"AGDR: conflict limit hit (conflicts=%\" PRIu64 \" limit=%\" PRIu64 \") -- restart\",\n      conflicts, solver->limits.restart.conflicts);\n    return true;\n  }\n\nno_restart:\n  kissat_extremely_verbose (solver,\n    \"AGDR: no restart (R=%.3f, T_low=%.3f, T_high=%.3f, fast=%.3f, slow=%.3f)\",\n    R, T_low, T_high, fast, slow);\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1362, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 526, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1888}, "user": null, "metadata": {}}}, "error": null}
