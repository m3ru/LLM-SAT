{"id": "batch_req_6921f0ade32081908bac69fe9ac99f47", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "39c7831c1f8f7d19c274d0a8418ad630", "body": {"id": "resp_0f79a7b3856c52b8006921ecfe5d188199a7cc4d72593dc7a8", "object": "response", "created_at": 1763831038, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0f79a7b3856c52b8006921ecfefcac8199adea0a55cb1e92d6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger (always available)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Gather stage information\n  const bool stable = solver->stable;\n\n  // Compute glue EWMAs\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Compute decision rate EWMA (current interval)\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // --- Adaptive moving average of decision rate over last k=10 restarts ---\n  // Use solver->restart_avg_decision_rate as the EWMA, alpha=0.1\n  // On first call, initialize if necessary\n  if (!solver->restart_avg_decision_rate_init) {\n    solver->restart_avg_decision_rate = decision_rate;\n    solver->restart_avg_decision_rate_init = true;\n  }\n\n  // Compute thresholds\n  double glue_threshold = 0.9 * slow_glue;\n  double decision_rate_threshold = 0.8 * solver->restart_avg_decision_rate;\n  if (stable) {\n    glue_threshold *= 2.0;\n    decision_rate_threshold /= 2.0;\n  }\n\n  // Scoring trigger\n  const bool scoring_trigger =\n    (fast_glue > glue_threshold) &&\n    (decision_rate < decision_rate_threshold);\n\n  // Tie-breaking: scoring trigger prioritized\n  if (scoring_trigger) {\n    if (!solver->level)\n      return false;  // Delay until level > 0\n    // Upon scoring-triggered restart, update avg_decision_rate EWMA\n    solver->restart_avg_decision_rate =\n      0.9 * solver->restart_avg_decision_rate + 0.1 * decision_rate;\n    return true;\n  }\n\n  // If only the conflict limit trigger fires (scoring did not), update avg_decision_rate at restart\n  if (CONFLICTS >= solver->limits.restart.conflicts) {\n    solver->restart_avg_decision_rate =\n      0.9 * solver->restart_avg_decision_rate + 0.1 * decision_rate;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 506, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1328}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921f0ade39c81909c0f3da5e2181f74", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "7a23455b7c6e3516818237cb567454e8", "body": {"id": "resp_0be1c8b67412db90006921ecff19a081989e30370ec5382eeb", "object": "response", "created_at": 1763831039, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0be1c8b67412db90006921ed0000888198a7efd45f99d91798", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Gather averages\n  const int mode = solver->stable;\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Maintain avg_decision_rate as EWMA over last 10 restarts\n  // We use solver->restart_avg_decision_rate as the EWMA state\n  // alpha = 2/(k+1) for k=10\n  const double ewma_alpha = 2.0 / 11.0;\n  if (!solver->restart_avg_decision_rate_initialized) {\n    solver->restart_avg_decision_rate = decision_rate;\n    solver->restart_avg_decision_rate_initialized = true;\n  } else if (solver->just_restarted) {\n    solver->restart_avg_decision_rate =\n      ewma_alpha * decision_rate +\n      (1.0 - ewma_alpha) * solver->restart_avg_decision_rate;\n    solver->just_restarted = false;\n  }\n  const double avg_decision_rate = solver->restart_avg_decision_rate;\n\n  // Thresholds\n  double glue_ratio = 0.9, rate_ratio = 0.8;\n  if (mode) {\n    glue_ratio *= 2.0;\n    rate_ratio *= 2.0;\n  }\n\n  // Score-based trigger\n  const bool scoring_trigger =\n    (fast_glue > glue_ratio * slow_glue) &&\n    (decision_rate < rate_ratio * avg_decision_rate);\n\n  // Tie breaking: prioritize scoring trigger\n  if (scoring_trigger) {\n    if (solver->level > 0) {\n      solver->just_restarted = true;\n      return true;\n    } else {\n      // Delay restart until decision level > 0\n      return false;\n    }\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 467, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1289}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921f0ade3d88190b56c21c8e007553e", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "07360cd5aa74d9c8de0970fa154c0591", "body": {"id": "resp_014d2514d4d83cf5006921ed17dcfc819aa13c305f79ebcb22", "object": "response", "created_at": 1763831064, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_014d2514d4d83cf5006921ed18f4b8819aac88f6d8ea1a28f6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Gather fast/slow glue and decision rate\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Use a static window for EWMA of decision_rate over last 10 restarts\n  enum { WINDOW = 10 };\n  static double avg_decision_rate = 0.0;\n  static int initialized = 0;\n  static uint64_t last_restart_conflicts = 0;\n  static uint64_t last_restart_decisions = 0;\n\n  // On first call, initialize avg_decision_rate to current value\n  if (!initialized) {\n    avg_decision_rate = decision_rate;\n    initialized = 1;\n  }\n\n  // Compute thresholds\n  double glue_factor = 0.9, rate_factor = 0.8;\n  if (solver->stable) {\n    glue_factor *= 2.0;\n    rate_factor /= 2.0;\n  }\n\n  bool scoring_trigger = (fast_glue > glue_factor * slow_glue) &&\n                         (decision_rate < rate_factor * avg_decision_rate);\n\n  // Tie-breaking: prefer scoring trigger\n  if (scoring_trigger) {\n    if (solver->level == 0)\n      return false;\n    // Update avg_decision_rate for next interval (EWMA)\n    double new_decisions = solver->statistics.decisions - last_restart_decisions;\n    double new_conflicts = solver->statistics.conflicts - last_restart_conflicts;\n    double new_rate = new_conflicts > 0 ? ((double)new_decisions / (double)new_conflicts) : decision_rate;\n    avg_decision_rate = (avg_decision_rate * (WINDOW - 1) + new_rate) / WINDOW;\n    last_restart_decisions = solver->statistics.decisions;\n    last_restart_conflicts = solver->statistics.conflicts;\n    return true;\n  }\n\n  // If not scoring, but conflict-limit fires, only update avg_decision_rate after restart\n  if (CONFLICTS >= solver->limits.restart.conflicts) {\n    double new_decisions = solver->statistics.decisions - last_restart_decisions;\n    double new_conflicts = solver->statistics.conflicts - last_restart_conflicts;\n    double new_rate = new_conflicts > 0 ? ((double)new_decisions / (double)new_conflicts) : decision_rate;\n    avg_decision_rate = (avg_decision_rate * (WINDOW - 1) + new_rate) / WINDOW;\n    last_restart_decisions = solver->statistics.decisions;\n    last_restart_conflicts = solver->statistics.conflicts;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 641, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1463}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921f0ade25c8190a7510da427a4a0d7", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "622046a3e1c66eb40270a37cc46fef19", "body": {"id": "resp_08b6f3c32ea70fe3006921ed138ac4819a966b65203459a577", "object": "response", "created_at": 1763831059, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08b6f3c32ea70fe3006921ed142d1c819a894244aac407c521", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-based trigger (always available)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Get current EWMA values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Persistent average decision rate over last 10 restarts\n  // (initialize if not present)\n  if (!solver->avg_decision_rate_initialized) {\n    solver->avg_decision_rate = decision_rate;\n    solver->avg_decision_rate_initialized = true;\n  }\n\n  // Thresholds\n  double glue_threshold = 0.9;\n  double rate_threshold = 0.8;\n  if (solver->stable) {\n    glue_threshold *= 2.0;\n    rate_threshold /= 2.0;\n  }\n\n  bool scoring_trigger = \n    (fast_glue > glue_threshold * slow_glue) &&\n    (decision_rate < rate_threshold * solver->avg_decision_rate);\n\n  // If scoring trigger is met but at decision level 0, delay restart\n  if (scoring_trigger && solver->level == 0)\n    return false;\n\n  // Prioritize scoring trigger over conflict limit\n  if (scoring_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 334, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1156}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921f0addfc88190ba235366fde995d6", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "4f8b4abac54145b20ab0ea862e8f726a", "body": {"id": "resp_0488ad52523177b3006921ed1380f8819ab1f84bc8c208129d", "object": "response", "created_at": 1763831059, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0488ad52523177b3006921ed13e37c819aa33bb1e42a9a32ec", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Gather attributes\n  const int stable = solver->stable;\n\n  // Glue averages\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Decision rate\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Average decision rate over last k restarts (k=10)\n  // This is maintained as an EWMA in solver->restart_avg_decision_rate\n  // (Assume this field exists and is updated elsewhere after each restart.)\n  double avg_decision_rate = solver->restart_avg_decision_rate;\n\n  // Thresholds\n  double glue_factor = 0.9;\n  double decision_rate_factor = 0.8;\n\n  if (stable) {\n    glue_factor *= 2.0;             // Double the threshold\n    decision_rate_factor *= 2.0;    // Double the threshold\n  }\n\n  // Scoring trigger\n  bool scoring_trigger = (fast_glue > glue_factor * slow_glue) &&\n                         (decision_rate < decision_rate_factor * avg_decision_rate);\n\n  // Tie-breaking: scoring trigger prioritized\n  if (scoring_trigger) {\n    // Delay restart if at level 0\n    if (solver->level > 0)\n      return true;\n    else\n      return false;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 368, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1190}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921f0ade01081908c69067a905cff5f", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "ec476de51002df645b6b489cb03b763f", "body": {"id": "resp_03a863e335f03568006921ed138d24819baeb87871b4275bdf", "object": "response", "created_at": 1763831059, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_03a863e335f03568006921ed14c9f4819b93736225c2427782", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-limit trigger (always available)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Get current averages\n  double fast_glue = AVERAGE (fast_glue);\n  double slow_glue = AVERAGE (slow_glue);\n  double decision_rate = AVERAGE (decision_rate);\n\n  // Retrieve and update avg_decision_rate EWMA over last 10 restarts.\n  // We store it in solver->restart_avg_decision_rate, initialized to decision_rate.\n  // On first run, initialize it.\n  if (!solver->restart_avg_decision_rate_initialized) {\n    solver->restart_avg_decision_rate = decision_rate;\n    solver->restart_avg_decision_rate_initialized = true;\n  }\n\n  // After each restart, in actual restart logic outside this function,\n  // the avg_decision_rate EWMA should be updated as:\n  // avg = alpha * current_decision_rate + (1-alpha) * avg, with alpha = 1/10.\n  // Here, use current value for comparison.\n\n  double avg_decision_rate = solver->restart_avg_decision_rate;\n\n  // Compute thresholds\n  double glue_factor = solver->stable ? 0.9 * 2.0 : 0.9;\n  double rate_factor = solver->stable ? 0.8 / 2.0 : 0.8;\n  double glue_thresh = glue_factor * slow_glue;\n  double rate_thresh = rate_factor * avg_decision_rate;\n\n  bool scoring_trigger =\n    (fast_glue > glue_thresh) &&\n    (decision_rate < rate_thresh);\n\n  // Tie-breaking and level check\n  if (scoring_trigger) {\n    if (solver->level)\n      return true;\n    // If scoring trigger is met but at level 0, delay restart.\n    return false;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 442, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1264}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921f0addee08190bddeb65bbaaa8414", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "09045af75e70156c94667870016cc746", "body": {"id": "resp_07e62648dd6777c1006921ed1382c48198bb9eb545d16fbba5", "object": "response", "created_at": 1763831059, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_07e62648dd6777c1006921ed13e698819881aac2bb23895ac2", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger (ALWAYS fires if conflicts limit is reached)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Get EWMA values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Adaptive avg_decision_rate over last 10 restarts\n  // These are maintained in solver->restart\n  restart_t *restart = &solver->restart;\n  double avg_decision_rate = restart->avg_decision_rate;\n  if (avg_decision_rate <= 0.0)\n    avg_decision_rate = decision_rate; // fall back for first interval\n\n  // Thresholds\n  double glue_margin = 0.9;\n  double rate_margin = 0.8;\n  if (solver->stable) {\n    glue_margin *= 2.0;   // double threshold if stable\n    rate_margin /= 2.0;   // halve threshold if stable\n  }\n\n  bool scoring_trigger =\n    (fast_glue > glue_margin * slow_glue) &&\n    (decision_rate < rate_margin * avg_decision_rate);\n\n  // If scoring trigger is met but at decision level 0, delay restart\n  if (scoring_trigger && solver->level == 0)\n    return false;\n\n  // Prioritize scoring trigger if both fire\n  if (scoring_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 371, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1193}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921f0addbac8190a17c76d047b035dc", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "d688c0da4ef53f2ec864cc2209e39910", "body": {"id": "resp_00df2628d1d2ff8c006921ed17ca34819885ecc707f4dc2fa8", "object": "response", "created_at": 1763831063, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_00df2628d1d2ff8c006921ed1baf288198aba5d3380c8f6f4b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Gather parameters\n  const int stable = solver->stable;\n  const double fast = AVERAGE(fast_glue);\n  const double slow = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // avg_decision_rate: EWMA over last 10 restarts (implemented as a field)\n  // We assume solver->avg_decision_rate is maintained elsewhere per specification\n  double avg_decision_rate = solver->avg_decision_rate;\n\n  // Thresholds\n  double glue_factor = 0.9;\n  double decision_factor = 0.8;\n  if (stable) {\n    glue_factor *= 2.0;\n    decision_factor *= 2.0;\n  }\n\n  // Adaptive scoring trigger\n  bool scoring_trigger = false;\n  if (fast > glue_factor * slow && decision_rate < decision_factor * avg_decision_rate)\n    scoring_trigger = true;\n\n  // Tie-breaking: scoring_trigger has priority, but must be at level > 0\n  if (scoring_trigger) {\n    if (solver->level > 0)\n      return true;\n    else\n      return false;\n  }\n\n  // If only the conflict limit fires (scoring_trigger is not set), already handled above\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 343, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1165}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921f0ade21481909521ee1cce4bef83", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "55def82fb7de7984ef98097ae05fa3f4", "body": {"id": "resp_076a35fd8021933d006921ed18cf4c819889db41ce07803a94", "object": "response", "created_at": 1763831064, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_076a35fd8021933d006921ed1939548198a6044acbbf07e945", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger (always available)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Get EWMA values\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Maintain avg_decision_rate as EWMA over last 10 restarts.\n  // We store it in solver->restart_avg_decision_rate (double).\n  // If not initialized, initialize with current decision_rate.\n  if (solver->restart_avg_decision_rate == 0.0)\n    solver->restart_avg_decision_rate = decision_rate;\n\n  // Thresholds\n  double glue_margin = 0.9;\n  double rate_margin = 0.8;\n\n  // If stable, double thresholds\n  if (solver->stable) {\n    glue_margin *= 2.0;   // 1.8\n    rate_margin *= 2.0;   // 1.6\n  }\n\n  // Scoring trigger\n  bool scoring_trigger = false;\n  if (fast > glue_margin * slow &&\n      decision_rate < rate_margin * solver->restart_avg_decision_rate)\n    scoring_trigger = true;\n\n  // Tie-break: prioritize scoring trigger if both fire\n  if (scoring_trigger) {\n    // At level 0, delay restart until level > 0\n    if (!solver->level)\n      return false;\n    // Update avg_decision_rate after scoring-triggered restart\n    solver->restart_avg_decision_rate =\n      0.9 * solver->restart_avg_decision_rate + 0.1 * decision_rate;\n    return true;\n  }\n\n  // If only conflict limit, update avg_decision_rate after restart\n  if (CONFLICTS >= solver->limits.restart.conflicts) {\n    solver->restart_avg_decision_rate =\n      0.9 * solver->restart_avg_decision_rate + 0.1 * decision_rate;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 483, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1305}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921f0adde4c8190af47b69928b7deb4", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "6d482b17bfe1c322928951239e6e44be", "body": {"id": "resp_0944d4de0523822e006921f0a73960819aa63af0d556890a51", "object": "response", "created_at": 1763831975, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0944d4de0523822e006921f0a850ac819a8f3c2d18e240a7f7", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // --- Adaptive Glue-Rate Hybrid Restart ---\n\n  // Get EWMA values for glue and decision rate\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // avg_decision_rate over last K restarts (K=10)\n  // We use a custom \"avg_decision_rate\" EWMA in the solver struct.\n  // Must be updated after each restart externally.\n  double avg_decision_rate = solver->restarting.avg_decision_rate;\n\n  // Default initialization if first run\n  if (avg_decision_rate <= 0.0)\n    avg_decision_rate = decision_rate;\n\n  double glue_threshold = 0.9;\n  double rate_threshold = 0.8;\n\n  // If stable phase, double thresholds\n  if (solver->stable) {\n    glue_threshold *= 2.0;\n    rate_threshold *= 2.0;\n  }\n\n  bool scoring_trigger =\n    (fast_glue > glue_threshold * slow_glue) &&\n    (decision_rate < rate_threshold * avg_decision_rate);\n\n  if (scoring_trigger) {\n    // Tie-breaking: prefer scoring trigger, but not at level 0\n    if (solver->level > 0)\n      return true;\n    // else: scoring trigger met but level 0, so delay restart\n    return false;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 822, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 385, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1207}, "user": null, "metadata": {}}}, "error": null}
