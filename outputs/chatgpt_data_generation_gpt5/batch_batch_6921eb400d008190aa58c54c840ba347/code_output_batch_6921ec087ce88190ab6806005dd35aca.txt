{"id": "batch_req_6921eca077048190a0264a9dd4ef80b0", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "f7c38ef976a0f7bbdf9c73d513bfce32", "body": {"id": "resp_0e3f50fada5cc807006921ec6852ac8193ade8d1d791e58eea", "object": "response", "created_at": 1763830888, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0e3f50fada5cc807006921ec687dd88193a87fb50153633f4e", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // The three main statistics we need\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Fast glue restart check\n  if (fast_glue > slow_glue + 0.5)\n  {\n    kissat_extremely_verbose (solver,\n      \"dagr-hr: restart triggered by glue (fast %.2f > slow %.2f + 0.5)\",\n      fast_glue, slow_glue);\n    return true;\n  }\n\n  // Median decision rate handling\n  // We store the median in solver->median_decision_rate_ewma (must be declared in context)\n  double median_decision_rate = solver->median_decision_rate_ewma;\n  bool have_median = (median_decision_rate > 0.0);\n\n  if (have_median)\n  {\n    if (decision_rate < 0.8 * median_decision_rate)\n    {\n      kissat_extremely_verbose (solver,\n        \"dagr-hr: restart triggered by decision rate (%.4f < 0.8 * %.4f)\",\n        decision_rate, median_decision_rate);\n      return true;\n    }\n  }\n\n  // Fallback: conflict limit\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n  {\n    kissat_extremely_verbose (solver,\n      \"dagr-hr: restart triggered by conflict limit (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 402, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1218}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921eca07ab88190a523a7e63a797c53", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "29428aa32d40f1aa5cc9cbd022506762", "body": {"id": "resp_071398fdfe144dc8006921ec0d4d048193b4bd423a6ea23ec7", "object": "response", "created_at": 1763830797, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_071398fdfe144dc8006921ec0d8cf4819387025fd28fecd1ba", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Get current statistics and averages\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // glue threshold\n  const double glue_threshold = slow_glue + 0.5;\n\n  // median decision rate tracking\n  double median_decision_rate = solver->median_decision_rate_ewma; // must be defined/updated externally on stable phase transitions\n\n  // If median_decision_rate_ewma is not initialized (zero or negative), skip rate-based condition\n  bool median_available = (median_decision_rate > 0.0);\n\n  // Condition 1: Glue-based\n  bool glue_trigger = (fast_glue > glue_threshold);\n\n  // Condition 2: Decision-rate-based\n  bool rate_trigger = false;\n  if (median_available)\n    rate_trigger = (decision_rate < (0.8 * median_decision_rate));\n\n  // Condition 3: Conflict limit\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Tie-breaking: If multiple triggers, prioritize glue/rate over conflict limit.\n  if (glue_trigger || rate_trigger) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR restart: glue_trigger=%d rate_trigger=%d (fast_glue=%.2f slow_glue=%.2f median_decision_rate=%.2f decision_rate=%.2f)\",\n      glue_trigger, rate_trigger, fast_glue, slow_glue, median_decision_rate, decision_rate);\n    return true;\n  }\n\n  if (conflict_trigger) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR restart by conflict limit (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 459, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1275}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921eca084cc8190817ecf354556ec69", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "b6fb2a440e7d6df7eb1c6e162961f55f", "body": {"id": "resp_0ec76aa9eec48301006921ec1120308195a527b6e5d2ac52b2", "object": "response", "created_at": 1763830801, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0ec76aa9eec48301006921ec1150348195b9a89020f093e0f4", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // 1. Always fetch these values.\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n  const double conflicts = solver->statistics.conflicts;\n  const uint64_t restart_conflict_limit = solver->limits.restart.conflicts;\n\n  // 2. Median decision rate is updated only at stable phase transitions.\n  //    If not available, use slow_glue threshold only.\n  const double median_decision_rate = solver->median_decision_rate_ewma;\n\n  // 3. Glue-based trigger.\n  const bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // 4. Decision-rate-based trigger.\n  bool decision_rate_trigger = false;\n  if (median_decision_rate > 0.0)\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // 5. Conflict-based trigger.\n  const bool conflict_trigger = (conflicts >= restart_conflict_limit);\n\n  // 6. Tie-breaking and prioritization.\n  //    If glue-based or decision-rate-based triggers fire, prefer them over conflict-trigger.\n  if (glue_trigger || decision_rate_trigger)\n    return true;\n  if (conflict_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 349, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1165}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921eca07c888190b9c73962728c1440", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "7e87c2e79c30dbaea692fa4b65692d30", "body": {"id": "resp_0ef5e052412fd18e006921ec1527708190a2923f6e4706b5f5", "object": "response", "created_at": 1763830805, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0ef5e052412fd18e006921ec1579d08190bf1ae2df0e821b9c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Accessed statistics and limits\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n  // EWMA values for glue and decision rate\n  const double fast_glue = solver->averages[solver->stable].fast_glue.value;\n  const double slow_glue = solver->averages[solver->stable].slow_glue.value;\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Median decision rate: stored in solver->median_decision_rate_ewma (assumed, else fallback)\n  double median_decision_rate = 0.0;\n  bool has_median_decision_rate = false;\n#ifdef METRIC_DECISION_RATE_MEDIAN\n  median_decision_rate = solver->median_decision_rate_ewma;\n  has_median_decision_rate = true;\n#else\n  // Fallback if the field is available\n  if (solver->median_decision_rate_ewma > 0.0) {\n    median_decision_rate = solver->median_decision_rate_ewma;\n    has_median_decision_rate = true;\n  }\n#endif\n\n  // (1) Glue-based restart check\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // (2) Decision rate based restart check\n  bool decision_rate_trigger = false;\n  if (has_median_decision_rate)\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // (3) Conflict limit check\n  bool conflict_limit_trigger = (conflicts >= conflict_limit);\n\n  // Priority: glue/decision_rate triggers > conflict limit; unstable > stable\n  if (glue_trigger || decision_rate_trigger) {\n    kissat_extremely_verbose(\n      solver,\n      \"DAGR-HR restart: %s%s (fast_glue=%.2f slow_glue=%.2f decision_rate=%.2f median_decision_rate=%.2f)\",\n      glue_trigger ? \"glue\" : \"\",\n      decision_rate_trigger ? (glue_trigger ? \"+decision-rate\" : \"decision-rate\") : \"\",\n      fast_glue, slow_glue, decision_rate, median_decision_rate);\n    return true;\n  }\n\n  if (conflict_limit_trigger) {\n    kissat_extremely_verbose(\n      solver,\n      \"DAGR-HR restart: conflict limit (conflicts=%\" PRIu64 \" limit=%\" PRIu64 \")\", conflicts, conflict_limit);\n    return true;\n  }\n\n  return false;\n}\n</code>\n"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 595, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1411}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921eca07938819083b416be0e583ac5", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "c1d28023fb4cabe2fab2437c80ab0c04", "body": {"id": "resp_01ee2a7b8294a3be006921ec19c04881968e9fd7a401ad0d26", "object": "response", "created_at": 1763830809, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_01ee2a7b8294a3be006921ec1a0254819680f04d3f7102d26c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Extract required values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Median decision rate for this stable phase (updated at phase change)\n  double median_decision_rate = solver->median_decision_rate_ewma;\n\n  // (1) Glue-based restart: fast_glue > slow_glue + 0.5\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // (2) Decision-rate based restart: decision_rate < 0.8 * median_decision_rate\n  bool median_known = (median_decision_rate > 0.0);\n  bool decision_rate_trigger = false;\n  if (median_known)\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // (3) Conflict limit trigger\n  bool conflicts_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Tie-breaking: glue/decision triggers preferred over conflict limit,\n  // unstable phase preferred if both\n  if (glue_trigger || decision_rate_trigger)\n    return true;\n\n  if (conflicts_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 323, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1139}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921eca097ac8190a27ec5a8f5fa8883", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "fdefe7509e8e188056c92f89c233212f", "body": {"id": "resp_0dddcc38f693349a006921ec1d10d48194aa54a3d461e91d9e", "object": "response", "created_at": 1763830813, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0dddcc38f693349a006921ec1d81dc8194bb11c41823a4ac3c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Get statistics and averages\n    const double fast_glue = solver->averages[solver->stable].fast_glue.value;\n    const double slow_glue = solver->averages[solver->stable].slow_glue.value;\n    const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n    const uint64_t conflicts = solver->statistics.conflicts;\n    const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n    // Median decision rate management (assume stored in solver->median_decision_rate_ewma)\n    // If unavailable (e.g. <= 0), fallback to glue-based trigger only\n    double median_decision_rate = 0.0;\n#ifdef METRIC_DECISION_RATE_MEDIAN\n    median_decision_rate = solver->median_decision_rate_ewma;\n#endif\n\n    bool glue_trigger = (fast_glue > slow_glue + 0.5);\n    bool decision_rate_trigger = false;\n\n    if (median_decision_rate > 0.0)\n        decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n    // If both triggers are true, or either, restart immediately (glue preferred if both)\n    if (glue_trigger || decision_rate_trigger) {\n        kissat_extremely_verbose(solver,\n            \"DAGR-HR restart: glue_trigger=%d (fast_glue=%.2f slow_glue=%.2f) \"\n            \"decision_rate_trigger=%d (decision_rate=%.2f median=%.2f)\",\n            glue_trigger, fast_glue, slow_glue,\n            decision_rate_trigger, decision_rate, median_decision_rate);\n        return true;\n    }\n\n    // If neither, check classical conflict-based limit\n    if (conflicts >= conflict_limit) {\n        kissat_extremely_verbose(solver,\n            \"DAGR-HR restart: conflict limit reached (%\" PRIu64 \" >= %\" PRIu64 \")\",\n            conflicts, conflict_limit);\n        return true;\n    }\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 475, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1291}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921eca074bc8190adfa098c5e3132d2", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "bdb3b26692f780acde090253bbf42a0d", "body": {"id": "resp_0543b9619fe24af2006921ec218a9481978aebd99b60794cde", "object": "response", "created_at": 1763830817, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0543b9619fe24af2006921ec21c770819796e96eda666e92c4", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather glue and decision rate moving averages\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // Retrieve persistent median for decision rate, updated at stable phase transitions\n  double median_decision_rate = solver->median_decision_rate_ewma;\n\n  // Conflict limit check (standard)\n  bool conflict_limit = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // 1. Glue-based trigger\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // 2. Decision rate based trigger\n  // If median_decision_rate is unavailable (zero/nonpositive), we ignore it.\n  bool decision_rate_trigger = false;\n  if (median_decision_rate > 0.0)\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // DAGR-HR: If any trigger fires, restart immediately.\n  if (glue_trigger || decision_rate_trigger)\n    return true;\n\n  // If neither glue nor decision rate triggers, use conflict limit as fallback.\n  if (conflict_limit)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 317, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1133}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921eca079708190b1ab8134ca39f217", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "7693f483fa13cccb6b3483b93aaabef4", "body": {"id": "resp_0eca3c27286287df006921ec24cef8819587f4983b768e87c2", "object": "response", "created_at": 1763830820, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0eca3c27286287df006921ec24fd7081958ac4a7bf474bf0b0", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit check (always available)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Gather averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // DAGR-HR: (1) fast_glue > slow_glue + 0.5\n  if (fast_glue > slow_glue + 0.5)\n    return true;\n\n  // DAGR-HR: (2) decision_rate < 0.8 * median_decision_rate_ewma\n  // median_decision_rate_ewma is updated at phase transitions (assumed stored)\n  double median_decision_rate = solver->median_decision_rate_ewma;\n\n  // If median is not set (zero or negative), fallback to only glue-based restart\n  if (median_decision_rate > 0.0) {\n    if (decision_rate < 0.8 * median_decision_rate)\n      return true;\n  }\n\n  // No triggers, so do not restart\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 300, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1116}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921eca07fa08190b8008ba54da0ba3c", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "6d0c5b578b27b003f4a978f9fc2a563b", "body": {"id": "resp_0cd047cd6ea4515a006921ec0d2e7c819590f5a0f7e2be6922", "object": "response", "created_at": 1763830797, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0cd047cd6ea4515a006921ec0d76f88195a3d30ca2e1074b39", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Collect relevant averages and statistics.\n    const double fast_glue = AVERAGE(fast_glue);\n    const double slow_glue = AVERAGE(slow_glue);\n    const double decision_rate = AVERAGE(decision_rate);\n\n    // Median decision rate EWMA, maintained per stable phase.\n    // Stored in solver->median_decision_rate_ewma, initialized to 0.0 if never set.\n    double median_decision_rate_ewma = solver->median_decision_rate_ewma;\n\n    // --- Trigger 1: Glue-based restart ---\n    bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n    // --- Trigger 2: Decision rate-based restart ---\n    bool drate_trigger = false;\n    if (median_decision_rate_ewma > 0.0) {\n        drate_trigger = (decision_rate < 0.8 * median_decision_rate_ewma);\n    }\n\n    // --- Trigger 3: Conflict-limit based restart ---\n    bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n    // --- Tie-breaking rules ---\n    // If glue and decision triggers fire, trigger immediately, prioritize glue for reporting.\n    // If median_decision_rate_ewma is unavailable, only glue and conflict triggers apply.\n\n    if (glue_trigger) {\n        kissat_extremely_verbose(solver,\n            \"restarting: fast glue %.2f > slow glue %.2f + 0.5\",\n            fast_glue, slow_glue);\n        return true;\n    }\n    if (drate_trigger) {\n        kissat_extremely_verbose(solver,\n            \"restarting: decision rate %.4f < 0.8 * median %.4f\",\n            decision_rate, median_decision_rate_ewma);\n        return true;\n    }\n    if (conflict_trigger) {\n        kissat_extremely_verbose(solver,\n            \"restarting: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n            CONFLICTS, solver->limits.restart.conflicts);\n        return true;\n    }\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 489, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1305}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921eca091f48190a16ec5528fb139a1", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "f70a52ab8cd49dad8442d924a7198b21", "body": {"id": "resp_0deb19fdc521ca75006921ec2848cc8190bef36f79bc12fd71", "object": "response", "created_at": 1763830824, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0deb19fdc521ca75006921ec289b608190a27eeed241009b11", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather relevant metrics\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Retrieve the current median decision rate; assume initialized to 0 if unavailable\n  double median_decision_rate = solver->median_decision_rate_ewma;\n\n  // 1. Glue-based trigger: fast_glue > slow_glue + 0.5\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // 2. Decision-rate based trigger: decision_rate < 0.8 * median_decision_rate\n  bool median_available = (median_decision_rate > 0.0);\n  bool decision_rate_trigger = false;\n  if (median_available)\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // 3. Conflict-based trigger: conflicts >= restart_conflict_limit\n  bool conflicts_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Decision logic with tie-breaking\n  // If glue or decision rate trigger, restart immediately\n  if (glue_trigger || decision_rate_trigger)\n    return true;\n\n  // If neither glue nor decision rate triggers, but conflict limit is reached, restart\n  if (conflicts_trigger)\n    return true;\n\n  // If median is unavailable, rely only on glue trigger and conflict trigger (already checked above)\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 368, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1184}, "user": null, "metadata": {}}}, "error": null}
