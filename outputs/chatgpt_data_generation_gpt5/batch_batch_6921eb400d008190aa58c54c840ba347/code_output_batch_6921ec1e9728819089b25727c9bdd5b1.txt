{"id": "batch_req_6921ec846a0c8190a65a9602e40e89d5", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "2d838d9bd59cf9acccfdd8faf17dbf77", "body": {"id": "resp_000c16fc6424d9cb006921ec7dbce08190a5c552619bd3ee62", "object": "response", "created_at": 1763830909, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_000c16fc6424d9cb006921ec7dffc8819083659fc49fe42d27", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-based hard limit (always triggers if reached)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // AGDRR adaptive heuristic\n  // Parameters (tunable)\n  const double glue_threshold = 0.90;\n  // Use a fixed threshold_DR, or if available, a learned/observed one\n  // For simplicity, use a constant for now; can replace with median if available\n  const double threshold_DR = 0.1;\n\n  // Extract averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // Decision rate moving average\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Avoid division by zero\n  const double effective_decision_rate = (decision_rate > 1e-12) ? decision_rate : 1e-12;\n\n  // Compute the AGDRR trigger score\n  const double R = (fast_glue / slow_glue) + (threshold_DR / effective_decision_rate);\n\n  // Compose restart triggers\n  const bool glue_trigger = (fast_glue / slow_glue) < glue_threshold;\n  const bool agdrr_trigger = (R < glue_threshold);\n\n  // Tie-breaker: if both triggers, prioritize glue-based\n  if (glue_trigger) {\n    kissat_extremely_verbose (solver,\n      \"restart triggered by glue: fast/slow glue %.4f/%.4f = %.4f < %.4f\",\n      fast_glue, slow_glue, fast_glue / slow_glue, glue_threshold);\n    return true;\n  }\n\n  if (agdrr_trigger) {\n    kissat_extremely_verbose (solver,\n      \"restart triggered by AGDRR: R = %.4f < %.4f \"\n      \"(fast/slow glue: %.4f/%.4f, DR: %.6f, threshold_DR: %.6f)\",\n      R, glue_threshold, fast_glue, slow_glue, decision_rate, threshold_DR);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 502, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1865}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec8377948190b4f2b8ccb4446166", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "235782a94428932af5735d6889b50044", "body": {"id": "resp_0913530be6cf1494006921ec7e0b208190ab8f9883548bc4de", "object": "response", "created_at": 1763830910, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0913530be6cf1494006921ec7eb48c8190a0f4a08648a71461", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-based hard limit trigger (always supported)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Stable phase: use reluctant restarts as usual\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // --- AGDRR heuristic ---\n  // Parameters\n  const double glue_threshold = 0.90;\n  // Use a fixed threshold_DR, e.g., 0.1 if median not available.\n  const double threshold_DR = 0.1;\n\n  // Current averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dr = solver->averages[solver->stable].decision_rate.value;\n\n  // Avoid div-by-zero\n  if (slow <= 0.0 || dr <= 0.0)\n    return false;\n\n  // Compute the AGDRR restart trigger score\n  const double R = (fast / slow) + (threshold_DR / dr);\n\n  kissat_extremely_verbose (solver,\n    \"AGDRR: fast_glue %.3f, slow_glue %.3f, dec_rate %.5f, R=%.4f (thr=%.2f)\",\n    fast, slow, dr, R, glue_threshold);\n\n  // Glue-based trigger has priority if both fire (R < glue_threshold)\n  if ((fast / slow) < glue_threshold)\n    return true;\n\n  // AGDRR trigger based on combined signal\n  if (R < glue_threshold)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 391, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1754}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec83823081909f61e7094d05543e", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "80482b1adbae38bf37da4fddfed1d4f7", "body": {"id": "resp_0aaf0853fddd6b02006921ec21f5808197950179a3480e0d7a", "object": "response", "created_at": 1763830817, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0aaf0853fddd6b02006921ec2239cc819787a3e93232bc9bf6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Always trigger on conflict limit in any mode\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // AGDRR applies only during focused (non-stable) mode, follow existing Kissat convention\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // Parameters\n  const double glue_threshold = 0.90;\n  // Decision rate threshold: can be set via option, or a fixed value (e.g., 0.1)\n  // For simplicity, use option if available, else fallback to constant.\n  double threshold_DR = GET_OPTION(restartdecisionrate);\n  if (threshold_DR <= 0.0)\n    threshold_DR = 0.1;\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double DR = solver->averages[solver->stable].decision_rate.value;\n\n  double R = (slow > 0.0 ? (fast / slow) : 1.0) + (DR > 0.0 ? (threshold_DR / DR) : 1.0);\n\n  // First trigger: glue-based\n  if ((slow > 0.0) && ((fast / slow) < glue_threshold)) {\n    kissat_extremely_verbose (solver,\n      \"AGDRR: RESTART (glue trigger) fast/slow = %g/%g = %g < glue_threshold=%g\",\n      fast, slow, fast/slow, glue_threshold);\n    return true;\n  }\n\n  // Second trigger: overall AGDRR score\n  if (R < glue_threshold) {\n    kissat_extremely_verbose (solver,\n      \"AGDRR: RESTART (combined trigger) R=%g < glue_threshold=%g (F=%g, S=%g, DR=%g, thr_DR=%g)\",\n      R, glue_threshold, fast, slow, DR, threshold_DR);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 496, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1859}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec839dd88190b67980c6fa20810f", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "eaecff0840f02b0e0e75611607c7a818", "body": {"id": "resp_06efeb59c47d0fb5006921ec265ff08195a86424b7b28a7478", "object": "response", "created_at": 1763830822, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_06efeb59c47d0fb5006921ec26c4548195a51ffc5241fe4880", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-based hard limit\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // If stable, fallback to reluctant trigger as in original design\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // AGDRR: Adaptive Glue-and-Decision-Rate Restart\n\n  // Fast/slow glue moving averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Decision rate moving average\n  const double dr = solver->averages[solver->stable].decision_rate.value;\n\n  // Parameters (could be made options):\n  const double glue_threshold = 0.90;\n  // threshold_DR: set to 0.1 unless initialized elsewhere\n  const double threshold_DR = 0.1;\n\n  // Compute trigger score R\n  // R = (fast / slow) + (threshold_DR / dr)\n  double glue_ratio = (slow > 0.0) ? (fast / slow) : 1.0;\n  double dr_ratio = (dr > 0.0) ? (threshold_DR / dr) : 1.0;\n  double score = glue_ratio + dr_ratio;\n\n  kissat_extremely_verbose(solver,\n    \"AGDRR restart: glue_ratio=%g (fast=%g/slow=%g) dr_ratio=%g (thresh=%g/dr=%g) score=%g threshold=%g\",\n    glue_ratio, fast, slow, dr_ratio, threshold_DR, dr, score, glue_threshold\n  );\n\n  if (glue_ratio < glue_threshold)\n    return true;\n\n  if (score < glue_threshold)\n    return true;\n\n  return false;\n}\n</code>\n"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 420, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1783}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec837c4481909c0013ac139b4a85", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "97ffc78ad2d14f25ddb4ab285dc755f8", "body": {"id": "resp_0385bcdcfbc06f35006921ec2cd9808195a34b3f378f48918a", "object": "response", "created_at": 1763830828, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0385bcdcfbc06f35006921ec2d0c648195bfafb94eb4364652", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-based restart trigger (always available)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Use fast/slow glue and decision rate moving averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dr = AVERAGE (decision_rate);\n\n  // Tunable parameters (could be made options)\n  const double glue_threshold = 0.90;\n  // Use a fixed threshold_DR for simplicity. In practice, this could be\n  // initialized as the median observed DR in the first 1000 conflicts,\n  // but Kissat doesn't store that, so use a small constant (e.g., 0.1).\n  const double threshold_DR = 0.1;\n\n  // Compute AGDRR score\n  double R = (fast / slow) + (threshold_DR / dr);\n\n  kissat_extremely_verbose (\n    solver,\n    \"AGDRR: fast_glue=%.4f slow_glue=%.4f dr=%.4f R=%.4f glue_threshold=%.4f\",\n    fast, slow, dr, R, glue_threshold);\n\n  // Restart if AGDRR score falls below glue_threshold (main trigger)\n  if (R < glue_threshold)\n    return true;\n\n  // Otherwise, no restart\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 341, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1704}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec83793c81909feb9402855b337f", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "4c50ba75e0a238a43fc5d02d86191f9c", "body": {"id": "resp_08f6d390d4547fa5006921ec33854081939ef140d152a86f56", "object": "response", "created_at": 1763830835, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08f6d390d4547fa5006921ec33c8648193b7b6b9b2a35e99f6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-based restart (always available)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Fast/slow glue and decision rate moving averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double dr = solver->averages[solver->stable].decision_rate.value;\n\n  // AGDRR parameters\n  const double glue_threshold = 0.90;\n  // Threshold decision rate: use a fixed constant (e.g., 0.1) for simplicity\n  const double threshold_dr = 0.1;\n\n  // Compute restart trigger score\n  double r = (fast_glue / slow_glue);\n  // Prevent division by zero for dr\n  if (dr > 0.0)\n    r += (threshold_dr / dr);\n  else\n    r += 1e6; // Large value if decision rate is zero\n\n  // Glue-based trigger (tie-breaker): fire if fast/slow glue is bad\n  bool glue_trigger = (fast_glue / slow_glue) < glue_threshold;\n  // Combined trigger: AGDRR score\n  bool agdrr_trigger = r < glue_threshold;\n\n  if (glue_trigger) {\n    kissat_extremely_verbose (\n      solver,\n      \"restarting: glue-triggered (fast_glue/slow_glue = %.4f/%.4f=%.4f < %.2f)\",\n      fast_glue, slow_glue, fast_glue / slow_glue, glue_threshold);\n    return true;\n  }\n\n  if (agdrr_trigger) {\n    kissat_extremely_verbose (\n      solver,\n      \"restarting: AGDRR-triggered (R = %.4f < glue_threshold %.2f) [fast_glue=%.4f slow_glue=%.4f dr=%.6f]\",\n      r, glue_threshold, fast_glue, slow_glue, dr);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 481, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1844}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec83c7e88190b52a29e9e3679111", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "bed99066d90830ed020ee88bd9601453", "body": {"id": "resp_0f4e79c58d99bacd006921ec37c59c8197b03cdc0e4668ede8", "object": "response", "created_at": 1763830839, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0f4e79c58d99bacd006921ec381ad08197839cb97c36130a88", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Parameters for AGDRR\n  const double glue_threshold = 0.90;\n\n  // Use a fixed threshold_DR if no median is available\n  // (In practice, this could be learned during the first 1000 conflicts; here, we use a fixed value)\n  const double threshold_DR = 0.1;\n\n  // Gather averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dr = solver->averages[solver->stable].decision_rate.value;\n\n  // Prevent division by zero or near-zero\n  const double safe_dr = dr > 1e-12 ? dr : 1e-12;\n  const double safe_slow = slow > 1e-12 ? slow : 1e-12;\n\n  // Compute R = (F/S) + (threshold_DR/DR)\n  const double glue_ratio = fast / safe_slow;\n  const double dr_ratio = threshold_DR / safe_dr;\n  const double R = glue_ratio + dr_ratio;\n\n  // Restart triggers\n  bool glue_trigger = (R < glue_threshold);\n  bool conflicts_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Tie-breaker: Prioritize glue-based trigger\n  if (glue_trigger) {\n    kissat_extremely_verbose (solver,\n      \"AGDRR restart: triggered by glue/DR score R=%.6f (F=%.4f, S=%.4f, DR=%.6f), threshold=%.2f\",\n      R, fast, slow, dr, glue_threshold);\n    return true;\n  }\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  if (conflicts_trigger) {\n    kissat_extremely_verbose (solver,\n      \"AGDRR restart: triggered by conflict limit %ld >= %ld\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 495, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1858}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec837cdc8190b8c90a4089347096", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "2f95878b82644a967d7c9f4576fd12e9", "body": {"id": "resp_08827cbf133ed41a006921ec3f093481979e9109c6b6e5c00a", "object": "response", "created_at": 1763830847, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08827cbf133ed41a006921ec3f69b48197944951468b7013df", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Always allow restart if conflict limit is reached\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Use reluctant restarts if in stable mode\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // AGDRR parameters\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dr = solver->averages[solver->stable].decision_rate.value;\n\n  // Thresholds (these could be options or tuned)\n  const double glue_threshold = 0.90;\n  // Use a fixed threshold decision rate for simplicity (alternatively, could be set adaptively)\n  const double threshold_dr = 0.1;\n\n  // Avoid division by zero\n  if (slow == 0.0 || dr == 0.0)\n    return false;\n\n  const double glue_ratio = fast / slow;\n  const double dr_ratio = threshold_dr / dr;\n  const double R = glue_ratio + dr_ratio;\n\n  kissat_extremely_verbose (solver,\n    \"AGDRR: fast_glue=%.4f slow_glue=%.4f glue_ratio=%.4f dr=%.4f dr_ratio=%.4f R=%.4f\",\n    fast, slow, glue_ratio, dr, dr_ratio, R);\n\n  // Glue-based trigger (priority)\n  if (R < glue_threshold)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 370, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1733}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec837e0c8190acb9e085c895ec87", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "d4b6a19c012b8f6c28ec6d32fbc02b85", "body": {"id": "resp_076fa9a7451d8a93006921ec42b60c8195a24901b74509cb4b", "object": "response", "created_at": 1763830850, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_076fa9a7451d8a93006921ec42f3bc8195a66bc259e55f3705", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // AGDRR parameters\n  const double glue_threshold = 0.90;\n  // Use an option or a fixed value for threshold_DR if not initialized (e.g., 0.1)\n  double threshold_DR = solver->agdrr_threshold_DR;\n  if (threshold_DR <= 0)\n    threshold_DR = 0.1;\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dr = solver->averages[solver->stable].decision_rate.value;\n\n  // Defensive: avoid divide-by-zero on slow or dr\n  if (slow <= 0.0 || dr <= 0.0)\n    return false;\n\n  // AGDRR score\n  const double r_score = (fast / slow) + (threshold_DR / dr);\n\n  // Glue-based trigger\n  const bool glue_trigger = (fast / slow) < glue_threshold;\n\n  // Decision-rate trigger (contributes to r_score only)\n  const bool r_trigger = r_score < glue_threshold;\n\n  // Tie-breaker: glue trigger takes priority\n  if (glue_trigger)\n  {\n    kissat_extremely_verbose (solver,\n      \"AGDRR restart: glue trigger fired (fast/slow = %.4f < %.2f)\",\n      fast / slow, glue_threshold);\n    return true;\n  }\n\n  if (r_trigger)\n  {\n    kissat_extremely_verbose (solver,\n      \"AGDRR restart: r_score trigger fired (r_score = %.4f, glue_threshold = %.2f, fast = %.4f, slow = %.4f, dr = %.4f, threshold_DR = %.4f)\",\n      r_score, glue_threshold, fast, slow, dr, threshold_DR);\n    return true;\n  }\n\n  // Standard reluctant restarts in stable phase\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 484, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1847}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ec8381e88190b9bfa8b0f081ed7a", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "5442f1682f36172b68b48d57fb16495d", "body": {"id": "resp_0a9b8aa5e18fc365006921ec471c2c81959e61ccdcfe4e2a72", "object": "response", "created_at": 1763830855, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0a9b8aa5e18fc365006921ec4758788195821572291fa61568", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // AGDRR parameters\n  const double glue_threshold = 0.90;\n\n  // Decision rate threshold: we use a fixed value as median (e.g., 0.1) for simplicity.\n  // In a production version, you might want to store and update a median during early search.\n  const double threshold_DR = 0.1;\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dr = solver->averages[solver->stable].decision_rate.value;\n\n  // Prevent division by zero for slow (should never happen, but safe)\n  const double ratio_glue = (slow > 0) ? (fast / slow) : 1.0;\n\n  // Prevent division by zero for decision rate (should never happen, but safe)\n  const double dr_term = (dr > 0) ? (threshold_DR / dr) : 1.0;\n\n  const double trigger_score = ratio_glue + dr_term;\n\n  // AGDRR restart condition:\n  // Restart if glue score is bad or if decision rate is low.\n  // Prioritize glue-based trigger if both fire.\n  bool glue_trigger = ratio_glue < glue_threshold;\n  bool score_trigger = trigger_score < glue_threshold;\n\n  // Verbose output for diagnostics\n  kissat_extremely_verbose (\n    solver,\n    \"AGDRR: fast_glue=%g slow_glue=%g ratio=%g dr=%g dr_term=%g trigger_score=%g glue_threshold=%g\",\n    fast, slow, ratio_glue, dr, dr_term, trigger_score, glue_threshold);\n\n  if (glue_trigger)\n    return true;\n  if (score_trigger)\n    return true;\n\n  // Also support phase-based (stable) restart trigger if in stable mode\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1363, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 477, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1840}, "user": null, "metadata": {}}}, "error": null}
