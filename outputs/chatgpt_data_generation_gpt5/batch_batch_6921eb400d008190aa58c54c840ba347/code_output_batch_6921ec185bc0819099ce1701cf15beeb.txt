{"id": "batch_req_6921ed5e52dc8190905eb908691cd3c5", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "b72f2fd1bae7abc72c468265ac26da95", "body": {"id": "resp_0aecc45148c6351d006921ecf25198819b9db8db64dde392fc", "object": "response", "created_at": 1763831026, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0aecc45148c6351d006921ecf30808819b962b8eda971933cb", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Get fast and slow glue averages for current stage (stable or not)\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Avoid division by zero\n  if (slow <= 0.0)\n    return false;\n\n  // Compute glue lag ratio\n  const double glue_lag_ratio = fast / slow;\n\n  // Threshold for glue lag ratio\n  const double threshold = 0.85;\n\n  // Conflict limit trigger\n  const bool conflict_limit_reached =\n    (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Glue lag trigger\n  const bool glue_lag_trigger =\n    (glue_lag_ratio > threshold) && (solver->level > 0);\n\n  // Only restart once if both triggers fire\n  const bool triggered = glue_lag_trigger || conflict_limit_reached;\n\n  if (triggered) {\n    // On restart, set the next conflict limit adaptively\n    double alpha = solver->stable ? 1.5 : 2.0;\n    uint64_t prev_limit = solver->limits.restart.conflicts;\n    uint64_t next_limit = (uint64_t)(alpha * (double)prev_limit);\n    // Ensure the new limit is at least one more than current\n    if (next_limit <= CONFLICTS)\n      next_limit = CONFLICTS + 1;\n    solver->limits.restart.conflicts = next_limit;\n\n    kissat_extremely_verbose (solver,\n      \"restart triggered (glue_lag_ratio=%.3f, threshold=%.2f, conflicts=%\" PRIu64 \", limit=%\" PRIu64 \"), next_limit=%\" PRIu64,\n      glue_lag_ratio, threshold, CONFLICTS, prev_limit, next_limit);\n\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 434, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1730}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ed5e532081909598083857a36336", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "79fcaedf6634d7ebae83b4eb416ede94", "body": {"id": "resp_0d948974de9d9fce006921ed5479f081998e839f6746fa41ef", "object": "response", "created_at": 1763831124, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0d948974de9d9fce006921ed55013081998c006f55b459463b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Compute glue lag ratio R = fast_glue / slow_glue\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Avoid division by zero: if slow is zero, do not restart on glue lag\n  double ratio = slow > 0.0 ? (fast / slow) : 0.0;\n\n  // Adaptive threshold T (default: 0.85)\n  const double threshold = 0.85;\n\n  // Track if glue lag trigger fires\n  bool glue_lag_trigger = (solver->level > 0) && (ratio > threshold);\n\n  // Track if standard conflict limit trigger fires\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // If neither trigger fires, do not restart\n  if (!glue_lag_trigger && !conflict_trigger)\n    return false;\n\n  // On restart, set the next conflict limit depending on stable stage\n  double alpha = solver->stable ? 1.5 : 2.0;\n  size_t prev_limit = solver->limits.restart.conflicts;\n  size_t new_limit = (size_t)(alpha * (double)prev_limit);\n\n  // Prevent zero limit\n  if (new_limit == 0)\n    new_limit = prev_limit + 1;\n\n  solver->limits.restart.conflicts = CONFLICTS + new_limit;\n\n  // Only restart once even if both triggers fire\n  kissat_extremely_verbose (solver,\n    \"restarting: glue lag trigger %d, conflict trigger %d, \"\n    \"fast_glue %.2f, slow_glue %.2f, ratio %.3f, threshold %.2f, \"\n    \"new conflict limit %zu\",\n    glue_lag_trigger, conflict_trigger, fast, slow, ratio, threshold,\n    solver->limits.restart.conflicts);\n\n  return true;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 448, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1744}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ed60ea5c81909f4a54e6a0173b39", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "ab957f8ed39f4a8e8acafd15646ac04d", "body": {"id": "resp_036343aabf4cc8bd006921ecf27980819abdb4006fc1350738", "object": "response", "created_at": 1763831026, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_036343aabf4cc8bd006921ecf36cc4819aa3d9a69f859583af", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Compute glue lag ratio R = fast_glue / slow_glue\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Default threshold T = 0.85 (configurable via option if desired)\n  const double threshold = 0.85;\n\n  bool glue_lag_trigger = false;\n\n  // Only trigger on meaningful slow glue (avoid div-by-zero)\n  if (slow > 0.0) {\n    const double ratio = fast / slow;\n    if (ratio > threshold)\n      glue_lag_trigger = true;\n    kissat_extremely_verbose (\n      solver,\n      \"adaptive glue lag restart: ratio R = %.4f (fast %.2f / slow %.2f), threshold %.2f, trigger %d\",\n      ratio, fast, slow, threshold, glue_lag_trigger);\n  }\n\n  // Standard conflict limit trigger\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // If either trigger fires, execute restart and scale conflict limit\n  if (solver->level > 0 && (glue_lag_trigger || conflict_trigger)) {\n    // Update conflict limit: alpha depends on stable/unstable stage\n    const double alpha = solver->stable ? 1.5 : 2.0;\n    uint64_t prev_limit = solver->limits.restart.conflicts;\n    // Ensure at least one more conflict is required\n    uint64_t next_limit = prev_limit + (uint64_t)(alpha * prev_limit);\n    solver->limits.restart.conflicts = next_limit;\n    kissat_extremely_verbose (\n      solver,\n      \"adaptive glue lag restart: previous conflict limit %\" PRIu64\n      \", new conflict limit %\" PRIu64 \" (alpha %.2f, stage %s)\",\n      prev_limit, next_limit, alpha, solver->stable ? \"stable\" : \"unstable\");\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 463, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1759}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ed5e4f148190bd3c4acefb0b09ae", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "337d43a12aec11d18f21394f6691fd36", "body": {"id": "resp_06e23c7c68354112006921ecf41148819983cb02237e7d85f1", "object": "response", "created_at": 1763831028, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_06e23c7c68354112006921ecf4bba0819986c410ae62bd3c80", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Step 1: Compute glue lag ratio R = fast_glue / slow_glue\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Defensive: avoid division by zero\n  if (slow <= 0.0)\n    return false;\n\n  const double R = fast / slow;\n\n  // Step 2: Maintain a threshold T (default: 0.85)\n  const double T = 0.85;\n\n  // Step 3: If R > T and current decision level > 0, trigger a restart immediately\n  bool glue_trigger = (R > T) && solver->level;\n\n  // Step 4: Otherwise, if number of conflicts reaches the current conflict limit, trigger a restart\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Step 6: Tie-breaker: If both triggers fire, restart only once and reset conflict limit as in step 5\n  if (glue_trigger || conflict_trigger) {\n    // Step 5: On restart, set the next conflict limit\n    double alpha = solver->stable ? 1.5 : 2.0;\n    kissat_extremely_verbose (solver,\n      \"adaptive glue lag restart: R=%.3f T=%.2f %sconflicts=%\" PRIu64 \" limit=%\" PRIu64 \" alpha=%.1f\",\n      R, T,\n      (conflict_trigger ? \"conflict-limit \" : (glue_trigger ? \"glue-lag \" : \"\")),\n      CONFLICTS, solver->limits.restart.conflicts, alpha);\n\n    solver->limits.restart.conflicts =\n      CONFLICTS + (uint64_t)(alpha * (double)(solver->limits.restart.conflicts - CONFLICTS));\n\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 444, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1740}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ed5e52988190917cdd3fa823f85c", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "db0325d1a9e448a1d7942a2ba9cfe929", "body": {"id": "resp_0dd8e6a9907e0d26006921ecf904608199a8e9bdf632f8643b", "object": "response", "created_at": 1763831033, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0dd8e6a9907e0d26006921ecf9850881998d55c0c3c73d6a42", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Compute glue lag ratio\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Avoid division by zero\n  if (slow == 0.0)\n    return false;\n\n  const double glue_lag_ratio = fast / slow;\n  const double threshold = 0.85;\n\n  bool glue_trigger = (glue_lag_ratio > threshold && solver->level > 0);\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  if (glue_trigger || conflict_trigger) {\n    // Update next conflict limit using adaptive alpha\n    double alpha = solver->stable ? 1.5 : 2.0;\n    size_t prev_limit = solver->limits.restart.conflicts;\n    size_t new_limit = (size_t)(alpha * (double)prev_limit);\n\n    // Advance the conflict limit for next restart\n    solver->limits.restart.conflicts = CONFLICTS + (new_limit > 0 ? new_limit : 1);\n\n    kissat_extremely_verbose (\n      solver,\n      \"AGLR restart: glue_lag_ratio=%.3f threshold=%.2f, prev_limit=%zu new_limit=%zu, reason=%s\",\n      glue_lag_ratio, threshold, prev_limit, solver->limits.restart.conflicts,\n      glue_trigger && conflict_trigger ? \"both\" :\n      glue_trigger ? \"glue\" : \"conflict\"\n    );\n\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 367, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1663}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ed5e501c8190b901cd708c5be52d", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "d1dc249dae06a061a6d4cdf6414192ef", "body": {"id": "resp_008cc6669225ea97006921ecf8c3fc8199b1b7489800682724", "object": "response", "created_at": 1763831032, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_008cc6669225ea97006921ecf95a788199a0bf7c0b24627a23", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Compute glue lag ratio R = fast_glue / slow_glue\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  // Avoid division by zero\n  if (slow <= 0.0)\n    return false;\n  const double R = fast / slow;\n\n  // Adaptive threshold\n  const double T = 0.85;\n\n  bool glue_trigger = (R > T);\n\n  // Conflict limit trigger\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // If neither trigger fires, do not restart\n  if (!glue_trigger && !conflict_trigger)\n    return false;\n\n  // At this point, at least one trigger fires, decision level > 0, and restart is enabled\n\n  // On restart, set next conflict limit\n  double alpha = solver->stable ? 1.5 : 2.0;\n  size_t prev_limit = solver->limits.restart.conflicts;\n  // Ensure prev_limit is at least 1\n  if (prev_limit < 1)\n    prev_limit = 1;\n  size_t next_limit = (size_t)(alpha * (double)prev_limit + 0.5);\n  if (next_limit <= prev_limit)\n    next_limit = prev_limit + 1;\n  solver->limits.restart.conflicts = CONFLICTS + next_limit;\n\n  kissat_extremely_verbose (solver,\n    \"AGLR: restart triggered (%s%s) at conflict %\" PRIu64 \", R=%.4f T=%.2f, next limit=%zu\",\n    glue_trigger ? \"glue\" : \"\",\n    conflict_trigger ? (glue_trigger ? \"+conflict\" : \"conflict\") : \"\",\n    CONFLICTS, R, T, solver->limits.restart.conflicts);\n\n  return true;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 439, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1735}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ed5f6ddc819082e079dedf3416ab", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "8f78e9079aa4012da639eabc4cf91cbd", "body": {"id": "resp_016747fc66dd13b8006921ecf921fc81988a06de684ffec807", "object": "response", "created_at": 1763831033, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_016747fc66dd13b8006921ecf9c11881989facb73b384f738e", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver)\n{\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Adaptive Glue Lag Restart (AGLR) parameters\n  const double threshold = 0.85;\n\n  // Get averages for current stage (stable or focused)\n  const double fast = AVERAGE(fast_glue);\n  const double slow = AVERAGE(slow_glue);\n\n  // Compute glue lag ratio\n  double ratio = 0.0;\n  if (slow > 0.0)\n    ratio = fast / slow;\n  else\n    ratio = 0.0; // Defensive: avoid div by zero, but slow should never be zero\n\n  bool glue_lag_trigger = (ratio > threshold) && (solver->level > 0);\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Only trigger once (tie-breaker: single restart if both fire)\n  bool triggered = glue_lag_trigger || conflict_trigger;\n  if (!triggered)\n    return false;\n\n  // On restart, set the next conflict limit according to policy\n  const double alpha = solver->stable ? 1.5 : 2.0;\n  unsigned old_limit = solver->limits.restart.conflicts;\n  unsigned new_limit = (unsigned) (alpha * old_limit);\n  // Defensive: make sure limit increases by at least 1\n  if (new_limit <= old_limit)\n    new_limit = old_limit + 1;\n  solver->limits.restart.conflicts = CONFLICTS + new_limit;\n\n  kissat_extremely_verbose(\n    solver,\n    \"AGLR restart: triggered (ratio=%.4f threshold=%.2f, level=%u, conflicts=%\" PRIu64 \" limit=%u) \"\n    \"-> new_conflict_limit=%\" PRIu64,\n    ratio, threshold, solver->level, CONFLICTS, old_limit, solver->limits.restart.conflicts);\n\n  return true;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 437, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1733}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ed5e55c48190b17d458960e16514", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "75a7e9d3b1feba99f909dd3f053d4339", "body": {"id": "resp_060dcc00f0978ad5006921ecf9e97c8198a963203071b30d13", "object": "response", "created_at": 1763831034, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_060dcc00f0978ad5006921ecfa840c8198a9d77df4e48ef3fc", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double threshold = 0.85;\n  bool glue_lag_trigger = false;\n\n  if (slow > 0.0) {\n    const double ratio = fast / slow;\n    glue_lag_trigger = (ratio > threshold);\n    kissat_extremely_verbose (solver,\n      \"AGLR: glue lag ratio %g (fast %.2f / slow %.2f) %s threshold %.2f\",\n      ratio, fast, slow, (glue_lag_trigger ? \">\" : \"<=\"), threshold);\n  }\n\n  bool conflict_limit_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  if (!(glue_lag_trigger || conflict_limit_trigger))\n    return false;\n\n  // Only allow restart at level > 0\n  if (!solver->level)\n    return false;\n\n  // Tie-breaker: restart only once if both triggers fire\n  // On restart, set the next conflict limit as per AGLR rule\n  uint64_t prev_limit = solver->limits.restart.conflicts;\n  double alpha = solver->stable ? 1.5 : 2.0;\n  uint64_t new_limit = prev_limit * alpha;\n  if (new_limit <= prev_limit)\n    new_limit = prev_limit + 1; // ensure progress\n  solver->limits.restart.conflicts = CONFLICTS + new_limit;\n\n  kissat_extremely_verbose (solver,\n    \"AGLR: restart triggered (%s), next conflict limit set to %llu (alpha=%.1f)\",\n    glue_lag_trigger && conflict_limit_trigger ? \"both\" :\n    glue_lag_trigger ? \"glue_lag\" : \"conflict_limit\",\n    (unsigned long long) solver->limits.restart.conflicts, alpha);\n\n  return true;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 442, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1738}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ed5e55488190bb0f9e73b69ab737", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "76a2da37f98a7560b055f7697817b901", "body": {"id": "resp_0d2157451dc00475006921ecfb89f8819ba7f696cbb17399cf", "object": "response", "created_at": 1763831035, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0d2157451dc00475006921ecfc0f8c819b854863f761347fa1", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Compute glue lag ratio\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  // Avoid division by zero\n  const double ratio = (slow > 0.0) ? (fast / slow) : 0.0;\n  const double threshold = 0.85;\n\n  bool glue_lag_trigger = (ratio > threshold);\n  bool conflict_limit_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  if (glue_lag_trigger || conflict_limit_trigger) {\n    // On restart, set the next conflict limit adaptively\n    double alpha = solver->stable ? 1.5 : 2.0;\n    kissat_extremely_verbose (solver,\n      \"adaptive glue lag restart: fast_glue = %.2f, slow_glue = %.2f, R = %.4f, threshold = %.2f, conflict_limit = %\" PRIu64,\n      fast, slow, ratio, threshold, solver->limits.restart.conflicts);\n\n    solver->limits.restart.conflicts = CONFLICTS + (uint64_t)(alpha * (solver->limits.restart.conflicts - CONFLICTS));\n    // Ensure at least 1 conflict to avoid stalling\n    if (solver->limits.restart.conflicts <= CONFLICTS)\n      solver->limits.restart.conflicts = CONFLICTS + 1;\n\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 352, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1648}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921ed5e5624819092ff0759026339e9", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "136fb7deeb2d2fb4157a6180b41fa4df", "body": {"id": "resp_0b0dc99d87cf0c76006921ecfdab508199a327a6fe4a41688d", "object": "response", "created_at": 1763831037, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0b0dc99d87cf0c76006921ecfe95608199957dae279381b74b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Compute glue lag ratio R = fast_glue / slow_glue\n  const double fast = AVERAGE(fast_glue);\n  const double slow = AVERAGE(slow_glue);\n  double glue_lag_ratio = 1.0;\n  if (slow > 0.0)\n    glue_lag_ratio = fast / slow;\n\n  const double threshold = 0.85;\n  bool glue_trigger = (glue_lag_ratio > threshold);\n\n  // Conflict limit trigger\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Only restart if at positive decision level\n  if (!(glue_trigger || conflict_trigger))\n    return false;\n\n  if (solver->level == 0)\n    return false;\n\n  // If either glue-lag or conflict trigger fires, restart, but only once and update conflict limit\n  // (Tie-breaker: don't double-trigger)\n  // Update the conflict limit for the next restart\n  double alpha = solver->stable ? 1.5 : 2.0;\n  solver->limits.restart.conflicts = CONFLICTS + (uint64_t)(alpha * (double)(solver->limits.restart.conflicts - CONFLICTS));\n\n  kissat_extremely_verbose(\n      solver,\n      \"restart triggered by %s: glue_lag_ratio=%.3f (threshold=%.2f), conflicts=%\" PRIu64 \"/%\" PRIu64 \", next limit=%\" PRIu64,\n      glue_trigger ? \"glue-lag\" : \"conflict\",\n      glue_lag_ratio, threshold, CONFLICTS, solver->limits.restart.conflicts, solver->limits.restart.conflicts);\n\n  return true;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1296, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 402, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1698}, "user": null, "metadata": {}}}, "error": null}
