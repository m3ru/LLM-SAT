{"id": "batch_req_69222332cf9c8190b227a1521f191d68", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "74f83afda3f3a8f2da4b1b7a86f38cc7", "body": {"id": "resp_0bb0d01127d5c4a2006922232a120881949f2e1a28c18c93da", "object": "response", "created_at": 1763844906, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0bb0d01127d5c4a2006922232a70d48194ba987fa88a722733", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // 1. Hard conflict upper limit per phase\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // If in stable phase, fallback to reluctant trigger (as in Kissat)\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // 2. Gather statistics\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // 3. Compute glue ratio and thresholds\n  const double glue_ratio = fast_glue / (slow_glue > 0.0 ? slow_glue : 1.0);\n  const double glue_ratio_threshold = 1.15;\n\n  // 4. Decision rate threshold\n  // Use initial decision rate as a baseline (assume it's stored as solver->initial_decision_rate)\n  // If not present, default to the current decision rate to avoid accidental restarts.\n  double initial_decision_rate = solver->initial_decision_rate;\n  if (initial_decision_rate <= 0.0)\n    initial_decision_rate = decision_rate > 0.0 ? decision_rate : 1.0;\n  const double decision_rate_threshold = 0.8 * initial_decision_rate;\n\n  // 5. Restart criteria\n  const bool glue_stagnation = glue_ratio > glue_ratio_threshold;\n  const bool decision_stall = decision_rate < decision_rate_threshold;\n\n  // If both criteria trigger, only restart if not at root level (tie-breaker)\n  if (glue_stagnation && decision_stall)\n    return solver->level > 0;\n\n  // Otherwise, restart if either triggers\n  return glue_stagnation || decision_stall;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 443, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1817}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69222332e6608190824db94845f5606c", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "7cf01cf97a875fff7ba7171ad002fa06", "body": {"id": "resp_00c5f3726659884000692222ee208c8196b67166676cd3f2f8", "object": "response", "created_at": 1763844846, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_00c5f3726659884000692222eea3288196b201bed98d3884de", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Use a static variable to store the initial decision rate (per phase)\n  static double initial_decision_rate = 0.0;\n  if (CONFLICTS == solver->limits.restart.conflicts) {\n    // On first conflict after last restart, set baseline\n    initial_decision_rate = decision_rate > 0 ? decision_rate : 1.0;\n  }\n\n  // Parameters\n  const double glue_ratio_threshold = 1.15;\n  const double decision_rate_threshold = 0.8 * initial_decision_rate;\n\n  // Compute glue ratio, with protection against division by zero\n  const double glue_ratio = fast_glue / (slow_glue > 0 ? slow_glue : 1.0);\n\n  // Restart triggers\n  const bool glue_trigger = (glue_ratio > glue_ratio_threshold);\n  const bool decision_trigger = (decision_rate < decision_rate_threshold);\n\n  // If both triggers, only restart if not at root\n  if (glue_trigger && decision_trigger)\n    return solver->level > 0;\n\n  if (glue_trigger || decision_trigger)\n    return true;\n\n  // If in stable mode, fallback to reluctant restarts as in original\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 386, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1760}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69222332edf081909de40fd01e1a2717", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "46879216d5d964130b8aa217e341641b", "body": {"id": "resp_0a958d2b353de865006922232abf2c81949c2c8f09f07d5432", "object": "response", "created_at": 1763844906, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0a958d2b353de865006922232b02d88194b484ca4aa1dbfa76", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Always enforce hard conflict limit\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Stable phase: fallback to reluctant schedule\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // AGDHR: Adaptive Glue-Decision Hybrid Restart\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Prevent division by 0\n  const double denom_slow_glue = slow_glue > 0 ? slow_glue : 1.0;\n  const double denom_decision_rate = decision_rate > 1e-6 ? decision_rate : 1e-6;\n\n  const double glue_ratio = fast_glue / denom_slow_glue;\n\n  // Compute initial decision rate if not yet set\n  static double initial_decision_rate = 0.0;\n  if (initial_decision_rate < 1e-10 && decision_rate > 1e-10)\n    initial_decision_rate = decision_rate;\n\n  // Tunable parameters\n  const double glue_ratio_threshold = 1.15;\n  const double decision_rate_threshold =\n    0.8 * (initial_decision_rate > 1e-10 ? initial_decision_rate : decision_rate);\n\n  const bool glue_trigger = glue_ratio > glue_ratio_threshold;\n  const bool decision_rate_trigger = decision_rate < decision_rate_threshold;\n\n  // Tie-breaker: only restart if not at root\n  if ((glue_trigger || decision_rate_trigger) && solver->level > 0) {\n    kissat_extremely_verbose (\n      solver,\n      \"restarting: glue_ratio=%.3f (thr=%.2f), decision_rate=%.3g (thr=%.3g), level=%u\",\n      glue_ratio, glue_ratio_threshold,\n      decision_rate, decision_rate_threshold,\n      solver->level\n    );\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 486, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1860}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69222332e1d08190b690f1eaaa20f862", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "03fa6bbe512a125f4539484883f5ee48", "body": {"id": "resp_0a3338e93012dcce006922232a42e48197af88b5a2a9d7e600", "object": "response", "created_at": 1763844906, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0a3338e93012dcce006922232a8f4481979ffafc55898ca2e8", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Always allow reluctant restarts in stable phase\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // Adaptive Glue-Decision Hybrid Restart (AGDHR)\n  // Gather stats\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Compute glue ratio\n  const double glue_ratio = fast_glue / (slow_glue > 0.0 ? slow_glue : 1.0);\n\n  // Thresholds (tuneable)\n  const double glue_ratio_threshold = 1.15;\n\n  // On first call, record initial decision rate if not yet done\n  static double initial_decision_rate = 0.0;\n  if (initial_decision_rate <= 0.0) {\n    initial_decision_rate = decision_rate > 0.0 ? decision_rate : 1e-6;\n  }\n  const double decision_rate_threshold = 0.8 * initial_decision_rate;\n\n  // Restart triggers\n  const bool glue_degraded = glue_ratio > glue_ratio_threshold;\n  const bool rate_stalled = decision_rate < decision_rate_threshold;\n\n  // If both triggers, only restart if not at root\n  if (glue_degraded && rate_stalled)\n    return solver->level > 0;\n\n  // Either trigger is sufficient\n  if (glue_degraded || rate_stalled)\n    return true;\n\n  // Otherwise, do not restart\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 406, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1780}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69222332e7b08190a7c4801449d0b5d8", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "f8be04c75fb038a443a60d950a906c8a", "body": {"id": "resp_06e606b9f9af92ff006922232a1288819583ccfbb56dc246a0", "object": "response", "created_at": 1763844906, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_06e606b9f9af92ff006922232a51088195b2975d0dc3053883", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  // Always enforce a hard conflict upper limit per phase\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // In stable phase, fallback to reluctant restarts\n  if (solver->stable)\n    return kissat_reluctant_triggered(&solver->reluctant);\n\n  // Retrieve required averages/statistics\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // Adaptive thresholds (can be tuned via options or hardcoded)\n  const double glue_ratio_threshold = 1.15;\n\n  // We need a reference initial decision rate for thresholding.\n  // Use the maximum ever observed, or fallback to initial value.\n  double initial_decision_rate;\n  if (solver->statistics.max_decision_rate > 0)\n    initial_decision_rate = solver->statistics.max_decision_rate;\n  else\n    initial_decision_rate = decision_rate; // On first pass\n\n  const double decision_rate_threshold = 0.8 * initial_decision_rate;\n\n  // Compute glue ratio and check thresholds\n  const double glue_ratio =\n      fast_glue / (slow_glue > 0 ? slow_glue : 1.0); // avoid div by zero\n\n  const bool glue_trigger = (glue_ratio > glue_ratio_threshold);\n  const bool decision_trigger = (decision_rate < decision_rate_threshold);\n\n  // If both triggers, only restart if not at root level\n  if (glue_trigger && decision_trigger)\n    return solver->level > 0;\n\n  // Restart if either trigger is true\n  if (glue_trigger || decision_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 420, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1794}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69222332e5188190bbb5998052afb785", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "22dde20fa5f3285757b195bb156f5e86", "body": {"id": "resp_09662eedc4442a0a00692222ee659081939c05a7f50996672a", "object": "response", "created_at": 1763844846, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_09662eedc4442a0a00692222eeb0e481938d1d0fcf45b495c6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard conflict upper limit per phase\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Extract required statistics\n  const int stable = solver->stable;\n  const double fast_glue = solver->averages[stable].fast_glue.value;\n  const double slow_glue = solver->averages[stable].slow_glue.value;\n  const double decision_rate = solver->averages[stable].decision_rate.value;\n\n  // Adaptive thresholds\n  const double glue_ratio_threshold = 1.15;\n  // Use the initial (first) decision rate as reference threshold\n  static double initial_decision_rate = 0.0;\n  if (initial_decision_rate == 0.0 && decision_rate > 0.0)\n    initial_decision_rate = decision_rate;\n\n  const double decision_rate_threshold =\n      0.8 * (initial_decision_rate > 0.0 ? initial_decision_rate : 1.0);\n\n  // Calculate glue ratio\n  const double glue_ratio =\n      fast_glue / (slow_glue > 1e-6 ? slow_glue : 1.0);\n\n  // Check the two independent restart triggers\n  const bool glue_trigger = glue_ratio > glue_ratio_threshold;\n  const bool decision_rate_trigger =\n      decision_rate < decision_rate_threshold;\n\n  // Only restart at non-root level if both triggers fire\n  if (glue_trigger && decision_rate_trigger) {\n    if (solver->level > 0)\n      return true;\n    else\n      return false;\n  }\n\n  // Restart if either trigger fires\n  if (glue_trigger || decision_rate_trigger)\n    return true;\n\n  // In stable mode, fallback to reluctant restarts\n  if (stable)\n    return kissat_reluctant_triggered(&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 437, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1811}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69222332e370819094021fbcd8b2e9a2", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "a6691d0dfc2fa6e4c68e523d5a7b7911", "body": {"id": "resp_00c572307403fc2500692222ee1f3481958f51cfa4890debf0", "object": "response", "created_at": 1763844846, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_00c572307403fc2500692222ee70548195aa184508af39f638", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Gather averages relevant for algorithm\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Adaptive Glue-Decision Hybrid Restart parameters\n  const double glue_ratio_threshold = 1.15;\n  // Use the initial decision rate as baseline; default to last known if not available\n  const double initial_decision_rate = solver->averages[solver->stable].initial_decision_rate;\n  const double decision_rate_threshold = 0.8 * initial_decision_rate;\n\n  // Compute glue ratio and decision rate\n  const double glue_ratio = fast_glue / (slow_glue > 0 ? slow_glue : 1);\n\n  // AGDHR: trigger restart if either\n  //   (1) glue ratio > threshold\n  //   OR\n  //   (2) decision rate < threshold\n  // But if both (1) and (2) trigger, only restart if not at root level\n  const bool glue_bad = (glue_ratio > glue_ratio_threshold);\n  const bool decision_stalled = (decision_rate < decision_rate_threshold);\n\n  if (glue_bad && decision_stalled)\n    return solver->level > 0;\n  if (glue_bad)\n    return true;\n  if (decision_stalled)\n    return true;\n\n  // In stable mode, fallback to reluctant trigger\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 403, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1777}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69222332db94819088c5d754f23d69cf", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "42c6c5f7b61fb6f3e527f12697722060", "body": {"id": "resp_0df89c72d28475e800692222ee220c8193b4ce307231fa3157", "object": "response", "created_at": 1763844846, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0df89c72d28475e800692222ee6a2c8193bbd1a43e242bb7d4", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver)\n{\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (solver->statistics.conflicts < solver->limits.restart.conflicts)\n    return false;\n\n  // Use reluctant restarts in stable mode (as in original Kissat)\n  if (solver->stable)\n    return kissat_reluctant_triggered(&solver->reluctant);\n\n  // AGDHR Hybrid: get glues and decision rate\n  const double fast_glue = solver->averages[solver->stable].fast_glue.value;\n  const double slow_glue = solver->averages[solver->stable].slow_glue.value;\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Avoid division by zero\n  const double norm_slow_glue = slow_glue > 1e-9 ? slow_glue : 1.0;\n  const double norm_decision_rate = decision_rate > 1e-6 ? decision_rate : 1e-6;\n\n  // AGDHR: glue and decision thresholds\n  const double glue_ratio = fast_glue / norm_slow_glue;\n  const double glue_ratio_threshold = 1.15;\n\n  // AGDHR: Get initial_decision_rate from restart struct (initialize if needed)\n  double initial_decision_rate = solver->restart.initial_decision_rate;\n  if (initial_decision_rate <= 0)\n  {\n    // Set to current if not initialized\n    initial_decision_rate = decision_rate > 1e-6 ? decision_rate : 1.0;\n    solver->restart.initial_decision_rate = initial_decision_rate;\n  }\n  const double decision_rate_threshold = 0.8 * initial_decision_rate;\n\n  // Triggers\n  const bool glue_trigger = (glue_ratio > glue_ratio_threshold);\n  const bool decision_trigger = (decision_rate < decision_rate_threshold);\n\n  if (glue_trigger && decision_trigger)\n  {\n    // Only restart if not at root level\n    return solver->level > 0;\n  }\n  else if (glue_trigger || decision_trigger)\n  {\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 486, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1860}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69222332da9c819088299767fd10ba80", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "622fdfd2b98f0385e74bf1c1c5f7838c", "body": {"id": "resp_0537caa19b19c39900692222ee73648190aa3580ba4359e1c5", "object": "response", "created_at": 1763844846, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0537caa19b19c39900692222ef1a8c81909d9c6e7ad24c2d85", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Always enforce hard conflict upper limit per phase:\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // In stable mode, fallback to reluctant restarts to guarantee periodicity\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // Adaptive Glue-Decision Hybrid Restart (AGDHR)\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Compute glue ratio\n  const double glue_ratio = fast_glue / (slow_glue > 1e-9 ? slow_glue : 1.0);\n\n  // Thresholds (can be made options if desired)\n  const double glue_ratio_threshold = 1.15;\n  // Use initial decision rate as baseline\n  static double initial_decision_rate = 0.0;\n  if (initial_decision_rate < 1e-12 && decision_rate > 1e-12)\n    initial_decision_rate = decision_rate;\n  const double decision_rate_threshold = 0.8 * initial_decision_rate;\n\n  bool glue_ratio_triggered = glue_ratio > glue_ratio_threshold;\n  bool decision_rate_triggered = decision_rate < decision_rate_threshold;\n\n  kissat_extremely_verbose (\n    solver,\n    \"AGDHR: fast_glue=%g slow_glue=%g glue_ratio=%.3f (thresh %.2f), \"\n    \"decision_rate=%.6f (init %.6f thresh %.6f), \"\n    \"level=%u glue_trigger=%d drate_trigger=%d conflicts=%\" PRIu64 \" limit=%\" PRIu64,\n    fast_glue, slow_glue, glue_ratio, glue_ratio_threshold,\n    decision_rate, initial_decision_rate, decision_rate_threshold,\n    solver->level, glue_ratio_triggered, decision_rate_triggered,\n    CONFLICTS, solver->limits.restart.conflicts);\n\n  // Tie-breaker: if both trigger, only restart if not at root level\n  if ((glue_ratio_triggered || decision_rate_triggered) && solver->level > 0)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 525, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1899}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69222332df808190b1a4a7a874043b7d", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "757d9fcc62b477fa96b4929a34da926a", "body": {"id": "resp_0f82bbe73fe8a07000692222f393288194bde278994276015c", "object": "response", "created_at": 1763844851, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0f82bbe73fe8a07000692222f41838819493ceec31fe6d581e", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Get current averages for this mode (stable/unstable)\n  const int mode = solver->stable;\n  const double fast_glue = solver->averages[mode].fast_glue.value;\n  const double slow_glue = solver->averages[mode].slow_glue.value;\n  const double decision_rate = solver->averages[mode].decision_rate.value;\n\n  // AGDHR algorithm parameters\n  const double glue_ratio_threshold = 1.15;\n  // Use the initial decision rate stored at beginning of phase\n  const double initial_decision_rate = solver->averages[mode].decision_rate.start;\n  const double decision_rate_threshold = 0.8 * initial_decision_rate;\n\n  // Defensive: prevent division by zero and negative values\n  const double safe_slow_glue = slow_glue > 1e-9 ? slow_glue : 1.0;\n  const double safe_decision_rate = decision_rate > 1e-6 ? decision_rate : 1e-6;\n\n  const double glue_ratio = fast_glue / safe_slow_glue;\n\n  bool glue_stagnation = (glue_ratio > glue_ratio_threshold);\n  bool decision_stall = (decision_rate < decision_rate_threshold);\n\n  // Always enforce hard conflict limit (already checked above)\n\n  // If both triggers fire, only restart if not at root\n  if (glue_stagnation && decision_stall)\n    return (solver->level > 0);\n\n  // Otherwise, restart if either condition triggers\n  if (glue_stagnation || decision_stall)\n    return true;\n\n  // In stable mode, fallback to reluctant policy if nothing else triggers\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1374, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 446, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1820}, "user": null, "metadata": {}}}, "error": null}
