{"id": "batch_req_6922232b097081908ecef5b8e8622d5b", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "49453fba57007bfb43a5b6a552704a0a", "body": {"id": "resp_02c26928a2e9f1e600692222ea20c8819080df5da9f86fd792", "object": "response", "created_at": 1763844842, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_02c26928a2e9f1e600692222ea957081909c42acb6b672c3f9", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Fetch relevant statistics\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t last_restart_conflicts = solver->limits.restart.last;\n  const uint64_t max_conflicts = solver->limits.restart.conflicts;\n  const uint64_t conflicts_since_last_restart = conflicts - last_restart_conflicts;\n\n  // AGDSR parameters\n  const double alpha = 0.85;\n  const double beta = 0.995;\n  const uint64_t min_conflicts = 50;\n\n  // Averages\n  const int mode = solver->stable;\n  const double fast = solver->averages[mode].fast_glue.value;\n  const double slow = solver->averages[mode].slow_glue.value;\n  const double dr = solver->averages[mode].decision_rate.value;\n\n  // Persistent historical max decision rate (must be kept in struct kissat).\n  // If not defined, add: double max_decision_rate;\n  double *max_dr = &solver->averages[mode].max_decision_rate;\n  if (dr > *max_dr)\n    *max_dr = dr;\n  const double max_historical_dr = *max_dr;\n\n  // AGDSR: (1) Glue Drop\n  bool glue_drop = (fast < alpha * slow) && (conflicts_since_last_restart >= min_conflicts);\n\n  // AGDSR: (2) Decision Rate Stagnation\n  bool dr_stagnate = (dr < beta * max_historical_dr) && (conflicts_since_last_restart >= min_conflicts);\n\n  // AGDSR: (3) Conflict Limit\n  bool conflict_limit = (conflicts_since_last_restart >= max_conflicts);\n\n  // Tie-breaking: prioritize glue_drop > dr_stagnate > conflict_limit\n  if (glue_drop) {\n    kissat_extremely_verbose (solver,\n      \"restart by glue drop: fast_glue=%.2f < %.2f * slow_glue=%.2f (%.2f), conflicts_since_last_restart=%\" PRIu64,\n      fast, alpha, slow, alpha*slow, conflicts_since_last_restart);\n    return true;\n  }\n  if (dr_stagnate) {\n    kissat_extremely_verbose (solver,\n      \"restart by decision rate stagnation: dr=%.2f < %.3f * max_dr=%.2f (%.2f), conflicts_since_last_restart=%\" PRIu64,\n      dr, beta, max_historical_dr, beta*max_historical_dr, conflicts_since_last_restart);\n    return true;\n  }\n  if (conflict_limit) {\n    kissat_extremely_verbose (solver,\n      \"restart by conflict limit: conflicts_since_last_restart=%\" PRIu64 \" >= max_conflicts=%\" PRIu64,\n      conflicts_since_last_restart, max_conflicts);\n    return true;\n  }\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 654, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 2088}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922232b0a508190ae53d54a5da0c807", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "73f554b787403a5f5f3c0b92080f3c79", "body": {"id": "resp_0efe9db13d7a4f5a0069222326223081938e951edce76c214d", "object": "response", "created_at": 1763844902, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0efe9db13d7a4f5a006922232694388193941bb7216c79ef83", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Parameters for AGDSR\n  const double alpha = 0.85;\n  const double beta = 0.995;\n  const unsigned min_conflicts = 50;\n\n  // Gather statistics\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t last_restart_conflicts = solver->restart.last_conflicts;\n  const uint64_t conflicts_since_last_restart = conflicts - last_restart_conflicts;\n  const uint64_t max_conflicts = solver->limits.restart.conflicts;\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Maintain max historical decision rate\n  // Use static variable for simplicity: safe because restarting() is not reentrant and only called in solver context.\n  // Alternatively, store in solver->restart, but using static for this exercise.\n  static double max_decision_rate = 0;\n  if (decision_rate > max_decision_rate)\n    max_decision_rate = decision_rate;\n\n  // --- Restart triggers (checked in order) ---\n\n  // 1. Glue Drop\n  if (fast < alpha * slow && conflicts_since_last_restart >= min_conflicts)\n  {\n    kissat_extremely_verbose (solver,\n      \"AGDSR: glue drop restart: fast=%.2f < %.2f*slow=%.2f, C=%\" PRIu64,\n      fast, alpha, slow, conflicts_since_last_restart);\n    return true;\n  }\n\n  // 2. Decision Rate Stagnation\n  if (decision_rate < beta * max_decision_rate && conflicts_since_last_restart >= min_conflicts)\n  {\n    kissat_extremely_verbose (solver,\n      \"AGDSR: decision rate stagnation restart: dec_rate=%.2f < %.3f*max_dec_rate=%.2f, C=%\" PRIu64,\n      decision_rate, beta, max_decision_rate, conflicts_since_last_restart);\n    return true;\n  }\n\n  // 3. Conflict Limit\n  if (conflicts_since_last_restart >= max_conflicts)\n  {\n    kissat_extremely_verbose (solver,\n      \"AGDSR: conflict limit restart: C=%\" PRIu64 \" >= max_conflicts=%\" PRIu64,\n      conflicts_since_last_restart, max_conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 564, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1998}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922232afb38819085790b675b3c6f24", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "3473fef48b61b193d4ba8a06f2031bf8", "body": {"id": "resp_0f0acc0d088f1b8000692222ea581081938a135afeef6967da", "object": "response", "created_at": 1763844842, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0f0acc0d088f1b8000692222eaa19c8193880db7000ef598b4", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  //--- AGDSR Parameters\n  const double alpha = 0.85;\n  const double beta = 0.995;\n  const unsigned min_conflicts = 50;\n  const unsigned max_conflicts = solver->limits.restart.conflicts;\n\n  //--- Gather stats\n  const unsigned conflicts = CONFLICTS;\n  const unsigned c = conflicts - solver->statistics.last.restart_conflicts;\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dr = AVERAGE (decision_rate);\n\n  //--- Maximum historical decision rate (persistent in solver)\n  double *max_historical_dr_ptr = &solver->statistics.max_historical_decision_rate;\n  // Initialize if necessary\n  if (*max_historical_dr_ptr < 1e-12)\n    *max_historical_dr_ptr = dr;\n\n  //--- 1. Glue Drop\n  if (fast < alpha * slow && c >= min_conflicts)\n  {\n    kissat_extremely_verbose (solver,\n      \"AGDSR: glue drop restart: fast_glue %.2f < alpha*slow_glue %.2f (alpha=%.2f), c=%u\",\n      fast, alpha * slow, alpha, c);\n    solver->statistics.last.restart_conflicts = conflicts;\n    if (dr > *max_historical_dr_ptr)\n      *max_historical_dr_ptr = dr;\n    return true;\n  }\n\n  //--- 2. Decision Rate Stagnation\n  if (dr < beta * (*max_historical_dr_ptr) && c >= min_conflicts)\n  {\n    kissat_extremely_verbose (solver,\n      \"AGDSR: decision rate stagnation restart: dr %.2f < beta*max_dr %.2f (beta=%.3f), c=%u\",\n      dr, beta * (*max_historical_dr_ptr), beta, c);\n    solver->statistics.last.restart_conflicts = conflicts;\n    return true;\n  }\n\n  //--- 3. Conflict Limit\n  if (c >= max_conflicts)\n  {\n    kissat_extremely_verbose (solver,\n      \"AGDSR: conflict limit restart: c=%u >= max_conflicts=%u\", c, max_conflicts);\n    solver->statistics.last.restart_conflicts = conflicts;\n    return true;\n  }\n\n  //--- Update max historical DR if improved (no restart)\n  if (dr > *max_historical_dr_ptr)\n    *max_historical_dr_ptr = dr;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 578, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 2012}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922232b05808190a91ac326eb170fdc", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "130b8032f1e63be46830e55da3013fcd", "body": {"id": "resp_0e0648d976d7781200692222ea8fb881909bd862e7e11c7ded", "object": "response", "created_at": 1763844842, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0e0648d976d7781200692222eacd3481909526d6b222458b83", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Constants for AGDSR\n  const double alpha = 0.85;              // glue drop threshold\n  const double beta = 0.995;              // decision rate stagnation threshold\n  const unsigned min_conflicts = 50;      // minimum conflicts before restart\n\n  // Fetch current statistics\n  const unsigned conflicts = CONFLICTS;\n  const unsigned max_conflicts = solver->limits.restart.conflicts;\n\n  // Track number of conflicts since last restart\n  unsigned *since_last_restart = &solver->restarting.conflicts_since;\n  // This field (conflicts_since) must be zeroed after each restart, and\n  // incremented elsewhere in the main loop after each conflict.\n\n  // Fast/slow glue averages and decision rate\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Max historical decision rate (initialize if needed)\n  double *max_decision_rate = &solver->restarting.max_decision_rate;\n  if (*max_decision_rate < decision_rate)\n    *max_decision_rate = decision_rate;\n\n  // Check triggers in priority order\n\n  // 1. Glue Drop: F < alpha*S and enough conflicts since last restart\n  if (fast < alpha * slow && *since_last_restart >= min_conflicts) {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDSR: glue drop triggered restart: fast_glue %.2f < %.2f * slow_glue %.2f, conflicts_since %u\",\n      fast, alpha, slow, *since_last_restart);\n    *since_last_restart = 0;\n    return true;\n  }\n\n  // 2. Decision Rate Stagnation: DR < beta*max(DR) and enough conflicts\n  if (decision_rate < beta * (*max_decision_rate) && *since_last_restart >= min_conflicts) {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDSR: decision-rate stagnation triggered restart: decision_rate %.2f < %.3f * max_decision_rate %.2f, conflicts_since %u\",\n      decision_rate, beta, *max_decision_rate, *since_last_restart);\n    *since_last_restart = 0;\n    return true;\n  }\n\n  // 3. Traditional conflict limit\n  if (*since_last_restart >= max_conflicts) {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDSR: max conflicts triggered restart: conflicts_since %u >= max_conflicts %u\",\n      *since_last_restart, max_conflicts);\n    *since_last_restart = 0;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 622, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 2056}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922232b09c08190bdbf1c3eddd2af9f", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "b30f12e1df838effece780ce403a1a8f", "body": {"id": "resp_0cc22357341d788800692222ea6a688193bca365008454aee7", "object": "response", "created_at": 1763844842, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0cc22357341d788800692222eae4308193a82aca7ffc47f3fe", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Parameters\n  const double alpha = 0.85;\n  const double beta = 0.995;\n  const unsigned min_conflicts = 50;\n\n  // Gather required statistics\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Conflicts since last restart\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n  // Persistent storage for max historical decision rate\n  double *max_hist_decision_rate_ptr = &solver->restart_max_decision_rate;\n  if (!*max_hist_decision_rate_ptr || decision_rate > *max_hist_decision_rate_ptr)\n    *max_hist_decision_rate_ptr = decision_rate;\n  const double max_hist_decision_rate = *max_hist_decision_rate_ptr;\n\n  // Conflicts since last restart (local counter)\n  uint64_t *conflicts_since_restart_ptr = &solver->restart_conflicts_since_last;\n  if (!*conflicts_since_restart_ptr)\n    *conflicts_since_restart_ptr = 0;\n  uint64_t conflicts_since_restart = *conflicts_since_restart_ptr;\n\n  if (solver->statistics.conflicts == solver->restart_last_conflict)\n    return false;\n\n  // Update conflicts since last restart\n  conflicts_since_restart +=\n    solver->statistics.conflicts - solver->restart_last_conflict;\n\n  // 1. Glue Drop: F < alpha * S and C >= min_conflicts\n  bool glue_drop = (fast_glue < alpha * slow_glue) &&\n                   (conflicts_since_restart >= min_conflicts);\n\n  // 2. Decision Rate Stagnation: DR < beta * max_hist_DR and C >= min_conflicts\n  bool stagnation = (decision_rate < beta * max_hist_decision_rate) &&\n                    (conflicts_since_restart >= min_conflicts);\n\n  // 3. Conflict Limit: C >= conflict_limit\n  bool conflict_limit_hit = (conflicts_since_restart >= conflict_limit);\n\n  // Restart triggers (priority: glue_drop > stagnation > conflict_limit)\n  bool triggered = false;\n  const char *reason = 0;\n  if (glue_drop) {\n    triggered = true;\n    reason = \"glue-drop\";\n  } else if (stagnation) {\n    triggered = true;\n    reason = \"decision-rate-stagnation\";\n  } else if (conflict_limit_hit) {\n    triggered = true;\n    reason = \"conflict-limit\";\n  }\n\n  if (triggered) {\n    kissat_extremely_verbose (solver,\n      \"AGDSR restart: reason=%s, conflicts_since_restart=%\" PRIu64\n      \", fast_glue=%.2f, slow_glue=%.2f, decision_rate=%.2f, max_hist_decision_rate=%.2f\",\n      reason, conflicts_since_restart, fast_glue, slow_glue, decision_rate, max_hist_decision_rate);\n\n    // Reset counters\n    *conflicts_since_restart_ptr = 0;\n    solver->restart_last_conflict = solver->statistics.conflicts;\n    return true;\n  } else {\n    *conflicts_since_restart_ptr = conflicts_since_restart;\n    solver->restart_last_conflict = solver->statistics.conflicts;\n    return false;\n  }\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 763, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 2197}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922232b03f88190860c1870247f8830", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "521d4c9695129cba3145be8f32bd3c89", "body": {"id": "resp_06d4c686b2d5daee00692222ea8cf88190a4172c36f5c37f84", "object": "response", "created_at": 1763844842, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_06d4c686b2d5daee00692222eb5578819082fda92cd05b33b0", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  // Constants for AGDSR\n  const double alpha = 0.85;       // Glue drop threshold\n  const double beta = 0.995;       // Decision rate stagnation threshold\n  const unsigned min_conflicts = 50;\n\n  // Get statistics\n  const unsigned conflicts = solver->statistics.conflicts;\n  const unsigned since_last_restart = conflicts - solver->restart.last_conflicts;\n  const unsigned max_conflicts = solver->limits.restart.conflicts;\n\n  // Averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dr = AVERAGE (decision_rate);\n\n  // Maintain and update max historical decision rate (per stage)\n  double *max_dr = &solver->restart.max_decision_rate[solver->stable];\n  if (dr > *max_dr)\n    *max_dr = dr;\n\n  // 1. Glue Drop: F < alpha * S and C >= min_conflicts\n  const double glue_drop_limit = alpha * slow;\n  if (fast < glue_drop_limit && since_last_restart >= min_conflicts) {\n    kissat_extremely_verbose(\n      solver,\n      \"AGDSR restart: glue drop (fast = %g < %.2f * slow = %g, C = %u >= %u)\",\n      fast, alpha, slow, since_last_restart, min_conflicts\n    );\n    return true;\n  }\n\n  // 2. Decision Rate Stagnation: DR < beta * max_historical_dr and C >= min_conflicts\n  const double dr_stagnation_limit = beta * (*max_dr);\n  if (dr < dr_stagnation_limit && since_last_restart >= min_conflicts) {\n    kissat_extremely_verbose(\n      solver,\n      \"AGDSR restart: decision rate stagnation (dr = %g < %.3f * max_dr = %g, C = %u >= %u)\",\n      dr, beta, *max_dr, since_last_restart, min_conflicts\n    );\n    return true;\n  }\n\n  // 3. Conflict Limit: C >= max_conflicts\n  if (since_last_restart >= max_conflicts) {\n    kissat_extremely_verbose(\n      solver,\n      \"AGDSR restart: conflict limit (C = %u >= %u)\",\n      since_last_restart, max_conflicts\n    );\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 560, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1994}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922232b0480819093dbd5c9c1f39470", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "9de7ef59ad740734e75722687721b0d7", "body": {"id": "resp_08a209e5a7d0490500692222ea4ab88193862620e1201f4877", "object": "response", "created_at": 1763844842, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08a209e5a7d0490500692222eadabc81938d4e98708a846baa", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // AGDSR parameters\n  const double alpha = 0.85;\n  const double beta = 0.995;\n  const unsigned min_conflicts = 50;\n  const unsigned max_conflicts = solver->limits.restart.conflicts;\n\n  // Retrieve values\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dr = AVERAGE (decision_rate);\n\n  // Compute number of conflicts since last restart\n  const uint64_t conflicts = solver->statistics.conflicts;\n  static uint64_t last_restart_conflicts = 0;\n  const unsigned conflicts_since_restart =\n    (unsigned)(conflicts - last_restart_conflicts);\n\n  // Maintain max historical decision rate (thread-local for parallel runs)\n  static double max_decision_rate = 0.0;\n  if (dr > max_decision_rate)\n    max_decision_rate = dr;\n\n  // 1. Glue Drop Trigger\n  if (fast < alpha * slow && conflicts_since_restart >= min_conflicts)\n  {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDSR: glue drop restart: fast_glue (%g) < %g * slow_glue (%g) after %u conflicts\",\n      fast, alpha, slow, conflicts_since_restart);\n    last_restart_conflicts = conflicts;\n    return true;\n  }\n\n  // 2. Decision Rate Stagnation Trigger\n  if (dr < beta * max_decision_rate && conflicts_since_restart >= min_conflicts)\n  {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDSR: decision rate stagnation restart: dr (%g) < %g * max_dr (%g) after %u conflicts\",\n      dr, beta, max_decision_rate, conflicts_since_restart);\n    last_restart_conflicts = conflicts;\n    return true;\n  }\n\n  // 3. Conflict Limit Trigger\n  if (conflicts_since_restart >= max_conflicts)\n  {\n    kissat_extremely_verbose (\n      solver,\n      \"AGDSR: conflict limit restart: %u >= %u\",\n      conflicts_since_restart, max_conflicts);\n    last_restart_conflicts = conflicts;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 517, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1951}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922232b10c08190b8aebc3f66930aa6", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "07e7185cb4d01fa5aa12109e5a1a1b18", "body": {"id": "resp_0e1b2e1edfe8813100692222ee29ac819583faf8e8707a9638", "object": "response", "created_at": 1763844846, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0e1b2e1edfe8813100692222ee5d048195b0ff976081553a20", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Algorithm parameters\n  const double alpha = 0.85;    // Glue drop threshold\n  const double beta = 0.995;    // Decision rate stagnation threshold\n  const unsigned min_conflicts = 50; // Minimum conflicts before restart\n\n  // Gather statistics\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t last_restart_conflicts = solver->restart_conflicts;\n  const uint64_t conflicts_since_last_restart = conflicts - last_restart_conflicts;\n  const uint64_t max_conflicts = solver->limits.restart.conflicts;\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Historical maximum decision rate storage (use solver field if available)\n  double *max_decision_rate_ptr = &solver->max_decision_rate;\n  if (!kissat_isfinite (*max_decision_rate_ptr) || decision_rate > *max_decision_rate_ptr)\n    *max_decision_rate_ptr = decision_rate;\n  const double max_historical_decision_rate = *max_decision_rate_ptr;\n\n  // 1. Glue Drop Trigger\n  if (fast < alpha * slow && conflicts_since_last_restart >= min_conflicts) {\n    kissat_extremely_verbose (solver,\n      \"AGDSR restart: glue drop (fast %.2f < %.2f * slow %.2f), after %\" PRIu64 \" conflicts\",\n      fast, alpha, slow, conflicts_since_last_restart);\n    return true;\n  }\n\n  // 2. Decision Rate Stagnation Trigger\n  if (decision_rate < beta * max_historical_decision_rate &&\n      conflicts_since_last_restart >= min_conflicts) {\n    kissat_extremely_verbose (solver,\n      \"AGDSR restart: decision rate stagnation (%.2f < %.3f * max-historical %.2f), after %\" PRIu64 \" conflicts\",\n      decision_rate, beta, max_historical_decision_rate, conflicts_since_last_restart);\n    return true;\n  }\n\n  // 3. Conflict Limit Trigger\n  if (conflicts_since_last_restart >= max_conflicts) {\n    kissat_extremely_verbose (solver,\n      \"AGDSR restart: conflict limit (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      conflicts_since_last_restart, max_conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 563, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1997}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922232b090c81908276776688beca5e", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "04f6c9c87326774e7c5a7f6631fcd046", "body": {"id": "resp_07ec7c693aad89ac00692222eebb948195ae3bfe2ca798a498", "object": "response", "created_at": 1763844846, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_07ec7c693aad89ac00692222ef33248195a85501c4c16274ab", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // --- AGDSR PARAMETERS ---\n  const double alpha = 0.85;\n  const double beta = 0.995;\n  const unsigned min_conflicts = 50;\n  const unsigned max_conflicts = solver->limits.restart.conflicts;\n\n  // --- STATE ---\n  // C = number of conflicts since last restart\n  const unsigned conflicts = solver->statistics.conflicts;\n  unsigned *last_restart_conflicts_ptr = &solver->agdsr_last_restart_conflicts;\n  unsigned since_last_restart = conflicts - *last_restart_conflicts_ptr;\n\n  // F = fast average glue, S = slow average glue\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // DR = decision rate moving average\n  const double dr = AVERAGE (decision_rate);\n\n  // Maintain running max of decision rate\n  double *max_dr_ptr = &solver->agdsr_max_dr;\n  if (dr > *max_dr_ptr)\n    *max_dr_ptr = dr;\n  const double max_dr = *max_dr_ptr;\n\n  // --- AGDSR: Check triggers in priority order ---\n  bool triggered = false;\n\n  // 1. Glue Drop\n  if (!triggered && fast < alpha * slow && since_last_restart >= min_conflicts)\n    triggered = true;\n\n  // 2. Decision Rate Stagnation\n  if (!triggered && dr < beta * max_dr && since_last_restart >= min_conflicts)\n    triggered = true;\n\n  // 3. Conflict Limit\n  if (!triggered && since_last_restart >= max_conflicts)\n    triggered = true;\n\n  if (triggered) {\n    // Reset C after restart\n    *last_restart_conflicts_ptr = conflicts;\n    kissat_extremely_verbose (solver,\n      \"AGDSR restart: fast_glue=%g slow_glue=%g dr=%g max_dr=%g conflicts_since_last_restart=%u\",\n      fast, slow, dr, max_dr, since_last_restart);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 484, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1918}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922232b0ab4819087e38c31a16a2fd5", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "1bbee0c0db1265efaf36378e1a702166", "body": {"id": "resp_0fd6e9be2c79765f00692222eef3dc81909c59382d7454e08b", "object": "response", "created_at": 1763844846, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0fd6e9be2c79765f00692222ef721c8190a5f7cf793f358691", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver)\n{\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // AGDSR Parameters\n  const double alpha = 0.85;\n  const double beta = 0.995;\n  const unsigned min_conflicts = 50;\n  const unsigned max_conflicts = solver->limits.restart.conflicts;\n\n  // Gather statistics\n  const double fast = AVERAGE(fast_glue);\n  const double slow = AVERAGE(slow_glue);\n  const double dr = AVERAGE(decision_rate);\n\n  // Number of conflicts since last restart\n  const unsigned conflicts = CONFLICTS;\n\n  // Maintain and update max historical decision rate\n  // Use a solver field to store the max historical decision rate\n  if (!solver->agdsr_max_decision_rate_initialized) {\n    solver->agdsr_max_decision_rate = dr;\n    solver->agdsr_max_decision_rate_initialized = true;\n  } else if (dr > solver->agdsr_max_decision_rate) {\n    solver->agdsr_max_decision_rate = dr;\n  }\n  const double max_dr = solver->agdsr_max_decision_rate;\n\n  // AGDSR Restart Triggers\n  bool glue_drop = false, stagnation = false, conflict_limit = false;\n\n  // 1. Glue Drop: F < alpha * S and C >= min_conflicts\n  if (fast < alpha * slow && conflicts >= min_conflicts)\n    glue_drop = true;\n\n  // 2. Decision Rate Stagnation: DR < beta * max historical DR and C >= min_conflicts\n  if (dr < beta * max_dr && conflicts >= min_conflicts)\n    stagnation = true;\n\n  // 3. Conflict Limit: C >= max_conflicts\n  if (conflicts >= max_conflicts)\n    conflict_limit = true;\n\n  // Tie-breaker: prioritize glue_drop > stagnation > conflict_limit\n  if (glue_drop) {\n    kissat_extremely_verbose(\n      solver,\n      \"AGDSR: glue drop restart (fast_glue %.2f < %.2f * slow_glue %.2f, after %u conflicts)\",\n      fast, alpha, slow, conflicts);\n    return true;\n  }\n  if (stagnation) {\n    kissat_extremely_verbose(\n      solver,\n      \"AGDSR: decision rate stagnation restart (dr %.2f < %.3f * max_dr %.2f, after %u conflicts)\",\n      dr, beta, max_dr, conflicts);\n    return true;\n  }\n  if (conflict_limit) {\n    kissat_extremely_verbose(\n      solver,\n      \"AGDSR: conflict limit restart (%u >= %u)\",\n      conflicts, max_conflicts);\n    return true;\n  }\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1434, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 619, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 2053}, "user": null, "metadata": {}}}, "error": null}
