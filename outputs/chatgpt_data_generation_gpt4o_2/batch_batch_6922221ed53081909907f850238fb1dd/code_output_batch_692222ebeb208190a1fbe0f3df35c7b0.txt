{"id": "batch_req_6922233d274c8190a605dfcc1e5ecc08", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "7802cfea1f05016920b1a43afbb02f7f", "body": {"id": "resp_0d3855a5c84cfb2700692223323798819a8314207d442ed17c", "object": "response", "created_at": 1763844914, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0d3855a5c84cfb270069222332ae74819a91fc1d3f092c165b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  // Adaptive Glue Drop Restart (AGDR) parameters\n  const double threshold = 0.85;\n  const unsigned min_interval = solver->stable ? 100 : 50;\n\n  // Only allow restart if conflict interval reached\n  if (solver->statistics.conflicts < solver->limits.restart.conflicts)\n    return false;\n\n  // Compute glue averages and ratio\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Avoid division by zero\n  if (slow <= 0.0)\n    return false;\n\n  const double ratio = fast / slow;\n\n  // Diagnostic output\n  kissat_extremely_verbose (\n    solver,\n    \"AGDR: fast_glue=%g, slow_glue=%g, ratio=%.3f, threshold=%.2f, level=%u, interval=%u\",\n    fast, slow, ratio, threshold, solver->level, min_interval);\n\n  // Tie-breaker: check decision rate moving average trend if ratio == threshold\n  if (ratio == threshold) {\n    // Only trigger restart if decision rate moving average has decreased for last 10 conflicts\n    // Since only current value is available, we cannot check trend,\n    // so we choose to NOT trigger restart at tie-point (safe fallback).\n    return false;\n  }\n\n  if (ratio < threshold && solver->level > 0) {\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 355, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1679}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922233d21848190a7280a33e467e7d5", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "f1b5853697c64bd86d90840f4cff26d4", "body": {"id": "resp_05c5df2ac91cb6b600692223323924819bb60df5ffe8668a2f", "object": "response", "created_at": 1763844914, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_05c5df2ac91cb6b60069222332c108819b96bfd27c350918e6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Adaptive minimum interval\n  const unsigned min_conflicts = solver->stable ? 100 : 50;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n  if (CONFLICTS - solver->limits.restart.conflicts < min_conflicts)\n    return false;\n\n  const double fast = AVERAGE(fast_glue);\n  const double slow = AVERAGE(slow_glue);\n\n  if (slow == 0.0) // avoid division by zero\n    return false;\n\n  const double ratio = fast / slow;\n  const double threshold = 0.85;\n\n  // Helper: check if decision rate has decreased for last 10 conflicts\n  bool decision_rate_decreased = false;\n  if (ratio == threshold) {\n    // Use solver->averages[solver->stable].decision_rate.value as moving average.\n    // In Kissat, we do not store history, so we can't check the last 10 true values.\n    // Thus, as a safe fallback, do NOT trigger on tie unless we have more info.\n    return false;\n  }\n\n  if (ratio < threshold && solver->level > 0) {\n    kissat_extremely_verbose(solver,\n        \"AGDR restart: ratio fast/slow glue %.4f < threshold %.2f at conflicts %lu (level %u)\",\n        ratio, threshold, CONFLICTS, solver->level);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 354, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1678}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922233d221c81909c8628d4dfef6cc9", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "762278e9f335669757da8693cf1e6f7b", "body": {"id": "resp_0b7cd60162ee3ab900692222f66c848199ba6fa1c80fe6b89f", "object": "response", "created_at": 1763844854, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0b7cd60162ee3ab900692222f70bfc81998799aba0d5cd1b4b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Adaptive Glue Drop Restart (AGDR) parameters\n  const double threshold = 0.85;\n\n  // Minimum conflict interval between restarts\n  unsigned min_conflicts = 50;\n  if (solver->stable)\n    min_conflicts = 100;\n\n  // Only restart if enough conflicts have passed since the last restart limit\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n  if ((CONFLICTS - solver->limits.restart.conflicts) < min_conflicts)\n    return false;\n\n  // Retrieve moving averages for glue\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Compute ratio R = fast / slow\n  double ratio = 0.0;\n  if (slow > 0.0)\n    ratio = fast / slow;\n  else\n    ratio = 1.0;\n\n  // Track the decision rate moving average for the tie-breaker\n  const double curr_decision_rate = AVERAGE (decision_rate);\n\n  // Static ring buffer for last 10 decision rates\n  #define RATE_HISTORY_LEN 10\n  static double rate_history[RATE_HISTORY_LEN] = {0.0};\n  static unsigned rate_history_index = 0;\n  static bool initialized = false;\n\n  // On first call, initialize the history\n  if (!initialized)\n  {\n    for (unsigned i = 0; i < RATE_HISTORY_LEN; i++)\n      rate_history[i] = curr_decision_rate;\n    initialized = true;\n  }\n\n  // Check if decision rate has decreased over the last 10 conflicts (for tie-breaker)\n  bool decision_rate_decreasing = true;\n  unsigned idx = rate_history_index;\n  for (unsigned i = 0; i < RATE_HISTORY_LEN - 1; i++)\n  {\n    unsigned prev = (idx + RATE_HISTORY_LEN - 1) % RATE_HISTORY_LEN;\n    if (rate_history[prev] < rate_history[idx])\n    {\n      decision_rate_decreasing = false;\n      break;\n    }\n    idx = prev;\n  }\n\n  // Update history with current decision rate\n  rate_history[rate_history_index] = curr_decision_rate;\n  rate_history_index = (rate_history_index + 1) % RATE_HISTORY_LEN;\n\n  kissat_extremely_verbose (solver,\n    \"AGDR: fast_glue=%.4f slow_glue=%.4f ratio=%.4f threshold=%.2f \"\n    \"decision_rate=%.4f decreasing=%d min_conflicts=%u (since last: %u)\",\n    fast, slow, ratio, threshold, curr_decision_rate, decision_rate_decreasing,\n    min_conflicts, (unsigned)(CONFLICTS - solver->limits.restart.conflicts));\n\n  // AGDR Restart Policy\n  if (solver->level > 0)\n  {\n    if (ratio < threshold)\n      return true;\n    if (ratio == threshold && decision_rate_decreasing)\n      return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 684, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 2008}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922233d38fc81908776860eec1d7cff", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "dbba03aab188e935ba315412e71793e1", "body": {"id": "resp_04851dbc5506d57f006922233233c4819ab57e985ff9ded5ba", "object": "response", "created_at": 1763844914, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_04851dbc5506d57f0069222332eccc819a843f649aafb13c89", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Minimum interval between restarts\n  unsigned min_conflicts = 50;\n  if (solver->stable)\n    min_conflicts = 100;\n\n  // Conflicts since last restart\n  unsigned conflicts = solver->statistics.conflicts;\n  unsigned restart_limit = solver->limits.restart.conflicts;\n  if (conflicts < restart_limit + min_conflicts)\n    return false;\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  if (slow == 0.0) // Prevent divide by zero (should not happen)\n    return false;\n\n  const double ratio = fast / slow;\n  const double threshold = 0.85;\n\n  // Tie-breaker: If ratio equals threshold, trigger only if decision rate moving average decreased in last 10 conflicts.\n  if (ratio == threshold) {\n    // Simple approach: check if current decision rate is less than 10-conflict-ago rate\n    // (Kissat does not keep a 10-conflict history, so use a 1-conflict delta as proxy)\n    static double prev_decision_rate = 0.0;\n    double curr_decision_rate = AVERAGE (decision_rate);\n    bool decreased = curr_decision_rate < prev_decision_rate;\n    prev_decision_rate = curr_decision_rate;\n    if (!decreased)\n      return false;\n    kissat_extremely_verbose (solver,\n      \"AGDR: tie-breaker at ratio %.4f == %.4f, decision rate decreased: %d\",\n      ratio, threshold, decreased);\n    return true;\n  }\n\n  if (ratio < threshold) {\n    kissat_extremely_verbose (solver,\n      \"AGDR: restart triggered (ratio fast/slow glue %.4f < threshold %.2f, min_conflicts %u, current %u)\",\n      ratio, threshold, min_conflicts, conflicts - restart_limit);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 461, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1785}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922233d28f481909a77ad4ffcd041e2", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "bc7002cc0ee9fb9748964ef9b4066120", "body": {"id": "resp_0d4ae9a0c04c3b0f00692222f723b0819895ef3c32680df63e", "object": "response", "created_at": 1763844855, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0d4ae9a0c04c3b0f00692222f9838481989efe49fa45804a69", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // AGDR minimum interval logic\n    const uint64_t conflicts = solver->statistics.conflicts;\n    static uint64_t last_restart_conflicts = 0;\n\n    // Minimum interval: 50, or 100 in stable stage\n    const uint64_t min_interval = solver->stable ? 100 : 50;\n    if (conflicts < last_restart_conflicts + min_interval)\n        return false;\n\n    // Get fast and slow glue averages\n    const double fast = AVERAGE(fast_glue);\n    const double slow = AVERAGE(slow_glue);\n\n    if (slow == 0.0) // Prevent division by zero\n        return false;\n\n    const double ratio = fast / slow;\n    const double threshold = 0.85;\n\n    if (ratio < threshold) {\n        last_restart_conflicts = conflicts;\n        kissat_extremely_verbose(\n            solver,\n            \"adaptive glue drop restart: R=%.3f < T=%.2f (F=%.3f, S=%.3f) at conflicts=%\" PRIu64,\n            ratio, threshold, fast, slow, conflicts);\n        return true;\n    }\n\n    // Tie-breaker: If ratio == threshold, check if decision rate MA has decreased for last 10 conflicts\n    if (ratio == threshold) {\n        // Use the stable/unstable slot for the moving average\n        const average *decision_rate_avg = &solver->averages[solver->stable].decision_rate;\n        // Since we don't have explicit historical values, we use the value and trend\n        // In Kissat, the .value field is maintained as an exponential moving average.\n        // We'll do a simple check: if the recent value < previous value, treat as decrease.\n        // Approximate: keep a static to store previous value\n        static double prev_decision_rate = -1.0;\n        const double curr_decision_rate = decision_rate_avg->value;\n        bool decreased = false;\n        if (prev_decision_rate >= 0.0 && curr_decision_rate < prev_decision_rate)\n            decreased = true;\n        prev_decision_rate = curr_decision_rate;\n\n        if (decreased) {\n            last_restart_conflicts = conflicts;\n            kissat_extremely_verbose(\n                solver,\n                \"adaptive glue drop restart (tie-break): R=%.3f == T=%.2f, decision rate dropped (%.6f < %.6f) at conflicts=%\" PRIu64,\n                ratio, threshold, curr_decision_rate, prev_decision_rate, conflicts);\n            return true;\n        }\n    }\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 594, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1918}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922233d2edc819090a61c113ac5b203", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "7d4206d988d72952998b777cd732abda", "body": {"id": "resp_039b144d6b03612900692222f746dc819a9da9598c9c96c3b5", "object": "response", "created_at": 1763844855, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_039b144d6b03612900692222f85698819a9f840eb9eb0d1105", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Adaptive interval: 50 conflicts in focused, 100 in stable stage.\n    const uint64_t min_conflicts = solver->stable ? 100 : 50;\n    if (CONFLICTS < solver->limits.restart.conflicts)\n        return false;\n    if (CONFLICTS - solver->limits.restart.conflicts < min_conflicts)\n        return false;\n\n    // Compute fast/slow glue ratio\n    const double fast = AVERAGE(fast_glue);\n    const double slow = AVERAGE(slow_glue);\n    if (slow <= 0.0) // Avoid division by zero\n        return false;\n    const double ratio = fast / slow;\n    const double threshold = 0.85;\n\n    if (ratio < threshold && solver->level > 0)\n        return true;\n\n    if (ratio > threshold)\n        return false;\n\n    // Tie-breaker: If ratio == threshold, check if decision rate has decreased for last 10 conflicts\n    // We only have access to the moving average of decision rate; we can't look back 10 steps, but can track trend\n    // For this example, we'll check if the current avg is less than the previous stored value.\n    // We'll use a static variable (this is safe in Kissat's restart context)\n    static double last_decision_rate = -1.0;\n    const double decision_rate = AVERAGE(decision_rate);\n\n    bool tie_break = false;\n    if (last_decision_rate >= 0.0 && decision_rate < last_decision_rate)\n        tie_break = true;\n    last_decision_rate = decision_rate;\n\n    if (ratio == threshold && solver->level > 0 && tie_break)\n        return true;\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 411, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1735}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922233d21dc81908029f0cd0a1a3166", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "b161a85c2bff34fe549fe51b6065c649", "body": {"id": "resp_018dbc54f52bf77200692222f72984819abe4d301bca61bb77", "object": "response", "created_at": 1763844855, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_018dbc54f52bf77200692222f78eec819aaddc843690d7556b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Minimum conflict interval logic\n  uint64_t min_conflicts = 50;\n  if (solver->stable)\n    min_conflicts = 100;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n  if (CONFLICTS - solver->limits.restart.last < min_conflicts)\n    return false;\n\n  // Adaptive Glue Drop Restart (AGDR) algorithm\n  const double fast = AVERAGE(fast_glue);\n  const double slow = AVERAGE(slow_glue);\n  if (slow == 0.0)\n    return false; // avoid division by zero\n\n  const double ratio = fast / slow;\n  const double threshold = 0.85;\n\n  if (ratio < threshold && solver->level > 0)\n    return true;\n\n  // Tie-breaker: if ratio exactly at threshold, check decision rate trend\n  if (ratio == threshold && solver->level > 0) {\n    // Check if decision rate moving average has decreased for the last 10 conflicts\n    // We'll use the simple method: store previous value in solver->agdr_last_decision_rate (double)\n    // and a counter in solver->agdr_dec_rate_decreased (int, up to 10)\n    // Initialize if uninitialized\n    if (solver->agdr_dec_rate_decreased < 0)\n      solver->agdr_dec_rate_decreased = 0;\n    double current_decision_rate = AVERAGE(decision_rate);\n\n    if (current_decision_rate < solver->agdr_last_decision_rate)\n      solver->agdr_dec_rate_decreased++;\n    else\n      solver->agdr_dec_rate_decreased = 0;\n\n    solver->agdr_last_decision_rate = current_decision_rate;\n\n    if (solver->agdr_dec_rate_decreased >= 10)\n      return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 444, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1768}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922233d278c819097d084a43f77735f", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "97eaaef5948b684baa16baf73f53f9bf", "body": {"id": "resp_0855946f30dc60eb00692222f7259081999146023049225d12", "object": "response", "created_at": 1763844855, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0855946f30dc60eb00692222f791448199bdb1bbc84063e1aa", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // AGDR minimum interval handling\n    uint64_t min_interval = 50;\n    if (solver->stable)\n        min_interval = 100;\n    if (CONFLICTS < solver->limits.restart.conflicts)\n        return false;\n    if (CONFLICTS - solver->statistics.last.restart < min_interval)\n        return false;\n\n    // Compute averages\n    const double fast = AVERAGE(fast_glue);\n    const double slow = AVERAGE(slow_glue);\n    if (slow == 0.0) // avoid division by zero\n        return false;\n    const double ratio = fast / slow;\n    const double threshold = 0.85;\n\n    // Decision rate tie-breaker (last 10 conflicts decreasing)\n    bool decision_rate_decreasing = false;\n    if (fabs(ratio - threshold) < 1e-7) {\n        // Only check if exactly at threshold\n        // Heuristic: check last 10 decision rates, require strictly decreasing\n        // We don't have a history buffer, but can approximate by checking if the average\n        // decision rate (current) is lower than a previously cached one.\n        // Kissat does not track a true history, so skip tie-breaker unless such buffer exists\n        decision_rate_decreasing = false; // cannot check, so do not trigger on tie\n    }\n\n    // Main AGDR policy\n    if (ratio < threshold && solver->level > 0)\n        return true;\n    if (fabs(ratio - threshold) < 1e-7 && decision_rate_decreasing)\n        return true;\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 384, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1708}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922233d2c0c8190b4a20eccc6874189", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "19fee6ba23ae2219492fab90e9ff475d", "body": {"id": "resp_009387b8913f6d0e00692222f724d0819bbe17e114453dacb7", "object": "response", "created_at": 1763844855, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_009387b8913f6d0e00692222f7acc4819b93f5caaaaedb4839", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Minimum interval logic\n  const uint64_t min_interval = solver->stable ? 100 : 50;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n  if (CONFLICTS - solver->statistics.last.restart < min_interval)\n    return false;\n\n  // AGDR: Adaptive Glue Drop Restart\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  if (slow <= 0.0) // avoid division by zero\n    return false;\n\n  const double ratio = fast / slow;\n  const double threshold = 0.85;\n\n  kissat_extremely_verbose (solver,\n    \"AGDR: fast_glue=%.2f, slow_glue=%.2f, ratio=%.3f, threshold=%.2f, min_interval=%\" PRIu64,\n    fast, slow, ratio, threshold, min_interval);\n\n  // Standard trigger: ratio below threshold\n  if (ratio < threshold)\n    return true;\n\n  // Tie-breaker: ratio exactly equals threshold\n  if (ratio == threshold) {\n    // Check if decision rate moving average has decreased over last 10 conflicts\n    // We need to access the per-conflict history, but only have current value.\n    // So as a fallback, only restart if decision rate is still decreasing.\n    // (Kissat doesn't keep history, so we can't implement exact check without changes.)\n\n    // As a safe approximation, never trigger at exact threshold unless moving average is strictly decreasing.\n    // We'll compare the current value to the previous value (if tracked).\n    // If not available, skip tie-breaker.\n\n    // We'll use the 'last_decision_rate' in solver for this (if it exists).\n#ifdef DECISION_RATE_HISTORY\n    if (solver->averages[solver->stable].decision_rate.value <\n        solver->averages[solver->stable].decision_rate.prev_value)\n      return true;\n#else\n    // No history, skip tie-breaker trigger\n    return false;\n#endif\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 488, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1812}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922233d1c9081908f8dc4ac7023fea1", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "4f4424783fed5f841e76f708658a48c1", "body": {"id": "resp_00e710cc692530fa00692222fe1a3c8198953f550b4a2d60a2", "object": "response", "created_at": 1763844862, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_00e710cc692530fa00692222ff61188198ad04f61cd8e75ff6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // AGDR: Adaptive Glue Drop Restart parameters\n    const double threshold = 0.85;\n    const unsigned min_interval = solver->stable ? 100 : 50;\n    static double prev_decision_rate = -1.0;\n    static unsigned decision_rate_decreased = 0;\n    static uint64_t last_restart_conflicts = 0;\n\n    // Minimum interval between restarts\n    if (solver->statistics.conflicts < last_restart_conflicts + min_interval)\n        return false;\n\n    const double fast = AVERAGE(fast_glue);\n    const double slow = AVERAGE(slow_glue);\n    if (slow <= 0.0) // Avoid division by zero or nonsense\n        return false;\n\n    const double ratio = fast / slow;\n\n    // Track if the decision rate has decreased (for tie-breaker)\n    const double curr_decision_rate = AVERAGE(decision_rate);\n    if (prev_decision_rate < 0.0)\n        prev_decision_rate = curr_decision_rate;\n    if (curr_decision_rate < prev_decision_rate)\n        decision_rate_decreased++;\n    else\n        decision_rate_decreased = 0;\n    prev_decision_rate = curr_decision_rate;\n\n    bool restart = false;\n\n    if (ratio < threshold && solver->level > 0) {\n        restart = true;\n    } else if (ratio == threshold && solver->level > 0) {\n        // Tie-breaker: only restart if decision rate has decreased for last 10 conflicts\n        if (decision_rate_decreased >= 10)\n            restart = true;\n    }\n\n    if (restart) {\n        kissat_extremely_verbose(solver,\n            \"AGDR restart: ratio %g (fast/slow glue), threshold %g, level %u, interval %u/%u, decision_rate %.6g\",\n            ratio, threshold, solver->level,\n            (unsigned)(solver->statistics.conflicts - last_restart_conflicts),\n            min_interval, curr_decision_rate);\n        last_restart_conflicts = solver->statistics.conflicts;\n        decision_rate_decreased = 0; // Reset after restart\n        return true;\n    }\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1324, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 505, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1829}, "user": null, "metadata": {}}}, "error": null}
