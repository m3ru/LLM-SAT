{"id": "batch_req_6921e60b1c3c8190bec1c69bb1021c6c", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "278589af22d142433cc7a9c32f203b60", "body": {"id": "resp_06b47458f1ab5d11006921e5d874388197a487ea6a893389bb", "object": "response", "created_at": 1763829208, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_06b47458f1ab5d11006921e5d8dd408197ad427881e0d3519e", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Enforce minimum conflict interval between restarts\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Maintain static variable for \"next allowed restart\" conflict\n  static uint64_t next_restart_at = 0;\n  const uint64_t conflicts = CONFLICTS;\n  const uint64_t restart_conflict_limit = solver->limits.restart.conflicts;\n\n  // If first time, initialize next_restart_at\n  if (next_restart_at == 0)\n    next_restart_at = conflicts + restart_conflict_limit;\n\n  // Don't restart if not yet at minimum interval\n  if (conflicts < next_restart_at)\n    return false;\n\n  // EWMA values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  // Defensive: avoid division by zero\n  const uint64_t total_conflicts = solver->statistics.conflicts;\n  const uint64_t total_decisions = solver->statistics.decisions;\n\n  if (!total_conflicts)\n    return false;\n\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n  const double global_decision_rate = (double) total_decisions / (double) total_conflicts;\n\n  // Trigger (a): glue-based\n  bool glue_trigger = (fast_glue >= 0.8 * slow_glue);\n  // Trigger (b): decision-rate based\n  bool decision_rate_trigger = (decision_rate_ewma <= 0.5 * global_decision_rate);\n\n  // Stable mode: require both triggers\n  bool trigger = false;\n  if (solver->stable) {\n    if (glue_trigger && decision_rate_trigger)\n      trigger = true;\n  } else {\n    if (glue_trigger)\n      trigger = true;\n    else if (decision_rate_trigger)\n      trigger = true;\n  }\n\n  // Tie-breaking: prioritize glue-trigger for log message\n  if (trigger) {\n    // Do not fire if at same conflict as previous restart, delay by one\n    static uint64_t last_restart = 0;\n    if (conflicts == last_restart)\n      return false;\n    next_restart_at = conflicts + restart_conflict_limit;\n    last_restart = conflicts;\n    kissat_extremely_verbose (\n      solver,\n      \"restart at conflict %\" PRIu64 \" (glue %.2f/%.2f trigger %d, decision rate %.2f/%.2f trigger %d) [stable: %d]\",\n      conflicts, fast_glue, slow_glue, glue_trigger, decision_rate_ewma, global_decision_rate, decision_rate_trigger, solver->stable);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 619, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1429}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e60b3e2c8190bc62790b11f12ba8", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "11e6fdecf74ead5d5cf57d10d341aaf2", "body": {"id": "resp_0a0544d3fc63a300006921e5ec15408195be9a94e7660fe8e8", "object": "response", "created_at": 1763829228, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0a0544d3fc63a300006921e5ec69ec81958ee898ccd98befb7", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Maintain a persistent next_restart_at value per solver (initialize if needed)\n  if (solver->limits.restart.next_restart_at < solver->statistics.conflicts)\n    solver->limits.restart.next_restart_at = solver->statistics.conflicts + solver->limits.restart.conflicts;\n\n  if (solver->statistics.conflicts < solver->limits.restart.next_restart_at)\n    return false;\n\n  // Prevent multiple restarts at the same conflict\n  static uint64_t last_restart_conflict = 0;\n  if (last_restart_conflict == solver->statistics.conflicts)\n    return false;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double glue_trigger = 0.8 * slow_glue;\n\n  // Compute decision rate EWMA and global average decision rate\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n  double global_decision_rate = 0.0;\n  if (solver->statistics.conflicts)\n    global_decision_rate = (double) solver->statistics.decisions / solver->statistics.conflicts;\n  const double decision_rate_trigger = 0.5 * global_decision_rate;\n\n  // Evaluate triggers\n  const bool glue_based = (fast_glue >= glue_trigger);\n  const bool decision_based = (decision_rate_ewma <= decision_rate_trigger);\n\n  bool do_restart = false;\n  if (solver->stable) {\n    // In stable phase, only restart if both triggers fire\n    do_restart = (glue_based && decision_based);\n  } else {\n    // In focused phase, restart if either fires (glue prioritized if both)\n    do_restart = glue_based || decision_based;\n  }\n\n  if (do_restart) {\n    solver->limits.restart.next_restart_at = solver->statistics.conflicts + solver->limits.restart.conflicts;\n    last_restart_conflict = solver->statistics.conflicts;\n    kissat_extremely_verbose (solver,\n      \"dual-threshold restart at conflict %\" PRIu64 \": fast_glue=%g, slow_glue=%g, dec_rate_ewma=%g, global_dec_rate=%g, glue-based=%d, decision-based=%d, stable=%d\",\n      solver->statistics.conflicts, fast_glue, slow_glue, decision_rate_ewma, global_decision_rate, glue_based, decision_based, solver->stable);\n    return true;\n  }\n\n  return false;\n}\n</code>\n"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 560, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1370}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e60b2c6481908c213260c52a9e85", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "277b09b153e3f2ccf5e1480b807e4ea3", "body": {"id": "resp_02cf256b2ee4498c006921e5dfbc2081908c3586c2ca3bd3e8", "object": "response", "created_at": 1763829215, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_02cf256b2ee4498c006921e5dff4648190b36b64b4589be36d", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Ensure we only restart every restart_conflict_limit conflicts\n  if (solver->statistics.conflicts < solver->limits.restart.conflicts)\n    return false;\n\n  // Track when next restart is allowed\n  if (solver->statistics.conflicts < solver->limits.restart.next)\n    return false;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double glue_threshold = 0.8 * slow_glue;\n\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n  double avg_decisions_per_conflict = 0.0;\n  if (solver->statistics.conflicts)\n    avg_decisions_per_conflict =\n      (double) solver->statistics.decisions / solver->statistics.conflicts;\n  const double decision_rate_threshold = 0.5 * avg_decisions_per_conflict;\n\n  bool glue_trigger = (fast_glue >= glue_threshold);\n  bool decision_trigger = (decision_rate_ewma <= decision_rate_threshold);\n\n  // If in stable phase, only restart if BOTH triggers fire\n  bool restart = false;\n  if (solver->stable) {\n    if (glue_trigger && decision_trigger)\n      restart = true;\n  } else {\n    if (glue_trigger)\n      restart = true;\n    else if (decision_trigger)\n      restart = true;\n  }\n\n  // If at same conflict as previous restart, delay by one conflict\n  if (restart && solver->statistics.conflicts == solver->limits.restart.last)\n    return false;\n\n  if (restart) {\n    solver->limits.restart.last = solver->statistics.conflicts;\n    solver->limits.restart.next =\n      solver->statistics.conflicts + solver->limits.restart.conflicts;\n    kissat_extremely_verbose (solver,\n      \"restarting at conflict %ld: \"\n      \"fast_glue %g %s 0.8*slow_glue %g, \"\n      \"decision_rate_ewma %g %s 0.5*avg_decisions/conflict %g%s\",\n      solver->statistics.conflicts,\n      fast_glue, glue_trigger ? \">=\" : \"<\", glue_threshold,\n      decision_rate_ewma, decision_trigger ? \"<=\" : \">\", decision_rate_threshold,\n      solver->stable ? \" (stable)\" : \"\"\n    );\n    return true;\n  }\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 547, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1357}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e60b2c2c8190a1aeb1eb2d6a4a43", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "44f35d2caebf583c5faa38185744b626", "body": {"id": "resp_0ff926888944c64a006921e5df96fc8194af8bae6b4c65e822", "object": "response", "created_at": 1763829215, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0ff926888944c64a006921e5dfe1d48194b6fa0b9e4b1802c7", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Use the limit of conflicts as the minimum interval between restarts\n  uint64_t conflicts = solver->statistics.conflicts;\n  uint64_t limit = solver->limits.restart.conflicts;\n\n  // Track the next restart conflict point (initialize if first call)\n  if (solver->restart.next < conflicts)\n    solver->restart.next = conflicts + limit;\n\n  // Enforce minimal interval between restarts\n  if (conflicts < solver->restart.next)\n    return false;\n\n  // Prevent restart at the same conflict as previous\n  if (conflicts == solver->restart.last)\n    return false;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double glue_threshold = 0.8 * slow_glue;\n\n  const double decision_rate_ewma = solver->averages[solver->stable].decision_rate.value;\n  double dec_per_conf = 0.0;\n  if (solver->statistics.conflicts)\n    dec_per_conf = (double) solver->statistics.decisions / solver->statistics.conflicts;\n  const double decision_rate_threshold = 0.5 * dec_per_conf;\n\n  bool glue_trigger = (fast_glue >= glue_threshold);\n  bool decision_trigger = (decision_rate_ewma <= decision_rate_threshold);\n\n  // In stable mode, only restart if both triggers fire\n  bool restart = false;\n  if (solver->stable) {\n    if (glue_trigger && decision_trigger)\n      restart = true;\n  } else {\n    if (glue_trigger)\n      restart = true;\n    else if (decision_trigger)\n      restart = true;\n  }\n\n  if (restart) {\n    solver->restart.last = conflicts;\n    solver->restart.next = conflicts + limit;\n  }\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 430, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1240}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e60b2d008190b6842e23b129df3e", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "45ed61c4fb7b4661ba149c793d10d5db", "body": {"id": "resp_0aa7a70bf6602262006921e5f2714c8197aac2efcb4ca75553", "object": "response", "created_at": 1763829234, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0aa7a70bf6602262006921e5f2cfe88197b5a39f7678bc33a9", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Maintain local static restart scheduling data.\n  static uint64_t next_restart_at = 0;\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t restart_limit = solver->limits.restart.conflicts;\n\n  // Only allow restart if at or past next_restart_at.\n  if (conflicts < next_restart_at)\n    return false;\n\n  // Compute glue averages.\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Compute glue threshold: 0.8 * slow_glue_ewma\n  const double glue_threshold = 0.8 * slow_glue;\n\n  // Compute decision rate average and long-run average.\n  const double decision_rate_ewma = solver->averages[solver->stable].decision_rate.value;\n  double longrun_decision_rate = 0.0;\n  if (solver->statistics.conflicts)\n    longrun_decision_rate = (double)solver->statistics.decisions / (double)solver->statistics.conflicts;\n  // Defensive: avoid div by zero\n  else\n    longrun_decision_rate = decision_rate_ewma;\n\n  // Compute decision rate threshold: 0.5 * longrun_decision_rate\n  const double decision_rate_threshold = 0.5 * longrun_decision_rate;\n\n  // Evaluate triggers\n  const bool glue_trigger = (fast_glue >= glue_threshold);\n  const bool decision_trigger = (decision_rate_ewma <= decision_rate_threshold);\n\n  // If at same conflict as previous restart, delay by one conflict.\n  static uint64_t last_restart_at = 0;\n  if (conflicts == last_restart_at)\n    return false;\n\n  bool fire = false;\n  if (solver->stable) {\n    // Only restart if BOTH triggers fire in stable phase\n    fire = glue_trigger && decision_trigger;\n  } else {\n    // If both, glue-based (a) prioritized (but both fire anyway)\n    fire = glue_trigger || decision_trigger;\n  }\n\n  if (fire) {\n    last_restart_at = conflicts;\n    next_restart_at = conflicts + restart_limit;\n    kissat_extremely_verbose(\n      solver,\n      \"dual-threshold restart at conflict %\" PRIu64\n      \": fast_glue=%g slow_glue=%g glue_thr=%g glue_trig=%d \"\n      \"decision_rate_ewma=%g longrun_rate=%g dec_thr=%g dec_trig=%d \"\n      \"(next at %\" PRIu64 \")\",\n      conflicts, fast_glue, slow_glue, glue_threshold, glue_trigger,\n      decision_rate_ewma, longrun_decision_rate, decision_rate_threshold, decision_trigger,\n      next_restart_at);\n    return true;\n  }\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 634, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1444}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e60b313c8190ae7be62f6aec55dc", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "7f3dd4a6790e2925b5ee8a34157642ed", "body": {"id": "resp_08a48a8c9f4de057006921e5e61ed48194bc7e3b1445230d04", "object": "response", "created_at": 1763829222, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08a48a8c9f4de057006921e5e6add48194849feb3365f0a893", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // The minimal gap between restarts, enforced by the conflict limit.\n  uint64_t conflicts = solver->statistics.conflicts;\n  uint64_t min_conflicts = solver->limits.restart.conflicts;\n\n  // Track next_restart_at as a persistent field (initialize if unset)\n  if (!solver->limits.restart.next_restart_at)\n    solver->limits.restart.next_restart_at = conflicts + min_conflicts;\n\n  // Delay if at same conflict as previous restart\n  if (conflicts == solver->limits.restart.last_restart_at)\n    return false;\n\n  if (conflicts < solver->limits.restart.next_restart_at)\n    return false;\n\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double glue_threshold = 0.8 * slow_glue;\n\n  const double decision_rate_ma = AVERAGE(decision_rate);\n  double avg_decisions_per_conflict = 0.0;\n  if (solver->statistics.conflicts)\n    avg_decisions_per_conflict = (double)solver->statistics.decisions /\n                                 (double)solver->statistics.conflicts;\n  const double decision_threshold = 0.5 * avg_decisions_per_conflict;\n\n  bool glue_trigger = (fast_glue >= glue_threshold);\n  bool decision_trigger = (decision_rate_ma <= decision_threshold);\n\n  bool triggered = false;\n\n  if (solver->stable) {\n    // In stable, require both triggers\n    triggered = (glue_trigger && decision_trigger);\n  } else {\n    // In focused, either trigger is sufficient, glue preferred\n    triggered = glue_trigger || decision_trigger;\n  }\n\n  if (!triggered)\n    return false;\n\n  // Tie-breaking: glue trigger has priority for verbosity\n  if (glue_trigger)\n    kissat_extremely_verbose (solver,\n      \"restarting: fast_glue %.2f >= 0.8 * slow_glue %.2f (%.2f)\",\n      fast_glue, slow_glue, glue_threshold);\n  else if (decision_trigger)\n    kissat_extremely_verbose (solver,\n      \"restarting: decision_rate %.2f <= 0.5 * avg_dec/conf %.2f (%.2f)\",\n      decision_rate_ma, avg_decisions_per_conflict, decision_threshold);\n\n  // Record last and next allowed restart points\n  solver->limits.restart.last_restart_at = conflicts;\n  solver->limits.restart.next_restart_at = conflicts + min_conflicts;\n\n  return true;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 572, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1382}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e60c650081909ed9f205fcbc3c6c", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "f4ae9effaab6de63a602450ef6c2b114", "body": {"id": "resp_0ad2614072a33350006921e5f9e11481959112c7a3badd6694", "object": "response", "created_at": 1763829241, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0ad2614072a33350006921e5fa15a481958cc1fde7d1f0467d", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Ensure we only restart if enough conflicts have passed since last restart\n    static uint64_t next_restart_at = 0;\n    uint64_t conflicts = solver->statistics.conflicts;\n    uint64_t restart_limit = solver->limits.restart.conflicts;\n\n    // If this is the first call, initialize next_restart_at\n    if (next_restart_at == 0)\n        next_restart_at = conflicts + restart_limit;\n\n    // Tie-breaking: avoid restarting at the same conflict as previous\n    if (conflicts < next_restart_at)\n        return false;\n    if (conflicts == next_restart_at && conflicts > 0)\n        return false;\n\n    const double fast_glue = AVERAGE(fast_glue);\n    const double slow_glue = AVERAGE(slow_glue);\n    const double glue_trigger = 0.8 * slow_glue;\n    bool glue_based = (fast_glue >= glue_trigger);\n\n    // Compute decision rate\n    double avg_decision_rate = AVERAGE(decision_rate);\n    double global_decision_rate = (solver->statistics.conflicts > 0) ?\n        ((double)solver->statistics.decisions / (double)solver->statistics.conflicts) : 0.0;\n    bool decision_based = (avg_decision_rate <= 0.5 * global_decision_rate);\n\n    // Logging for debugging\n    kissat_extremely_verbose(solver,\n        \"dual-threshold restart: next_at=%\" PRIu64 \" conflicts=%\" PRIu64\n        \" glue=%.2f/%.2f glue_trigger=%.2f [%d] dec_rate=%.2f global=%.2f dec_trigger=%.2f [%d] stable=%d\",\n        next_restart_at, conflicts, fast_glue, slow_glue, glue_trigger, glue_based,\n        avg_decision_rate, global_decision_rate, 0.5 * global_decision_rate, decision_based, solver->stable);\n\n    bool restart = false;\n\n    if (solver->stable) {\n        // In stable: require both triggers for restart\n        restart = glue_based && decision_based;\n    } else {\n        // In focused: either trigger fires, but glue-based has priority\n        if (glue_based)\n            restart = true;\n        else if (decision_based)\n            restart = true;\n    }\n\n    // If restarting, set next_restart_at to enforce minimum gap\n    if (restart) {\n        next_restart_at = conflicts + restart_limit;\n    }\n\n    return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 571, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1381}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e60b29f081908bbed63a90487b0c", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "bf69450946673fe0bbbaf57ebf7024b1", "body": {"id": "resp_07af26b3852ee781006921e5e5cca8819396914ecf99263a63", "object": "response", "created_at": 1763829221, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_07af26b3852ee781006921e5e646888193b3674d5969c3348c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  // Use Kissat's standard conflict limit\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n  // Maintain next_restart_at (initialize if unset)\n  if (!solver->limits.restart.next_restart_at)\n    solver->limits.restart.next_restart_at = conflicts + conflict_limit;\n\n  // If not yet at next restart point, do not restart\n  if (conflicts < solver->limits.restart.next_restart_at)\n    return false;\n\n  // Compute statistics\n  const double fast_glue = solver->averages[solver->stable].fast_glue.value;\n  const double slow_glue = solver->averages[solver->stable].slow_glue.value;\n  const double glue_threshold = 0.8 * slow_glue;\n\n  const double decision_rate_ewma = solver->averages[solver->stable].decision_rate.value;\n  double observed_decision_rate = 0.0;\n  if (solver->statistics.conflicts)\n    observed_decision_rate = (double) solver->statistics.decisions / solver->statistics.conflicts;\n  const double decision_rate_threshold = 0.5 * observed_decision_rate;\n\n  const bool glue_trigger = (fast_glue >= glue_threshold);\n  const bool rate_trigger = (decision_rate_ewma <= decision_rate_threshold);\n\n  bool restart = false;\n\n  if (solver->stable) {\n    // Stable: require both triggers\n    if (glue_trigger && rate_trigger)\n      restart = true;\n  } else {\n    // Focused: either trigger is sufficient, glue prioritized\n    if (glue_trigger)\n      restart = true;\n    else if (rate_trigger)\n      restart = true;\n  }\n\n  // If both triggers fire, glue takes priority (for logging)\n  kissat_extremely_verbose (solver,\n    \"dual-threshold restart check at conflict %\" PRIu64 \": \"\n    \"fast_glue %g %s 0.8*slow_glue (%g), \"\n    \"decision_rate_ewma %g %s 0.5*observed (%g), \"\n    \"stable %d, restart %d\",\n    conflicts,\n    fast_glue, glue_trigger ? \">=\" : \"<\", glue_threshold,\n    decision_rate_ewma, rate_trigger ? \"<=\" : \">\", decision_rate_threshold,\n    solver->stable, restart);\n\n  // Delay restart if at same conflict as previous restart (do not double-restart)\n  static uint64_t prev_restart_conflict = 0;\n  if (restart) {\n    if (conflicts == prev_restart_conflict) {\n      // Delay by one conflict\n      solver->limits.restart.next_restart_at = conflicts + 1;\n      restart = false;\n    } else {\n      prev_restart_conflict = conflicts;\n      solver->limits.restart.next_restart_at = conflicts + conflict_limit;\n    }\n  }\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 656, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1466}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e60b2be48190993c3505a9363d3d", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "c49816dcbbeaa4eb1f59d75d1f783360", "body": {"id": "resp_01844320f143c628006921e5ed39b88193ad592d3396e02b5f", "object": "response", "created_at": 1763829229, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_01844320f143c628006921e5edbc8081938fa602d155a51cb4", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Ensure we have a next_restart_at value (initialize if needed)\n  if (solver->limits.restart.next_restart_at < solver->statistics.conflicts)\n    solver->limits.restart.next_restart_at =\n      solver->statistics.conflicts + solver->limits.restart.conflicts;\n\n  // Only permit restart checks at/after next_restart_at\n  if (solver->statistics.conflicts < solver->limits.restart.next_restart_at)\n    return false;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double glue_threshold = 0.8 * slow_glue;\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n\n  double global_decision_rate = 0.0;\n  if (solver->statistics.conflicts > 0)\n    global_decision_rate =\n      (double) solver->statistics.decisions /\n      (double) solver->statistics.conflicts;\n  const double decision_threshold = 0.5 * global_decision_rate;\n\n  const bool glue_trigger = fast_glue >= glue_threshold;\n  const bool decision_trigger = decision_rate_ewma <= decision_threshold;\n\n  // Tie-break: glue_trigger prioritized\n  bool trigger = false;\n  if (solver->stable) {\n    // In stable, require both\n    trigger = glue_trigger && decision_trigger;\n  } else {\n    trigger = glue_trigger || decision_trigger;\n  }\n\n  // Prevent multiple restarts at the same conflict\n  static uint64_t last_restart_conflict = 0;\n  if (trigger) {\n    if (solver->statistics.conflicts == last_restart_conflict) {\n      // Delay by one conflict\n      return false;\n    }\n    // Schedule next possible restart\n    solver->limits.restart.next_restart_at =\n      solver->statistics.conflicts + solver->limits.restart.conflicts;\n    last_restart_conflict = solver->statistics.conflicts;\n    kissat_extremely_verbose (\n        solver,\n        \"dual-threshold adaptive restart at %\" PRIu64\n        \" (fast_glue %.2f >= %.2f, decision_rate %.2f <= %.2f) [stable=%d]\",\n        solver->statistics.conflicts, fast_glue, glue_threshold,\n        decision_rate_ewma, decision_threshold, solver->stable);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 540, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1350}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e60b297881909d86f76e8a145f8a", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "8f082dd67113f97441e3699b88dbac3a", "body": {"id": "resp_08287fd05f360925006921e601f9888194a6e799b9be61839b", "object": "response", "created_at": 1763829250, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08287fd05f360925006921e602b3bc8194bec978b4249a5650", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict minimum interval checking\n  if (solver->statistics.conflicts < solver->limits.restart.conflicts)\n    return false;\n\n  // Maintain the next restart conflict threshold\n  if (solver->statistics.conflicts < solver->limits.restart.next)\n    return false;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n  const double global_dec_per_conf =\n      solver->statistics.conflicts ?\n      ((double) solver->statistics.decisions) / solver->statistics.conflicts : 0.0;\n\n  // Trigger (a): glue-based\n  const bool glue_trigger = (fast_glue >= 0.8 * slow_glue);\n\n  // Trigger (b): decision-rate based\n  const bool decision_trigger =\n      (global_dec_per_conf > 0.0 && decision_rate <= 0.5 * global_dec_per_conf);\n\n  bool restart = false;\n  if (solver->stable) {\n    // Stable: both triggers must fire\n    if (glue_trigger && decision_trigger)\n      restart = true;\n  } else {\n    // Prioritize glue trigger if both, else either\n    if (glue_trigger)\n      restart = true;\n    else if (decision_trigger)\n      restart = true;\n  }\n\n  // Tie-breaking: If at same conflict as previous restart, delay by one conflict\n  if (restart) {\n    if (solver->limits.restart.last == solver->statistics.conflicts) {\n      // Delay by one conflict, do not restart\n      restart = false;\n    } else {\n      // Set next restart conflict, and record this restart\n      solver->limits.restart.next =\n        solver->statistics.conflicts + solver->limits.restart.conflicts;\n      solver->limits.restart.last = solver->statistics.conflicts;\n    }\n  }\n\n  kissat_extremely_verbose (\n      solver,\n      \"dual-threshold adaptive restarting: \"\n      \"fast_glue=%.2f slow_glue=%.2f [%.2f/%.2f=%.2f] \"\n      \"decision_rate=%.2f trigger[a]=%d trigger[b]=%d restart=%d\",\n      fast_glue, slow_glue, (double)solver->statistics.decisions,\n      (double)solver->statistics.conflicts, global_dec_per_conf, decision_rate,\n      glue_trigger, decision_trigger, restart);\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 810, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 566, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1376}, "user": null, "metadata": {}}}, "error": null}
