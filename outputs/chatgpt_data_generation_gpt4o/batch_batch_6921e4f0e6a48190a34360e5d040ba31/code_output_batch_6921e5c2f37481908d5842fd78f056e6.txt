{"id": "batch_req_6921e5f464548190b0c849568b377ad4", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "1fea52e300cb89bdba2467536583bf43", "body": {"id": "resp_091a92e4d6f64964006921e5c6c3a08193a26c3b243780178d", "object": "response", "created_at": 1763829190, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_091a92e4d6f64964006921e5c730a481938d92424949cbe815", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Get glue averages for the current stage (stable/unstable)\n  const int mode = solver->stable;\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // Compute GLUE_DELTA\n  const double glue_delta = fast_glue - slow_glue;\n\n  // Adaptive threshold T\n  double threshold = 0.5 * slow_glue;\n  if (!solver->stable) // unstable stage: more aggressive\n    threshold = 0.25 * slow_glue;\n\n  // Decision rate moving average\n  const double curr_decision_rate = solver->averages[mode].decision_rate.value;\n\n  // Use static variable to store previous decision rate per mode\n  static double prev_decision_rate[2] = {0.0, 0.0};\n\n  // Safeguard: decision rate not improving\n  bool decision_rate_ok = (curr_decision_rate < 1.05 * prev_decision_rate[mode]);\n\n  // Update prev_decision_rate for next invocation\n  prev_decision_rate[mode] = curr_decision_rate;\n\n  // Logging for debug/experimentation (optional)\n  kissat_extremely_verbose (\n    solver,\n    \"restarting? glue_delta=%.2f threshold=%.2f, curr_decision_rate=%.2f prev_decision_rate=%.2f, level=%u, conflicts=%\" PRIu64 \" (limit=%\" PRIu64 \")\",\n    glue_delta, threshold, curr_decision_rate, prev_decision_rate[mode], solver->level, CONFLICTS, solver->limits.restart.conflicts);\n\n  // Main restart trigger:\n  if (glue_delta > threshold && decision_rate_ok)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 445, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1829}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e5f48b2081908348e2097270cd5f", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "a6cabf2215da5bf31d6e52e88294727f", "body": {"id": "resp_02a33b21f1564b4c006921e5cb7fb481909c120347cbdd7a66", "object": "response", "created_at": 1763829195, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_02a33b21f1564b4c006921e5cc08ac8190935d62bc0415cee8", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver)\n{\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Only restart if enough conflicts since last restart\n    if (CONFLICTS < solver->limits.restart.conflicts)\n        return false;\n\n    // Get average values\n    const double fast = AVERAGE(fast_glue);\n    const double slow = AVERAGE(slow_glue);\n\n    // Compute glue delta\n    const double glue_delta = fast - slow;\n\n    // Adaptive threshold T\n    double threshold = 0.5 * slow;\n    if (!solver->stable)\n        threshold = 0.25 * slow;\n\n    // Decision rate\n    const double curr_decision_rate = AVERAGE(decision_rate);\n\n    // We need to keep a previous decision rate for comparison.\n    // Use static variable, as restarting is called only after conflict.\n    static double prev_decision_rate = 0.0;\n\n    // Tie-breaker: check if decision rate is not improving\n    bool decision_rate_stalled = (curr_decision_rate < 1.05 * prev_decision_rate);\n\n    // Save current for next call\n    prev_decision_rate = curr_decision_rate;\n\n    // Only restart if both GLUE_DELTA and decision-rate conditions are satisfied\n    if (glue_delta > threshold && decision_rate_stalled)\n    {\n        kissat_extremely_verbose(solver,\n            \"adaptive glue-delta restart: fast=%.2f slow=%.2f glue_delta=%.2f threshold=%.2f curr_dec_rate=%.2f prev_dec_rate=%.2f\",\n            fast, slow, glue_delta, threshold, curr_decision_rate, prev_decision_rate);\n\n        return true;\n    }\n\n    // In stable mode, fallback to reluctant scheme (as in reference)\n    if (solver->stable)\n        return kissat_reluctant_triggered(&solver->reluctant);\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 431, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1815}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e5f471808190b5caf0b3510f9871", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "19b974ab5cef1fb913259269807bc30d", "body": {"id": "resp_0de59dd50b1b2966006921e5cf43208194ab1df23ba9314a53", "object": "response", "created_at": 1763829199, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0de59dd50b1b2966006921e5cfbb2c81948327bdff7c5a0599", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Retrieve averages for current stage (stable/unstable)\n  const int mode = solver->stable;\n  const double fast_glue = solver->averages[mode].fast_glue.value;\n  const double slow_glue = solver->averages[mode].slow_glue.value;\n\n  // Compute adaptive threshold T\n  double threshold = 0.5 * slow_glue;\n  if (!solver->stable)\n    threshold = 0.25 * slow_glue;\n\n  // Compute GLUE_DELTA\n  const double glue_delta = fast_glue - slow_glue;\n\n  // Retrieve decision rate moving average\n  const double curr_dec_rate = solver->averages[mode].decision_rate.value;\n\n  // Get previous decision rate (assume it's tracked; fallback: use current if not)\n  // In Kissat, the moving average struct does not store previous. We can approximate using last value.\n  // We'll use the last value stored in the average struct as previous (see moving_average struct in Kissat).\n  // If not available, fall back to current.\n  const double prev_dec_rate = solver->averages[mode].decision_rate.last;\n\n  // Only allow restart if decision rate is not improving\n  const bool dec_rate_not_improving = (curr_dec_rate < 1.05 * prev_dec_rate);\n\n  // Aggressive verbose output for debugging\n  kissat_extremely_verbose (solver,\n    \"restart check: glue_delta=%.2f threshold=%.2f dec_rate=%.2f prev_dec_rate=%.2f (not improving=%d)\",\n    glue_delta, threshold, curr_dec_rate, prev_dec_rate, dec_rate_not_improving);\n\n  // Must satisfy both: (a) glue_delta > threshold, (b) decision rate not improving\n  if (glue_delta > threshold && dec_rate_not_improving)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 465, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1849}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e5f46e848190ad2bb84c0a8bc60d", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "609b55c9351e8a97e99fd7d9d4eb71a2", "body": {"id": "resp_09ec2b33a8aec777006921e5d3970881959362445c8f0890d1", "object": "response", "created_at": 1763829203, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_09ec2b33a8aec777006921e5d43b588195be9275146033b0ce", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Gather glue averages\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Compute GLUE_DELTA\n  const double glue_delta = fast_glue - slow_glue;\n\n  // Adaptive threshold T\n  double threshold = 0.5 * slow_glue;\n  if (!solver->stable)\n    threshold = 0.25 * slow_glue;\n\n  // Decision rate moving average (current and previous)\n  const double curr_decision_rate = AVERAGE(decision_rate);\n  // To get the previous decision rate, maintain a static or persistent value\n  // We use solver->previous_decision_rate, and update it only if a restart is not triggered.\n  // If not defined, initialize to current.\n  // This is safe since the function is always called within the solver context.\n\n  if (!solver->previous_decision_rate_initialized) {\n    solver->previous_decision_rate = curr_decision_rate;\n    solver->previous_decision_rate_initialized = true;\n  }\n\n  const double prev_decision_rate = solver->previous_decision_rate;\n\n  // Decision rate safeguard: only allow restart if current decision rate < 1.05 * prev_decision_rate\n  const double decision_rate_limit = 1.05 * prev_decision_rate;\n  const bool decision_rate_ok = curr_decision_rate < decision_rate_limit;\n\n  // Restart condition: both glue_delta and decision rate condition\n  const bool glue_delta_triggered = (glue_delta > threshold);\n\n  kissat_extremely_verbose(\n      solver,\n      \"restart glue_delta %.2f > threshold %.2f (slow_glue %.2f, fast_glue %.2f), \"\n      \"decision_rate %.2f < limit %.2f (prev %.2f)\",\n      glue_delta, threshold, slow_glue, fast_glue,\n      curr_decision_rate, decision_rate_limit, prev_decision_rate);\n\n  // If both triggers are satisfied, restart.\n  if (glue_delta_triggered && decision_rate_ok) {\n    // Update previous_decision_rate for next restart window\n    solver->previous_decision_rate = curr_decision_rate;\n    return true;\n  }\n\n  // Otherwise, update previous_decision_rate if not restarting (to track moving average)\n  solver->previous_decision_rate = curr_decision_rate;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 568, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1952}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e5f4934c8190a5f314a2a92ae7dd", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "6cb90516e371f537a75758c249e83487", "body": {"id": "resp_0cf86b308bacd7ae006921e5d83e6c8196b3cd182a5e9fee0e", "object": "response", "created_at": 1763829208, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0cf86b308bacd7ae006921e5d87c9c81968092493ccb868024", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n\n  // Do not restart at root level.\n  if (!solver->level)\n    return false;\n\n  // Only consider restarting if conflict limit reached.\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // In stable phase, fallback to original reluctant scheme.\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // --- Adaptive Glue-Delta with Decision-Rate Safeguard ---\n\n  // 1. Get fast and slow glue averages.\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // 2. Compute glue delta.\n  const double glue_delta = fast_glue - slow_glue;\n\n  // 3. Adaptive threshold T.\n  double threshold = 0.5 * slow_glue;\n  if (!solver->stable)\n    threshold = 0.25 * slow_glue; // More aggressive in unstable phase.\n\n  // 4. Decision rate moving average (current and previous).\n  const double curr_decision_rate = AVERAGE (decision_rate);\n\n  // Use solver->previous_decision_rate if available, otherwise initialize.\n  // The previous_decision_rate must be maintained elsewhere in the solver.\n  // For safety, fall back to current if previous is unavailable.\n  double prev_decision_rate = solver->previous_decision_rate;\n  if (prev_decision_rate <= 0.0)\n    prev_decision_rate = curr_decision_rate;\n\n  // 5. Tie-breaker: only allow restart if decision rate not improving.\n  const double decision_rate_limit = 1.05 * prev_decision_rate;\n  const bool decision_rate_not_improving = (curr_decision_rate < decision_rate_limit);\n\n  // 6. Both glue delta and decision rate must trigger.\n  const bool glue_condition = (glue_delta > threshold);\n\n  kissat_extremely_verbose (\n    solver,\n    \"adaptive-restart: fast_glue=%g slow_glue=%g glue_delta=%g threshold=%g glue_cond=%d curr_decision_rate=%g prev_decision_rate=%g drate_cond=%d\",\n    fast_glue, slow_glue, glue_delta, threshold, glue_condition,\n    curr_decision_rate, prev_decision_rate, decision_rate_not_improving\n  );\n\n  return glue_condition && decision_rate_not_improving;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 549, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1933}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e5f470988190a2d665c4a2cc8fab", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "554d577dd451ead2f323999352045ca0", "body": {"id": "resp_068c70cbba0efcd0006921e5df4d508190924e5709f3f26bd7", "object": "response", "created_at": 1763829215, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_068c70cbba0efcd0006921e5df811c81908f31970e9d4f7ccc", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Only restart if the number of conflicts since last restart >= limit\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  const bool stable = solver->stable;\n  const double fast = AVERAGE(fast_glue);\n  const double slow = AVERAGE(slow_glue);\n\n  // Adaptive threshold T\n  double threshold = 0.5 * slow;\n  if (!stable)\n    threshold = 0.25 * slow;\n\n  // Compute GLUE_DELTA\n  const double glue_delta = fast - slow;\n\n  // Decision rate safeguard: compare current and previous\n  const double current_decision_rate = AVERAGE(decision_rate);\n\n  // In Kissat, the moving averages update in-place, so we extract previous by\n  // using the saved previous value in the average struct (if available)\n  // Fallback: Use current if previous is not available\n  double previous_decision_rate = current_decision_rate;\n  if (solver->averages[solver->stable].decision_rate.count > 1)\n    previous_decision_rate = solver->averages[solver->stable].decision_rate.previous;\n\n  // Only allow restart if decision rate is not improving\n  const bool decision_rate_not_improving = current_decision_rate < 1.05 * previous_decision_rate;\n\n  // Compose the conditions:\n  // - Glue delta above (adaptive) threshold\n  // - Decision rate not improving\n  // - All basic preconditions already checked above (level, conflicts, etc)\n  bool triggered = (glue_delta > threshold) && decision_rate_not_improving;\n\n  kissat_extremely_verbose(\n    solver,\n    \"restarting? glue delta %g (fast %g - slow %g) threshold %g | \"\n    \"decision rate cur %g prev %g | triggered: %s\",\n    glue_delta, fast, slow, threshold,\n    current_decision_rate, previous_decision_rate,\n    triggered ? \"yes\" : \"no\"\n  );\n\n  return triggered;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 475, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1859}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e5f47480819081b2a6b7227ac7c5", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "59ead87b4f4d6628eebc0e3807095f2e", "body": {"id": "resp_098b698f0a1e8cb0006921e5e3a1148195af5437fca1b9cda6", "object": "response", "created_at": 1763829219, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_098b698f0a1e8cb0006921e5e450e48195b34b4db99cd045de", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Get fast/slow glue averages for this stage\n  const int mode = solver->stable;\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // Compute GLUE_DELTA\n  const double glue_delta = fast_glue - slow_glue;\n\n  // Adaptive threshold T\n  double threshold = 0.5 * slow_glue;\n  if (!solver->stable)\n    threshold = 0.25 * slow_glue;\n\n  // Decision rate moving average\n  const double curr_decision_rate = solver->averages[mode].decision_rate.value;\n\n  // Retrieve previous decision rate (must store somewhere)\n  // Use a static per-solver variable to track previous value.\n  // We update it *after* restart attempt below.\n  double prev_decision_rate = solver->previous_decision_rate;\n  if (isnan (prev_decision_rate)) // initialize on first call\n    prev_decision_rate = curr_decision_rate;\n\n  // Only consider restart if both GLUE_DELTA and decision rate conditions are met\n  bool glue_condition = (glue_delta > threshold);\n  bool decision_rate_condition = (curr_decision_rate < 1.05 * prev_decision_rate);\n\n  // Record for verbose/debug\n  kissat_extremely_verbose (\n    solver,\n    \"glue_delta = %.2f, threshold = %.2f (%s), decision_rate = %.2f, prev_decision_rate = %.2f (%s)\",\n    glue_delta, threshold, glue_condition ? \"trigger\" : \"hold\",\n    curr_decision_rate, prev_decision_rate, decision_rate_condition ? \"trigger\" : \"hold\"\n  );\n\n  // Update previous_decision_rate for next invocation\n  solver->previous_decision_rate = curr_decision_rate;\n\n  // Only restart if both conditions met\n  return glue_condition && decision_rate_condition;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 472, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1856}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e5f46c4c8190ad5770a96d41d191", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "1276c1bd6f3003b74fa32223e90c2f0e", "body": {"id": "resp_016b1f7c95376372006921e5e7e66c8196a7e34438e57470f4", "object": "response", "created_at": 1763829223, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_016b1f7c95376372006921e5e82a94819684833c1f090d9029", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  double threshold = 0.5 * slow_glue;\n  if (!solver->stable)\n    threshold = 0.25 * slow_glue;\n\n  const double glue_delta = fast_glue - slow_glue;\n\n  // Keep previous decision rate for comparison\n  static double previous_decision_rate = 0.0;\n  const double current_decision_rate = AVERAGE(decision_rate);\n\n  // Only allow restart if decision rate is not improving\n  bool decision_rate_not_improving = \n    current_decision_rate < 1.05 * previous_decision_rate;\n\n  // Update previous decision rate AFTER check to preserve semantics\n  bool should_restart = false;\n  if (glue_delta > threshold && decision_rate_not_improving)\n    should_restart = true;\n\n  // Always update previous_decision_rate for the next call\n  previous_decision_rate = current_decision_rate;\n\n  kissat_extremely_verbose(\n    solver,\n    \"restarting? glue_delta %.2f (%.2f - %.2f), threshold %.2f, \"\n    \"decision_rate %.2f vs prev %.2f, restart=%d\",\n    glue_delta, fast_glue, slow_glue, threshold,\n    current_decision_rate, previous_decision_rate, should_restart);\n\n  return should_restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 370, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1754}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e5f4f7108190b4742c55060ce35d", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "bf9d8fe022da5b8abb2b476d5f846dbb", "body": {"id": "resp_0a837e196d3885bc006921e5eccea481979fa7de54816cfac1", "object": "response", "created_at": 1763829228, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0a837e196d3885bc006921e5ed0ae081978fe59e716ea11e1c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Conflict limit check\n    if (CONFLICTS < solver->limits.restart.conflicts)\n        return false;\n\n    const double fast_glue = AVERAGE(fast_glue);\n    const double slow_glue = AVERAGE(slow_glue);\n    const double glue_delta = fast_glue - slow_glue;\n\n    // Adaptive threshold T\n    double threshold = 0.5 * slow_glue;\n    if (!solver->stable)\n        threshold = 0.25 * slow_glue;\n\n    // Decision rate safeguard\n    const double curr_decision_rate = AVERAGE(decision_rate);\n\n    // Use a static to remember previous decision rate for comparison\n    static double prev_decision_rate = 0.0;\n\n    // On first call, initialize previous decision rate\n    if (prev_decision_rate == 0.0)\n        prev_decision_rate = curr_decision_rate;\n\n    // Decision-rate improvement check\n    bool decision_rate_ok =\n        curr_decision_rate < 1.05 * prev_decision_rate;\n\n    // Glue-delta trigger\n    bool glue_delta_trigger = glue_delta > threshold;\n\n    // Compose conditions\n    bool trigger = glue_delta_trigger && decision_rate_ok;\n\n    kissat_extremely_verbose(solver,\n        \"restarting: glue_delta %g (threshold %g) %s, \"\n        \"decision_rate %.3f (prev %.3f) %s\",\n        glue_delta, threshold, (glue_delta_trigger ? \"TRIGGER\" : \"no\"),\n        curr_decision_rate, prev_decision_rate, (decision_rate_ok ? \"TRIGGER\" : \"no\"));\n\n    // Update previous decision rate for next call\n    prev_decision_rate = curr_decision_rate;\n\n    return trigger;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 414, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1798}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e5f46afc8190a7b27b536190a784", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "e07aa02546eb0d250b988f2784a464d4", "body": {"id": "resp_00d5ea706f4136dc006921e5f097588193b81234fffba60056", "object": "response", "created_at": 1763829232, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_00d5ea706f4136dc006921e5f0d3f08193bafe3a568f5cfada", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Compute glue averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double glue_delta = fast_glue - slow_glue;\n\n  // Adaptive threshold T\n  double threshold = 0.5 * slow_glue;\n  if (!solver->stable)\n    threshold = 0.25 * slow_glue;\n\n  // Decision rate\n  const double curr_decision_rate = solver->averages[solver->stable].decision_rate.value;\n  const double prev_decision_rate = kissat_prev_decision_rate (solver, solver->stable);\n\n  // Decision rate condition: not improving if curr < 1.05 * prev\n  bool decision_rate_condition = true;\n  if (prev_decision_rate > 0)\n    decision_rate_condition = (curr_decision_rate < 1.05 * prev_decision_rate);\n\n  kissat_extremely_verbose (solver,\n    \"restarting: glue_delta=%g threshold=%g (fast=%g slow=%g) curr_decision_rate=%g prev_decision_rate=%g drate_cond=%d\",\n    glue_delta, threshold, fast_glue, slow_glue, curr_decision_rate, prev_decision_rate, decision_rate_condition);\n\n  // Both conditions must be satisfied\n  if (glue_delta > threshold && decision_rate_condition)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1384, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 366, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1750}, "user": null, "metadata": {}}}, "error": null}
