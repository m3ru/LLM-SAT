{"id": "batch_req_6921e6200a748190ad5e765caa4709a7", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "fc82556015d332ef1b1b3cc0fac3ee2e", "body": {"id": "resp_0fac7953b420add4006921e5c0bc8c819391e1ed437d4f1ad8", "object": "response", "created_at": 1763829184, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0fac7953b420add4006921e5c103908193843ab242ce993af2", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Access conflict and limit\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Gather averages\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // Access or initialise median decision rate\n  // We store it in solver->median_decision_rate_ewma, which must be managed elsewhere (e.g., on phase transitions)\n  double median_decision_rate = solver->median_decision_rate_ewma;\n\n  // 1. Glue-based trigger\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // 2. Decision-rate-based trigger (if median available)\n  bool decision_rate_trigger = false;\n  if (median_decision_rate > 0.0) {\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n  }\n\n  // 3. Conflict-based trigger (already passed above, so always true here)\n  bool conflict_trigger = true;\n\n  // Tie-breaking: prefer glue-based, then decision-rate, then conflict-based\n  if (glue_trigger) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR: restarting by glue (fast %g > slow %g + 0.5)\",\n      fast_glue, slow_glue);\n    return true;\n  }\n\n  if (decision_rate_trigger) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR: restarting by decision rate (dec_rate %g < 0.8 * median %g)\",\n      decision_rate, median_decision_rate);\n    return true;\n  }\n\n  // Fallback: glue median not available, use glue-based only\n  if (median_decision_rate == 0.0) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR: median decision rate not available, fallback to glue only (fast %g, slow %g)\",\n      fast_glue, slow_glue);\n    return false;\n  }\n\n  if (conflict_trigger) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR: restarting by conflict limit (conflicts %lu >= limit %lu)\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 558, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1374}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e6201504819084aafe86a16041ae", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "e554bfae006da3f0da90888d8f8a53fa", "body": {"id": "resp_0028b1e78397b9ec006921e5c6fdc88197a08049bb552af31c", "object": "response", "created_at": 1763829191, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0028b1e78397b9ec006921e5c7811481978dee6c3649265901", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // DAGR-HR: Glue-based trigger\n  const bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // DAGR-HR: Decision rate trigger\n  double median_decision_rate = solver->median_decision_rate_ewma;\n  bool have_median = (median_decision_rate > 0.0);\n  bool decision_rate_trigger = false;\n  if (have_median)\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // DAGR-HR: Conflict limit trigger\n  const bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Tie-breaking and prioritization\n  // If median unavailable, rely on glue-based trigger and conflict limit only\n  if (glue_trigger) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR: glue-based restart: fast_glue %.2f > slow_glue %.2f + 0.5\",\n      fast_glue, slow_glue);\n    return true;\n  }\n  if (decision_rate_trigger) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR: decision-rate restart: decision_rate %.2f < 0.8 * median_decision_rate %.2f\",\n      decision_rate, median_decision_rate);\n    return true;\n  }\n  if (conflict_trigger) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR: conflicts restart: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 448, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1264}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e62016988190aecdb0da62235cb8", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "68e83fca97b894ce348af0a202f4d791", "body": {"id": "resp_029df65021e80f17006921e5ccb6fc8190b1d6556dcf7f3a1a", "object": "response", "created_at": 1763829196, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_029df65021e80f17006921e5cce9788190b1b497bf60aa0eac", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Fetch glue and decision rate averages for current phase\n  const bool stable = solver->stable;\n  const double fast_glue = solver->averages[stable].fast_glue.value;\n  const double slow_glue = solver->averages[stable].slow_glue.value;\n  const double decision_rate = solver->averages[stable].decision_rate.value;\n\n  // Access median decision rate EWMA (may be 0 if uninitialized)\n  double median_decision_rate = solver->median_decision_rate_ewma;\n\n  // 1. Glue-based trigger: fast_glue > slow_glue + 0.5\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // 2. Decision rate trigger: decision_rate < 0.8 * median_decision_rate_ewma\n  bool drate_trigger = false;\n  if (median_decision_rate > 0.0)\n    drate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // 3. Conflict limit trigger\n  bool conflicts_trigger = (solver->statistics.conflicts >= solver->limits.restart.conflicts);\n\n  // Tie-breaking: prefer glue/decision triggers over conflict limit,\n  // and prefer unstable when simultaneous (but this is per-phase logic).\n  if (glue_trigger || drate_trigger)\n    return true;\n\n  // Fall back to conflict limit if neither glue nor drate triggered\n  if (conflicts_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 369, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1185}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e620170481909590d98171f75aaf", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "3c3da6babc00518ff622baaaf9625360", "body": {"id": "resp_08bbc6fbda68eba8006921e5d2228c8197be211a60e3a902f6", "object": "response", "created_at": 1763829202, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08bbc6fbda68eba8006921e5d253708197a802b5c185803168", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather current values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // --- GLUE-BASED RESTART CHECK ---\n  // (1) fast_glue_ewma > slow_glue_ewma + 0.5\n  const bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // --- DECISION RATE-BASED RESTART CHECK ---\n  // (2) decision_rate_ewma < 0.8 \u00d7 median_decision_rate_ewma\n  // The median_decision_rate_ewma is updated at each phase transition to stable.\n  // Assume solver->median_decision_rate_ewma is maintained elsewhere.\n  bool rate_trigger = false;\n  if (solver->median_decision_rate_ewma > 0.0) {\n    rate_trigger = (decision_rate < 0.8 * solver->median_decision_rate_ewma);\n  }\n\n  // --- CONFLICT-BASED RESTART CHECK ---\n  // (3) stats.conflicts >= restart_conflict_limit\n  const bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // --- TIE-BREAKING AND PRIORITIZATION ---\n  // If any trigger fires, restart immediately.\n  if (glue_trigger || rate_trigger) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR restart: glue_trigger=%d (fast=%.2f slow=%.2f), \"\n      \"rate_trigger=%d (rate=%.2f median=%.2f)\",\n      glue_trigger, fast_glue, slow_glue,\n      rate_trigger, decision_rate, solver->median_decision_rate_ewma);\n    return true;\n  }\n\n  // If neither glue nor rate triggers, check conflict-based trigger.\n  if (conflict_trigger) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR restart: conflict_trigger (conflicts=%\" PRIu64 \" limit=%\" PRIu64 \")\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  // Otherwise, do not restart.\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 532, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1348}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e62012908190ac87dd43cdcb5bef", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "af13e02bc00d41f995f70eff11744e3e", "body": {"id": "resp_0fcad581b95a07dd006921e5d827d08195b57961e61592e133", "object": "response", "created_at": 1763829208, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0fcad581b95a07dd006921e5d8728081959fe5e57fbc30a492", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Get statistics\n  const uint64_t conflicts = CONFLICTS;\n  const uint64_t limit_conflicts = solver->limits.restart.conflicts;\n\n  // Compute glue averages\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Compute decision rate ewma\n  const double decision_rate_ewma = solver->averages[solver->stable].decision_rate.value;\n\n  // Median decision rate ewma (updated at phase transitions to stable)\n  // It is assumed to be stored and updated in solver->median_decision_rate_ewma,\n  // which must be handled elsewhere at phase transitions.\n  const double median_decision_rate_ewma = solver->median_decision_rate_ewma;\n\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // Tie-breaking: If median not set (e.g., zero), only use glue-based trigger.\n  bool median_available = (median_decision_rate_ewma > 0.0);\n\n  bool decision_rate_trigger = false;\n  if (median_available)\n    decision_rate_trigger = (decision_rate_ewma < 0.8 * median_decision_rate_ewma);\n\n  bool conflict_limit_trigger = (conflicts >= limit_conflicts);\n\n  // Priority: glue_trigger or decision_rate_trigger (hybrid), then conflict limit.\n  if (glue_trigger) {\n    kissat_extremely_verbose(solver,\n      \"restart: fast_glue %.2f > slow_glue %.2f + 0.5 (%.2f)\",\n      fast_glue, slow_glue, slow_glue + 0.5);\n    return true;\n  }\n\n  if (decision_rate_trigger) {\n    kissat_extremely_verbose(solver,\n      \"restart: decision_rate_ewma %.2f < 0.8 * median_decision_rate_ewma %.2f (%.2f)\",\n      decision_rate_ewma, median_decision_rate_ewma, 0.8 * median_decision_rate_ewma);\n    return true;\n  }\n\n  if (conflict_limit_trigger) {\n    kissat_extremely_verbose(solver,\n      \"restart: conflict limit reached (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      conflicts, limit_conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 553, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1369}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e62010fc81909cc8602e1112b884", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "f9c8cac053e9e53105b8d5a927fb7db3", "body": {"id": "resp_020fad75d7f5c5fd006921e5de21408190b6717f6141508ff4", "object": "response", "created_at": 1763829214, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_020fad75d7f5c5fd006921e5de61a881908464fdaa8e5ba92c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  const double fast_glue = solver->averages[solver->stable].fast_glue.value;\n  const double slow_glue = solver->averages[solver->stable].slow_glue.value;\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n  double median_decision_rate = solver->averages[solver->stable].median_decision_rate_ewma;\n\n  // 1. Fast glue > slow glue + 0.5\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // 2. Decision rate < 0.8 * median decision rate\n  bool median_available = (median_decision_rate > 0.0);\n  bool rate_trigger = false;\n  if (median_available)\n    rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // 3. Conflict limit trigger\n  bool conflict_trigger = (solver->statistics.conflicts >= solver->limits.restart.conflicts);\n\n  // Tie-breaking: if glue or rate triggers, restart immediately.\n  if (glue_trigger || rate_trigger)\n    return true;\n  if (conflict_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 306, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1122}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e6201364819087bc70f122d2ba83", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "8856d83e98dd6bc1d420e78e46098329", "body": {"id": "resp_05bae54750e4a541006921e5e355748194a392684fb3b4f0e1", "object": "response", "created_at": 1763829219, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_05bae54750e4a541006921e5e3962c81948fa77624be69ff55", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Access EWMA values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Access or initialize median_decision_rate_ewma\n  double median_decision_rate;\n  bool has_median = false;\n  if (solver->median_decision_rate_ewma >= 0.0) {\n    median_decision_rate = solver->median_decision_rate_ewma;\n    has_median = true;\n  }\n\n  // (1) Glue-based restart trigger\n  if (fast_glue > slow_glue + 0.5) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR restart: fast_glue %.2f > slow_glue %.2f + 0.5\", fast_glue, slow_glue);\n    return true;\n  }\n\n  // (2) Decision rate-based restart trigger, if median is available\n  if (has_median && (decision_rate < 0.8 * median_decision_rate)) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR restart: decision_rate %.4f < 0.8*median_decision_rate %.4f\",\n      decision_rate, 0.8 * median_decision_rate);\n    return true;\n  }\n\n  // (3) Conflict-based fallback\n  if (CONFLICTS >= solver->limits.restart.conflicts) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR restart: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 420, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1236}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e62024fc8190b2aa86addeafa036", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "59a39afe32087dca718f7e29ab33cc84", "body": {"id": "resp_0c2ac214c6bec085006921e5e893008190a498a8bf965c5e7b", "object": "response", "created_at": 1763829224, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0c2ac214c6bec085006921e5e8d440819088429d308d1596a4", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit check (used as last resort)\n  const bool conflict_limit = CONFLICTS >= solver->limits.restart.conflicts;\n\n  // Get averages for current stage (stable or unstable)\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Median decision rate (updated externally at stable phase transitions)\n  const double median_decision_rate = solver->median_decision_rate_ewma;\n\n  // (1) Glue-based: fast_glue > slow_glue + 0.5\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // (2) Decision-rate-based: decision_rate < 0.8 * median_decision_rate, if median available\n  bool median_available = (median_decision_rate > 0.0);\n  bool decision_rate_trigger = false;\n  if (median_available)\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // Tie-breaking: If both glue and decision-rate triggers fire, restart.\n  // If median unavailable, ignore decision-rate trigger.\n  bool triggered = glue_trigger ||\n                   (median_available && decision_rate_trigger);\n\n  // If neither glue nor decision-rate triggers fire, fallback to conflict limit.\n  if (!triggered && conflict_limit)\n    triggered = true;\n\n  // Prefer glue/decision triggers over conflict limit (handled by order above).\n  // If both glue and decision triggers fire, trigger immediately (handled by '||').\n\n  // If stable, use the same logic; if unstable and triggers fire, prioritize restart.\n  // This is implicit: we always restart if triggers fire, regardless of stage.\n\n  if (triggered) {\n    kissat_extremely_verbose (\n      solver,\n      \"restarting: fast_glue=%.2f slow_glue=%.2f median_decision_rate=%.2f \"\n      \"decision_rate=%.2f glue_trigger=%d decision_rate_trigger=%d conflict_limit=%d\",\n      fast_glue, slow_glue, median_decision_rate, decision_rate,\n      glue_trigger, decision_rate_trigger, conflict_limit\n    );\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 531, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1347}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e62021448190bbb295012a4b3eee", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "6b030002eaf4d2c85f9b027796530f4d", "body": {"id": "resp_0145367a76a9b46a006921e5ef16ec81979522e447a4fb69bb", "object": "response", "created_at": 1763829231, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0145367a76a9b46a006921e5ef5e1881978c183e3956853db9", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather relevant metrics\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // --- DAGR-HR: Condition (1) ---\n  // fast_glue_ewma > slow_glue_ewma + 0.5\n  const bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // --- DAGR-HR: Condition (2) ---\n  // Use decision_rate_ewma < 0.8 \u00d7 median_decision_rate_ewma\n  // If median unavailable, treat as not triggered (per fallback rule)\n  bool decision_rate_trigger = false;\n  if (solver->median_decision_rate_ewma > 0.0)\n    decision_rate_trigger =\n      (decision_rate < 0.8 * solver->median_decision_rate_ewma);\n\n  // --- DAGR-HR: Condition (3) ---\n  // stats.conflicts \u2265 restart_conflict_limit\n  const bool conflicts_trigger =\n    (solver->statistics.conflicts >= solver->limits.restart.conflicts);\n\n  // --- Tie-breaking: prefer glue/decision triggers over conflicts ---\n  // If any of glue_trigger or decision_rate_trigger, restart immediately\n  if (glue_trigger || decision_rate_trigger)\n    return true;\n\n  // Otherwise, if conflicts trigger, restart\n  if (conflicts_trigger)\n    return true;\n\n  // Otherwise, do not restart\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 377, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1193}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e62015448190a98b40e0bd1ca907", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "5971d6214673de0a9f2447666504870d", "body": {"id": "resp_05b97628a3d5d97b006921e5f581e481969dbffcc3c589204e", "object": "response", "created_at": 1763829237, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_05b97628a3d5d97b006921e5f5b654819697df933e72effb0a", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather relevant statistics and internal state\n  const uint64_t conflicts = CONFLICTS;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n  const bool is_stable = solver->stable;\n\n  // Glue averages\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Decision rate\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Median decision rate EWMA (updated each stable phase)\n  // If unavailable (e.g. zero), ignore condition (use glue only)\n  const double median_decision_rate =\n    solver->averages[solver->stable].median_decision_rate_ewma;\n\n  // DAGR-HR (Dynamic Adaptive Glue-Rate Hybrid Restart) conditions\n\n  // (1) Glue threshold\n  const bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // (2) Decision rate threshold\n  bool decision_rate_trigger = false;\n  if (median_decision_rate > 0.0) {\n    decision_rate_trigger =\n      (decision_rate < 0.8 * median_decision_rate);\n  }\n\n  // (3) Conflict limit trigger (only if not glue/decision triggers)\n  const bool conflicts_trigger = (conflicts >= conflict_limit);\n\n  // Tie-breaking: glue/decision triggers dominate conflict limit\n  if (glue_trigger || decision_rate_trigger) {\n    kissat_extremely_verbose(\n      solver,\n      \"DAGR-HR restart: glue_trigger=%d (fast=%.2f, slow=%.2f), \"\n      \"decision_rate_trigger=%d (current=%.2f, median=%.2f)\",\n      glue_trigger, fast_glue, slow_glue,\n      decision_rate_trigger, decision_rate, median_decision_rate);\n    return true;\n  }\n\n  // Fallback: conflict limit\n  if (conflicts_trigger) {\n    kissat_extremely_verbose(\n      solver,\n      \"DAGR-HR restart: conflict limit reached (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      conflicts, conflict_limit);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 816, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 517, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1333}, "user": null, "metadata": {}}}, "error": null}
