{"id": "batch_req_6921e6138d608190b3af5898a63ad213", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "78b49903a0a7c2b7a84ecb68bed62c20", "body": {"id": "resp_04c3c5384a96df6c006921e60c35b881939c6540a8d356b0e1", "object": "response", "created_at": 1763829260, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_04c3c5384a96df6c006921e60c7370819395f3fe91aa2b0e86", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather relevant statistics and averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n  double *prev_decision_rate_ptr = &solver->previous_decision_rate_ewma;\n  const double prev_decision_rate = *prev_decision_rate_ptr;\n\n  // Tie-breaking: 1. Glue gap, 2. Decision rate drop, 3. Conflict limit\n  bool restart = false;\n\n  // 1. Glue gap condition\n  if (fast_glue >= slow_glue + 2.0)\n  {\n    restart = true;\n    kissat_extremely_verbose (solver,\n      \"restarting: fast glue %.2f >= slow glue %.2f + 2.0\",\n      fast_glue, slow_glue);\n  }\n  // 2. Decision rate drop\n  else if (decision_rate < 0.8 * prev_decision_rate)\n  {\n    restart = true;\n    kissat_extremely_verbose (solver,\n      \"restarting: decision rate %.6f < 0.8 * previous decision rate %.6f\",\n      decision_rate, prev_decision_rate);\n  }\n  // 3. Conflict limit condition\n  else if (solver->statistics.conflicts >= solver->limits.restart.conflicts)\n  {\n    restart = true;\n    kissat_extremely_verbose (solver,\n      \"restarting: conflict limit %ld reached (conflicts: %ld, limit: %ld)\",\n      solver->limits.restart.conflicts,\n      solver->statistics.conflicts,\n      solver->limits.restart.conflicts);\n  }\n\n  // On restart, update previous_decision_rate_ewma\n  if (restart)\n    *prev_decision_rate_ptr = decision_rate;\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 440, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1214}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e6137e508190873e69b891f8592e", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "801d8b1916443c73af5c2cad60be51ed", "body": {"id": "resp_0a075eb47efdcb9e006921e5d0de588195aad4e1e5622a04ad", "object": "response", "created_at": 1763829200, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0a075eb47efdcb9e006921e5d1837481959d6b61888b6b10bc", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather relevant values\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // Use the solver->previous_decision_rate_ewma field (float) for storing previous value\n  // Initialize if first call (0 means uninitialized)\n  if (solver->previous_decision_rate_ewma == 0.0)\n    solver->previous_decision_rate_ewma = decision_rate;\n\n  // Three trigger conditions (by priority)\n  bool glue_gap = (fast_glue >= slow_glue + 2.0);\n  bool rate_drop = (decision_rate < 0.8 * solver->previous_decision_rate_ewma);\n  bool conflict_limit = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  if (glue_gap) {\n    kissat_extremely_verbose(solver,\n      \"adaptive hybrid restart: fast_glue %.2f >= slow_glue %.2f + 2.0 (%.2f)\",\n      fast_glue, slow_glue, slow_glue + 2.0);\n    solver->previous_decision_rate_ewma = decision_rate;\n    return true;\n  }\n  if (rate_drop) {\n    kissat_extremely_verbose(solver,\n      \"adaptive hybrid restart: decision rate %.2f < 0.8 * previous %.2f\",\n      decision_rate, solver->previous_decision_rate_ewma);\n    solver->previous_decision_rate_ewma = decision_rate;\n    return true;\n  }\n  if (conflict_limit) {\n    kissat_extremely_verbose(solver,\n      \"adaptive hybrid restart: conflict limit %ld >= restart limit %ld\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    solver->previous_decision_rate_ewma = decision_rate;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 459, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1233}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e6138d1c8190aa50f300422f6694", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "5597d8a449e806b939ae4d8c74a273d7", "body": {"id": "resp_0befbb405e392508006921e5d7138c81908f1ca1f873e16ffc", "object": "response", "created_at": 1763829207, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0befbb405e392508006921e5d793e881908f1ff1e15909616a", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather relevant statistics and averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Retrieve previous decision rate EWMA from solver struct (initialize if needed)\n  double *prev_decision_rate_ptr = &solver->previous_decision_rate_ewma;\n  double prev_decision_rate = *prev_decision_rate_ptr;\n\n  // Tie-breaking: Condition 1 (glue gap) prioritized\n  if (fast_glue >= slow_glue + 2.0) {\n    *prev_decision_rate_ptr = decision_rate;\n    kissat_extremely_verbose (solver,\n      \"restarting: fast_glue %.2f >= slow_glue %.2f + 2.0 (%.2f), glue gap trigger\",\n      fast_glue, slow_glue, slow_glue + 2.0);\n    return true;\n  }\n\n  // Condition 2: decision rate drop\n  if (decision_rate < 0.8 * prev_decision_rate) {\n    *prev_decision_rate_ptr = decision_rate;\n    kissat_extremely_verbose (solver,\n      \"restarting: decision_rate %.2f < 0.8 * prev_decision_rate %.2f (%.2f), rate drop trigger\",\n      decision_rate, prev_decision_rate, 0.8 * prev_decision_rate);\n    return true;\n  }\n\n  // Condition 3: conflict limit\n  if (CONFLICTS >= solver->limits.restart.conflicts) {\n    *prev_decision_rate_ptr = decision_rate;\n    kissat_extremely_verbose (solver,\n      \"restarting: conflicts %\" PRIu64 \" >= restart conflict limit %\" PRIu64,\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  // No restart triggered\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 456, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1230}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e61385848190a4f73e08033322d8", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "013e02324ed82d9f1a22e86092d0a9e2", "body": {"id": "resp_07c10ae28e75194a006921e60c38548196bb5ec1707bba324d", "object": "response", "created_at": 1763829260, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_07c10ae28e75194a006921e60c8f3c819699f04160f0882150", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Gather required statistics and averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Use solver->previous_decision_rate_ewma as persistent storage\n  // Initialize if first call (treat 0 as unset, which is safe as decision rate is always >0 after first phase)\n  if (solver->previous_decision_rate_ewma <= 0.0)\n    solver->previous_decision_rate_ewma = decision_rate;\n\n  // Condition 1: Glue gap\n  if (fast_glue >= slow_glue + 2.0) {\n    solver->previous_decision_rate_ewma = decision_rate;\n    kissat_extremely_verbose (solver,\n      \"adaptive restart: fast glue %.2f >= slow glue %.2f + 2.0 (%.2f), firing restart\",\n      fast_glue, slow_glue, slow_glue + 2.0);\n    return true;\n  }\n\n  // Condition 2: Decision rate drop\n  if (decision_rate < 0.8 * solver->previous_decision_rate_ewma) {\n    solver->previous_decision_rate_ewma = decision_rate;\n    kissat_extremely_verbose (solver,\n      \"adaptive restart: decision rate %.6f < 0.8 * previous %.6f (%.6f), firing restart\",\n      decision_rate, solver->previous_decision_rate_ewma,\n      0.8 * solver->previous_decision_rate_ewma);\n    return true;\n  }\n\n  // Condition 3: Conflict limit\n  if (CONFLICTS >= solver->limits.restart.conflicts) {\n    solver->previous_decision_rate_ewma = decision_rate;\n    kissat_extremely_verbose (solver,\n      \"adaptive restart: conflict limit reached %ld >= %ld, firing restart\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  // No restart condition met\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 492, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1266}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e613bb408190872a60f7fed8dcf2", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "4df14f74a4d42809974d84f488433027", "body": {"id": "resp_0f0e13283ca023e6006921e5dcd724819590e5bfb966eaf7e0", "object": "response", "created_at": 1763829212, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0f0e13283ca023e6006921e5dd3cf08195ba9c9875802eb3a6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Get current averages and statistics\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n  const unsigned long conflicts = CONFLICTS;\n  const unsigned long conflict_limit = solver->limits.restart.conflicts;\n\n  // Use solver->previous_decision_rate_ewma to track previous value\n  // Must be initialized on solver struct (assumed present or added elsewhere)\n  double *prev_rate_ptr = &solver->previous_decision_rate_ewma;\n  bool restart = false;\n\n  // Condition 1: Glue gap\n  if (fast_glue >= slow_glue + 2.0) {\n    restart = true;\n    kissat_extremely_verbose(\n      solver,\n      \"restart: fast_glue %.2f >= slow_glue %.2f + 2.0 (%.2f), triggering restart\",\n      fast_glue, slow_glue, slow_glue + 2.0\n    );\n  }\n  // Condition 2: Decision rate drop\n  else if (decision_rate < 0.8 * (*prev_rate_ptr)) {\n    restart = true;\n    kissat_extremely_verbose(\n      solver,\n      \"restart: decision_rate %.4f < 0.8 * previous_decision_rate_ewma %.4f (%.4f), triggering restart\",\n      decision_rate, *prev_rate_ptr, 0.8 * (*prev_rate_ptr)\n    );\n  }\n  // Condition 3: Conflict limit\n  else if (conflicts >= conflict_limit) {\n    restart = true;\n    kissat_extremely_verbose(\n      solver,\n      \"restart: conflicts %lu >= restart_conflict_limit %lu, triggering restart\",\n      conflicts, conflict_limit\n    );\n  }\n\n  // On any restart, update previous_decision_rate_ewma\n  if (restart)\n    *prev_rate_ptr = decision_rate;\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 470, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1244}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e6137f8c81909d64ed327654df02", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "162e50ab36e50dffec068c209f71be1d", "body": {"id": "resp_0aafc33e7ac81211006921e60c39548190aaca6030d0dce1ce", "object": "response", "created_at": 1763829260, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0aafc33e7ac81211006921e60c6e988190b9fed07200032c30", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit check (lowest priority)\n  if (CONFLICTS >= solver->limits.restart.conflicts) {\n    solver->previous_decision_rate_ewma = AVERAGE(decision_rate);\n    return true;\n  }\n\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n  double *prev = &solver->previous_decision_rate_ewma;\n\n  // Condition 1: Glue gap\n  if (fast_glue >= slow_glue + 2.0) {\n    *prev = decision_rate;\n    return true;\n  }\n\n  // Condition 2: Decision rate drop\n  if (decision_rate < 0.8 * (*prev)) {\n    *prev = decision_rate;\n    return true;\n  }\n\n  // No conditions met\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 244, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1018}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e61512808190afa2e7311dd2b672", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "03cdadf540969562f74e4a48c959c1ba", "body": {"id": "resp_015a9bdd66865b2d006921e5cfe1fc819696b33fff41840e37", "object": "response", "created_at": 1763829199, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_015a9bdd66865b2d006921e5d018fc8196aa0f11422b16c639", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Condition 1: Glue gap\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  if (fast_glue >= slow_glue + 2.0) {\n    solver->previous_decision_rate_ewma = AVERAGE (decision_rate); // update\n    return true;\n  }\n\n  // Condition 2: Decision rate drop\n  const double decision_rate = AVERAGE (decision_rate);\n  const double prev_decision_rate = solver->previous_decision_rate_ewma;\n  if (decision_rate < 0.8 * prev_decision_rate) {\n    solver->previous_decision_rate_ewma = decision_rate;\n    return true;\n  }\n\n  // Condition 3: Conflict limit\n  if (solver->statistics.conflicts >= solver->limits.restart.conflicts) {\n    solver->previous_decision_rate_ewma = decision_rate;\n    return true;\n  }\n\n  // No restart condition met\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 269, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1043}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e613801c8190b6abfab32e467253", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "212e559bfe00771bdcd8e475629a7d99", "body": {"id": "resp_0d4eaf44d8b295a7006921e5cfe3cc8195aad8a4c168a25d0e", "object": "response", "created_at": 1763829199, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0d4eaf44d8b295a7006921e5d0362c8195b4dc782f0ffda3df", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Always available\n    const uint64_t conflicts = solver->statistics.conflicts;\n    const uint64_t conflict_limit = solver->limits.restart.conflicts;\n    const double fast_glue = solver->averages[solver->stable].fast_glue.value;\n    const double slow_glue = solver->averages[solver->stable].slow_glue.value;\n    const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n    // Get previous_decision_rate_ewma from solver struct (initialize if not present)\n    // We assume previous_decision_rate_ewma is declared and maintained in kissat struct.\n    // If not, declare: double previous_decision_rate_ewma;\n    double *prev_rate_ptr = &solver->previous_decision_rate_ewma;\n    double prev_decision_rate = *prev_rate_ptr;\n\n    bool trigger = false;\n    int reason = 0;\n\n    // 1. Glue gap triggers first\n    if (fast_glue >= slow_glue + 2.0) {\n        trigger = true;\n        reason = 1;\n    } else if (decision_rate < 0.8 * prev_decision_rate) {\n        trigger = true;\n        reason = 2;\n    } else if (conflicts >= conflict_limit) {\n        trigger = true;\n        reason = 3;\n    }\n\n    if (trigger) {\n        // Always update previous_decision_rate_ewma on restart\n        *prev_rate_ptr = decision_rate;\n\n        if (kissat_extremely_verbose_enabled(solver)) {\n            const char *why =\n                reason == 1 ? \"glue gap\" :\n                reason == 2 ? \"decision rate drop\" :\n                \"conflict limit\";\n            kissat_extremely_verbose(\n                solver,\n                \"restart triggered by %s: \"\n                \"fast_glue=%.2f slow_glue=%.2f decision_rate=%.5f prev_rate=%.5f conflicts=%\" PRIu64 \" limit=%\" PRIu64,\n                why, fast_glue, slow_glue, decision_rate, prev_decision_rate, conflicts, conflict_limit\n            );\n        }\n        return true;\n    }\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 512, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1286}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e6137f0881909bad67bdb842d452", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "d66aa440cb43d3db0236f8804884858d", "body": {"id": "resp_0966bd9927794fb8006921e5cfe93c819489611733c4c98791", "object": "response", "created_at": 1763829199, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0966bd9927794fb8006921e5d030a8819488bd106fc48436ff", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n  const double fast_glue = solver->averages[solver->stable].fast_glue.value;\n  const double slow_glue = solver->averages[solver->stable].slow_glue.value;\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Use solver->previous_decision_rate_ewma as a persistent field (must be defined in struct kissat).\n  // If not yet initialised, fall back to current decision_rate.\n  double previous_decision_rate =\n    solver->previous_decision_rate_ewma == 0.0 ?\n    decision_rate :\n    solver->previous_decision_rate_ewma;\n\n  bool glue_gap = (fast_glue >= slow_glue + 2.0);\n  bool rate_drop = (decision_rate < 0.8 * previous_decision_rate);\n  bool conflict_over = (conflicts >= conflict_limit);\n\n  if (glue_gap) {\n    kissat_extremely_verbose(solver,\n      \"restart: fast_glue %.2f >= slow_glue %.2f + 2.0 (gap)\", fast_glue, slow_glue);\n    solver->previous_decision_rate_ewma = decision_rate;\n    return true;\n  }\n\n  if (rate_drop) {\n    kissat_extremely_verbose(solver,\n      \"restart: decision rate %.6f < 0.8 * previous %.6f (drop)\", decision_rate, previous_decision_rate);\n    solver->previous_decision_rate_ewma = decision_rate;\n    return true;\n  }\n\n  if (conflict_over) {\n    kissat_extremely_verbose(solver,\n      \"restart: conflicts %\" PRIu64 \" >= limit %\" PRIu64, conflicts, conflict_limit);\n    solver->previous_decision_rate_ewma = decision_rate;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 466, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1240}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921e614033081909507fddf674a6de5", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "b23a61fe9bdfab995062b848d4014ac8", "body": {"id": "resp_03792b10e6f22d58006921e5cff72881949570baa552da49eb", "object": "response", "created_at": 1763829199, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_03792b10e6f22d58006921e5d06a0481949f2e01112b565d93", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Get conflict count and limit\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n  // Get EWMA values for glue and decision rate\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // Use stable/reluctant policy if in stable mode (preserve original Kissat logic)\n  if (solver->stable)\n    return kissat_reluctant_triggered(&solver->reluctant);\n\n  // Retrieve or initialize previous_decision_rate_ewma (store in solver->restart.previous_decision_rate_ewma)\n  double *prev_dr_ewma_ptr = &solver->restart.previous_decision_rate_ewma;\n  if (isnan(*prev_dr_ewma_ptr))\n    *prev_dr_ewma_ptr = decision_rate;\n\n  // --- Adaptive Glue-Rate Hybrid Restart Policy ---\n\n  // 1. Glue gap trigger\n  if (fast_glue >= slow_glue + 2.0) {\n    *prev_dr_ewma_ptr = decision_rate;\n    kissat_extremely_verbose(solver,\n      \"restarting: fast_glue %.2f >= slow_glue %.2f + 2.0 (%.2f)\",\n      fast_glue, slow_glue, slow_glue + 2.0);\n    return true;\n  }\n\n  // 2. Decision rate drop trigger\n  if (decision_rate < 0.8 * (*prev_dr_ewma_ptr)) {\n    *prev_dr_ewma_ptr = decision_rate;\n    kissat_extremely_verbose(solver,\n      \"restarting: decision_rate %.6f < 0.8 * previous_decision_rate_ewma %.6f\",\n      decision_rate, *prev_dr_ewma_ptr / 0.8);\n    return true;\n  }\n\n  // 3. Conflict limit trigger\n  if (conflicts >= conflict_limit) {\n    *prev_dr_ewma_ptr = decision_rate;\n    kissat_extremely_verbose(solver,\n      \"restarting: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n      conflicts, conflict_limit);\n    return true;\n  }\n\n  // No restart triggered\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 774, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 550, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1324}, "user": null, "metadata": {}}}, "error": null}
