{"id": "batch_req_6921390d76748190bf94a8718c291cf2", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "08347b314798041ed169f14eb01ce3ef", "body": {"id": "resp_01a078abe111f23e00692138a17a288199ad8460ea7195c991", "object": "response", "created_at": 1763784865, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_01a078abe111f23e00692138a24d2c81998370e30da27d7b85", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard cap: conflict limit trigger\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // EWMA updates and variables\n  double fast_glue = AVERAGE (fast_glue);\n  double slow_glue = AVERAGE (slow_glue);\n  double decision_rate = AVERAGE (decision_rate);\n\n  // Use a persistent EWMA for average_decision_rate\n  // Initialize if necessary\n  if (!solver->average_decision_rate_initialized) {\n    solver->average_decision_rate = decision_rate;\n    solver->average_decision_rate_initialized = true;\n  } else {\n    solver->average_decision_rate =\n      0.98 * solver->average_decision_rate + 0.02 * decision_rate;\n  }\n\n  double average_decision_rate = solver->average_decision_rate;\n\n  // Set thresholds, more conservative in stable mode\n  double glue_threshold = solver->stable ? 1.30 : 1.15;\n  double decision_threshold = solver->stable ? 0.70 : 0.85;\n\n  bool glue_criterion = (fast_glue > glue_threshold * slow_glue);\n  bool decision_criterion = (decision_rate < decision_threshold * average_decision_rate);\n\n  // Extremely verbose debugging output\n  kissat_extremely_verbose (solver,\n    \"restart thresholds: glue %.2f (fast) > %.2f * %.2f (slow = %.2f) = %s, \"\n    \"decision rate %.2f < %.2f * %.2f (avg = %.2f) = %s, \"\n    \"conflicts %ld/%ld\",\n    fast_glue, glue_threshold, slow_glue, slow_glue,\n    glue_criterion ? \"yes\" : \"no\",\n    decision_rate, decision_threshold, average_decision_rate, average_decision_rate,\n    decision_criterion ? \"yes\" : \"no\",\n    CONFLICTS, solver->limits.restart.conflicts);\n\n  // Apply hybrid trigger\n  if (glue_criterion && decision_criterion)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 492, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1142}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921390d6de08190b7c4ce3d1af2ebe8", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "3c920db107c1786cf2c272bb80c277f0", "body": {"id": "resp_0deb0393e993c35a00692138f9da10819881d5005a1dd39c94", "object": "response", "created_at": 1763784953, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0deb0393e993c35a00692138fa4bc88198bc6d0bf4b977ba72", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard cap: restart if conflict limit hit\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // EWMA values\n  const double fast = AVERAGE(fast_glue);\n  const double slow = AVERAGE(slow_glue);\n  const double dec_rate = AVERAGE(decision_rate);\n\n  // Persistent average_decision_rate as EWMA\n  double *avg_dec_rate_ptr = &solver->averages.average_decision_rate;\n  // If uninitialized, set to current decision rate\n  if (*avg_dec_rate_ptr == 0.0)\n    *avg_dec_rate_ptr = dec_rate;\n  else\n    *avg_dec_rate_ptr = 0.98 * (*avg_dec_rate_ptr) + 0.02 * dec_rate;\n\n  double glue_factor = 1.15, dec_factor = 0.85;\n  if (solver->stable) {\n    glue_factor = 1.30;\n    dec_factor = 0.70;\n  }\n\n  bool glue_criterion = (fast > glue_factor * slow);\n  bool dec_criterion = (dec_rate < dec_factor * (*avg_dec_rate_ptr));\n\n  kissat_extremely_verbose(\n    solver,\n    \"adaptive glue-decision hybrid restart: \"\n    \"fast_glue=%.2f slow_glue=%.2f fast/slow=%.2f glue_thr=%.2f \"\n    \"dec_rate=%.2f avg_dec_rate=%.2f dec_thr=%.2f \"\n    \"conflicts=%\" PRIu64 \"/%\" PRIu64,\n    fast, slow, fast/slow, glue_factor*slow,\n    dec_rate, *avg_dec_rate_ptr, dec_factor*(*avg_dec_rate_ptr),\n    CONFLICTS, solver->limits.restart.conflicts);\n\n  if (glue_criterion && dec_criterion)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 450, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1100}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921390d75cc81909e977d62c4351507", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "f64b3e3cc6c71a0580820c82ca99248d", "body": {"id": "resp_009e863566daef7900692138a18344819aa335ac0fecaa10b4", "object": "response", "created_at": 1763784865, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_009e863566daef7900692138a25560819a84bc2890cee0d0ed", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard cap: restart if enough conflicts\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // EWMA averages for glue and decision rates\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n  double *average_decision_rate = &solver->averages.average_decision_rate;\n\n  // Update average_decision_rate EWMA\n  // average_decision_rate := 0.98 * average_decision_rate + 0.02 * decision_rate\n  if (*average_decision_rate == 0.0)\n    *average_decision_rate = decision_rate;\n  else\n    *average_decision_rate = 0.98 * (*average_decision_rate) + 0.02 * decision_rate;\n\n  // Adaptive thresholds\n  double glue_threshold, decision_threshold;\n  if (solver->stable) {\n    glue_threshold = 1.30;\n    decision_threshold = 0.70;\n  } else {\n    glue_threshold = 1.15;\n    decision_threshold = 0.85;\n  }\n\n  const double glue_margin = glue_threshold * slow_glue;\n  const double decision_margin = decision_threshold * (*average_decision_rate);\n\n  kissat_extremely_verbose (solver,\n    \"adaptive hybrid restart: fast_glue %g > %g (%.2f * slow_glue), \"\n    \"decision_rate %g < %g (%.2f * avg_decision_rate)\",\n    fast_glue, glue_margin, glue_threshold,\n    decision_rate, decision_margin, decision_threshold);\n\n  // Decision: both glue and decision conditions must be met\n  if (fast_glue > glue_margin && decision_rate < decision_margin)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 440, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1090}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921390d6df481908fbd9e479709a842", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "29677efd8986a2e164f2f37fbcc906e5", "body": {"id": "resp_0d1b8ef9dbcdefab00692138a1976c819994baa5e09ac50a59", "object": "response", "created_at": 1763784865, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0d1b8ef9dbcdefab00692138a24aa08199accbfcf94598375c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard cap: conflict limit\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Get EWMA values for glue and decision rate\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Maintain an EWMA for average_decision_rate (initialize if needed)\n  if (!solver->averages.average_decision_rate_initialized) {\n    solver->averages.average_decision_rate = decision_rate;\n    solver->averages.average_decision_rate_initialized = true;\n  } else {\n    solver->averages.average_decision_rate =\n      0.98 * solver->averages.average_decision_rate +\n      0.02 * decision_rate;\n  }\n  const double avg_decision_rate = solver->averages.average_decision_rate;\n\n  // Sensitivity parameters (default, adaptive if stable)\n  double glue_threshold = 1.15;\n  double decision_threshold = 0.85;\n  if (solver->stable) {\n    glue_threshold = 1.30;\n    decision_threshold = 0.70;\n  }\n\n  // Hybrid criteria: glue and decision rate\n  bool glue_trigger = fast_glue > glue_threshold * slow_glue;\n  bool decision_trigger = decision_rate < decision_threshold * avg_decision_rate;\n\n  // Only restart if both hybrid triggers are met\n  if (glue_trigger && decision_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 376, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1026}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921390d73e88190905108e7dfc0fb0f", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "6c444d06e17539c9af9c56e40ed3b3a6", "body": {"id": "resp_09838a934caae13500692138a639148199bad89507c9eb0cad", "object": "response", "created_at": 1763784870, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_09838a934caae13500692138a6bf9c8199a2473b06d89c884b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // 1. Hard cap: conflict-based restart\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Setup EWMA values\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // 2. Maintain an EWMA for average_decision_rate\n  double *avg_decision_rate_ptr = &solver->averages.average_decision_rate;\n  // Initialize on first use\n  if (*avg_decision_rate_ptr == 0)\n    *avg_decision_rate_ptr = decision_rate;\n  else\n    *avg_decision_rate_ptr = 0.98 * (*avg_decision_rate_ptr) + 0.02 * decision_rate;\n\n  // Use the appropriate thresholds depending on stable mode\n  double glue_threshold, decision_threshold;\n  if (solver->stable) {\n    glue_threshold = 1.30;      // More conservative in stable mode\n    decision_threshold = 0.70;\n  } else {\n    glue_threshold = 1.15;\n    decision_threshold = 0.85;\n  }\n\n  // 3. Adaptive Glue-Decision Hybrid restart\n  bool glue_trigger = (fast_glue > glue_threshold * slow_glue);\n  bool decision_trigger = (decision_rate < decision_threshold * (*avg_decision_rate_ptr));\n\n  if (glue_trigger && decision_trigger) {\n    kissat_extremely_verbose(\n      solver,\n      \"adaptive hybrid restart: fast_glue %.2f > %.2f*slow_glue %.2f and decision_rate %.2f < %.2f*avg_decision_rate %.2f\",\n      fast_glue, glue_threshold, slow_glue, decision_rate, decision_threshold, *avg_decision_rate_ptr);\n    return true;\n  }\n\n  // Not restarting\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 454, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1104}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921390d6e9c81908f17925d9a788622", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "10550c289ce63309311f79c4ee44f04d", "body": {"id": "resp_090072b8994e52e100692138a6626c819ab4e6208e4a9afe47", "object": "response", "created_at": 1763784870, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_090072b8994e52e100692138a6e85c819a9da8b027f56e7e23", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard conflict cap: always highest priority\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Get fast/slow glue averages\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Get decision rate EWMA and the running EWMA average\n  const double dec_rate = AVERAGE (decision_rate);\n  double *avg_dec_rate_ptr = &solver->averages.average_decision_rate;\n  double avg_dec_rate = *avg_dec_rate_ptr;\n\n  // EWMA update for average_decision_rate: only after each conflict\n  // (Assume this function is called after conflict, as in Kissat)\n  // Use a tiny smoothing factor to avoid oscillations\n  *avg_dec_rate_ptr = 0.98 * avg_dec_rate + 0.02 * dec_rate;\n  avg_dec_rate = *avg_dec_rate_ptr;\n\n  // Thresholds: adaptive to stable/unstable\n  double glue_margin, dec_margin;\n  if (solver->stable) {\n    glue_margin = 1.30;\n    dec_margin = 0.70;\n  } else {\n    glue_margin = 1.15;\n    dec_margin = 0.85;\n  }\n\n  const bool glue_trigger = (fast > glue_margin * slow);\n  const bool dec_trigger  = (dec_rate < dec_margin * avg_dec_rate);\n\n  kissat_extremely_verbose (\n    solver,\n    \"restart hybrid check: \"\n    \"fast_glue=%.2f slow_glue=%.2f avg_decision_rate=%.5f decision_rate=%.5f \"\n    \"(glue margin=%.2f dec margin=%.2f) glue=%d dec=%d\",\n    fast, slow, avg_dec_rate, dec_rate, glue_margin, dec_margin,\n    glue_trigger, dec_trigger\n  );\n\n  // Hybrid criterion\n  if (glue_trigger && dec_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 474, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1124}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921390d727c819087651667fcbeb8a4", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "5e41ffcd34db6e1d6ee3e45befe81079", "body": {"id": "resp_0b2846b6b3aac4cc00692138a70c5081999af69ac82cd6333d", "object": "response", "created_at": 1763784871, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0b2846b6b3aac4cc00692138a80e7481999dff1c2e135cf459", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard conflict limit: always triggers restart\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // EWMA averages\n  double fast_glue = AVERAGE (fast_glue);\n  double slow_glue = AVERAGE (slow_glue);\n  double decision_rate = AVERAGE (decision_rate);\n\n  // Adaptive EWMA for average_decision_rate\n  // We store this in solver->averages.average_decision_rate (must exist)\n  double *avg_decision_rate_ptr = &solver->averages.average_decision_rate;\n  if (*avg_decision_rate_ptr == 0.0)\n    *avg_decision_rate_ptr = decision_rate;\n  else\n    *avg_decision_rate_ptr = 0.98 * (*avg_decision_rate_ptr) + 0.02 * decision_rate;\n  double avg_decision_rate = *avg_decision_rate_ptr;\n\n  // Adaptive thresholds\n  double glue_threshold, decision_threshold;\n  if (solver->stable) {\n    glue_threshold = 1.30;\n    decision_threshold = 0.70;\n  } else {\n    glue_threshold = 1.15;\n    decision_threshold = 0.85;\n  }\n\n  // Check hybrid glue and decision rate criterion\n  bool glue_condition = (fast_glue > glue_threshold * slow_glue);\n  bool decision_condition = (decision_rate < decision_threshold * avg_decision_rate);\n\n  // Prioritize conflict limit trigger if both met\n  if (glue_condition && decision_condition)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 380, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1030}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921390d739c81909fdebc6e57e740b8", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "11b662f6bd8880a49aeb35baab5eef09", "body": {"id": "resp_03b6addf8909ebe200692138a753248199ad0212fac9b68a0f", "object": "response", "created_at": 1763784871, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_03b6addf8909ebe200692138a7c8408199bbfa3f8d524286af", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard cap: restart if conflict limit is reached\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Retrieve EWMA glue and decision rate values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n  double *avg_decision_rate_ptr = &solver->averages.avg_decision_rate;\n\n  // Initialize average_decision_rate if not set\n  if (!kissat_isfinite (*avg_decision_rate_ptr) || *avg_decision_rate_ptr == 0.0)\n    *avg_decision_rate_ptr = decision_rate;\n\n  // Update average_decision_rate as EWMA\n  *avg_decision_rate_ptr = 0.98 * (*avg_decision_rate_ptr) + 0.02 * decision_rate;\n\n  // Set thresholds based on stable mode\n  double glue_threshold = solver->stable ? 1.30 : 1.15;\n  double decision_threshold = solver->stable ? 0.70 : 0.85;\n\n  // Tie-breaking: prioritize conflict limit (checked above)\n  bool glue_criteria = (fast_glue > glue_threshold * slow_glue);\n  bool decision_criteria = (decision_rate < decision_threshold * (*avg_decision_rate_ptr));\n\n  kissat_extremely_verbose (solver,\n    \"restarting? glue: %.3f > %.2f * %.3f (%d), decision: %.3f < %.2f * %.3f (%d), avg_decision_rate: %.3f\",\n    fast_glue, glue_threshold, slow_glue, glue_criteria,\n    decision_rate, decision_threshold, *avg_decision_rate_ptr, decision_criteria,\n    *avg_decision_rate_ptr);\n\n  if (glue_criteria && decision_criteria)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 457, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1107}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921390d684c819097d15ec57208f695", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "8367ef43b31490d31337e04742314ecc", "body": {"id": "resp_02cebdc408937af700692138a8e44c8199886ca15398cbb2b0", "object": "response", "created_at": 1763784872, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_02cebdc408937af700692138a94bd881998f54559b4120bc7b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard cap: restart if conflict limit is reached\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Fetch current EWMAs\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double dec_rate = AVERAGE (decision_rate);\n\n  // Update average_decision_rate as EWMA\n  double *avg_dec_rate_ptr = &solver->averages.average_decision_rate;\n  // If not initialized, set to current\n  if (*avg_dec_rate_ptr == 0.0)\n    *avg_dec_rate_ptr = dec_rate;\n  else\n    *avg_dec_rate_ptr = 0.98 * (*avg_dec_rate_ptr) + 0.02 * dec_rate;\n\n  // Thresholds (default: 1.15 and 0.85; stable: 1.30 and 0.70)\n  double glue_factor = 1.15, dec_factor = 0.85;\n  if (solver->stable) {\n    glue_factor = 1.30;\n    dec_factor = 0.70;\n  }\n\n  // Compute hybrid conditions\n  bool glue_cond = (fast > glue_factor * slow);\n  bool dec_cond = (dec_rate < dec_factor * (*avg_dec_rate_ptr));\n\n  // Extremely verbose logging\n  kissat_extremely_verbose (\n    solver,\n    \"hybrid-restart: fast_glue %g slow_glue %g avg_dec_rate %g curr_dec_rate %g \"\n    \"thresholds: glue %.2f slow, dec %.2f avg_dec\",\n    fast, slow, *avg_dec_rate_ptr, dec_rate, glue_factor, dec_factor);\n\n  // Decision: hard cap prioritized\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n  if (glue_cond && dec_cond)\n    return true;\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 458, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1108}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6921390d7188819090ab9b3606b7d9d2", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "ee99bbc512a574759ea511dd14e6af43", "body": {"id": "resp_02aed61f5fe0447600692138aa8f74819a880f8ab3bde1ae8f", "object": "response", "created_at": 1763784874, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_02aed61f5fe0447600692138aae3b4819a9dca6cfc94ed224a", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Hard cap: restart if conflicts >= restart_conflict_limit.\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // --- Adaptive Glue-Decision Hybrid Restart ---\n\n  // EWMA values for glue and decision rate.\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // Maintain and update average_decision_rate as EWMA.\n  // Use solver->average_decision_rate for this purpose.\n  // If first time, initialize to current decision_rate.\n  double *avg_decision_rate_ptr = &solver->average_decision_rate;\n  if (*avg_decision_rate_ptr <= 0)\n    *avg_decision_rate_ptr = decision_rate;\n  else\n    *avg_decision_rate_ptr = 0.98 * (*avg_decision_rate_ptr) + 0.02 * decision_rate;\n\n  // Thresholds\n  double glue_threshold, decision_threshold;\n  if (solver->stable) {\n    glue_threshold = 1.30;\n    decision_threshold = 0.70;\n  } else {\n    glue_threshold = 1.15;\n    decision_threshold = 0.85;\n  }\n\n  const double glue_margin = glue_threshold * slow_glue;\n  const double decision_margin = decision_threshold * (*avg_decision_rate_ptr);\n\n  bool glue_criterion = (fast_glue > glue_margin);\n  bool decision_criterion = (decision_rate < decision_margin);\n\n  kissat_extremely_verbose(\n      solver,\n      \"adaptive restart thresholds: fast_glue %g > %.2f * slow_glue %g = %g, \"\n      \"decision_rate %g < %.2f * avg_decision_rate %g = %g\",\n      fast_glue, glue_threshold, slow_glue, glue_margin,\n      decision_rate, decision_threshold, *avg_decision_rate_ptr, decision_margin);\n\n  // If both glue and decision criteria are met, trigger restart.\n  if (glue_criterion && decision_criterion)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 650, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 499, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1149}, "user": null, "metadata": {}}}, "error": null}
