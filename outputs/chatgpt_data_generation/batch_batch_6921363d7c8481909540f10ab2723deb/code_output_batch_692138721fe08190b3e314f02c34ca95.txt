{"id": "batch_req_692138b77ba08190a81dcbd2362bbe51", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "80d1d9c5fb44d8b7d0830ae43bb5309b", "body": {"id": "resp_0598747c88d7d06500692138b2cf2c8195a1d5a8f48d90afa4", "object": "response", "created_at": 1763784882, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0598747c88d7d06500692138b30e508195b7ad052ee42500d0", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Hybrid EWMA Glue-Drop & Adaptive Decision Rate Restart\n\n  // Gather EWMA averages\n  const double fast_glue_ewma = AVERAGE(fast_glue);\n  const double slow_glue_ewma = AVERAGE(slow_glue);\n\n  // Compute decision rate EWMA\n  // decision_rate = decisions / ticks (decisions per search step)\n  // In Kissat, this is typically maintained as solver->averages.decision_rate\n  const double decision_rate_ewma = AVERAGE(decision_rate);\n\n  // Use solver->previous_decision_rate_ewma for the previous value\n  // If not initialized, initialize with current value\n  if (kissat_isnan(solver->previous_decision_rate_ewma)) {\n    solver->previous_decision_rate_ewma = decision_rate_ewma;\n  }\n\n  // Compute thresholds\n  const double glue_threshold = 0.98 * slow_glue_ewma;\n  const double decision_rate_threshold = 0.85 * solver->previous_decision_rate_ewma;\n\n  bool restart = false;\n  bool glue_trigger = false, decision_rate_trigger = false;\n\n  if (fast_glue_ewma >= glue_threshold) {\n    glue_trigger = true;\n    restart = true;\n  } else if (decision_rate_ewma < decision_rate_threshold) {\n    decision_rate_trigger = true;\n    restart = true;\n  }\n\n  // Verbose output for debugging and statistics\n  kissat_extremely_verbose(\n    solver,\n    \"restart check: fast_glue_ewma %g, slow_glue_ewma %g, glue_threshold %g, \"\n    \"decision_rate_ewma %g, prev_decision_rate_ewma %g, decision_rate_threshold %g, \"\n    \"glue_trigger %d, decision_rate_trigger %d\",\n    fast_glue_ewma,\n    slow_glue_ewma,\n    glue_threshold,\n    decision_rate_ewma,\n    solver->previous_decision_rate_ewma,\n    decision_rate_threshold,\n    glue_trigger,\n    decision_rate_trigger\n  );\n\n  // Always update previous_decision_rate_ewma after each check\n  solver->previous_decision_rate_ewma = decision_rate_ewma;\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 548, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1188}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692138b77b148190be7280423b72bde0", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "3b10885c4169998773b2d7bb91fb0c41", "body": {"id": "resp_0e0bce38618e579300692138b2c54881959539199a60729ed3", "object": "response", "created_at": 1763784882, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0e0bce38618e579300692138b311b481958072001a5ab0b907", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Retrieve EWMA glue averages\n  const double fast_glue_ewma = AVERAGE (fast_glue);\n  const double slow_glue_ewma = AVERAGE (slow_glue);\n\n  // Retrieve EWMA decision rate\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n\n  // Retrieve and update previous decision rate EWMA (stored in solver)\n  double prev_decision_rate_ewma = solver->prev_decision_rate_ewma;\n\n  // Compute margins\n  const double glue_margin = 0.98 * slow_glue_ewma;\n  const double decision_rate_margin = 0.85 * prev_decision_rate_ewma;\n\n  bool glue_trigger = (fast_glue_ewma >= glue_margin);\n  bool decision_rate_trigger = (decision_rate_ewma < decision_rate_margin);\n\n  // Verbose logging\n  kissat_extremely_verbose (solver,\n    \"hybrid restart: fast_glue_ewma=%.2f, slow_glue_ewma=%.2f, glue_margin=%.2f, \"\n    \"decision_rate_ewma=%.6f, prev_decision_rate_ewma=%.6f, decision_rate_margin=%.6f, \"\n    \"glue_trigger=%d, decision_rate_trigger=%d\",\n    fast_glue_ewma, slow_glue_ewma, glue_margin,\n    decision_rate_ewma, prev_decision_rate_ewma, decision_rate_margin,\n    glue_trigger, decision_rate_trigger);\n\n  // If either trigger is true, restart\n  if (glue_trigger || decision_rate_trigger) {\n    // Update prev_decision_rate_ewma after each check\n    solver->prev_decision_rate_ewma = decision_rate_ewma;\n    return true;\n  }\n\n  // Update prev_decision_rate_ewma even if not restarting\n  solver->prev_decision_rate_ewma = decision_rate_ewma;\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 486, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1126}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692138b77874819085560edbe6480346", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "16994be09b3c398a136256d2276ae6c0", "body": {"id": "resp_08d1729819b2a1e400692138b2ca988193b108067bd5b6855e", "object": "response", "created_at": 1763784882, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08d1729819b2a1e400692138b30ae88193bc5a562a1b61a795", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // EWMA glue values\n  const double fast_glue_ewma = AVERAGE (fast_glue);\n  const double slow_glue_ewma = AVERAGE (slow_glue);\n\n  // EWMA decision rate\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n  double prev_decision_rate_ewma = solver->prev_decision_rate_ewma;\n\n  // First restart condition: glue-drop\n  bool glue_restart = (fast_glue_ewma >= 0.98 * slow_glue_ewma);\n\n  // Second restart condition: adaptive decision rate\n  bool decision_rate_restart = (decision_rate_ewma < 0.85 * prev_decision_rate_ewma);\n\n  // Tie-breaking: prioritize glue condition\n  bool restart = glue_restart || decision_rate_restart;\n\n  if (restart) {\n    if (decision_rate_restart || glue_restart) {\n      // Update prev_decision_rate_ewma AFTER check\n      solver->prev_decision_rate_ewma = decision_rate_ewma;\n    }\n    kissat_extremely_verbose (\n      solver,\n      \"hybrid glue-drop/adaptive restart: fast glue ewma %.2f, slow glue ewma %.2f, \"\n      \"decision rate ewma %.4f, prev_decision_rate_ewma %.4f, \"\n      \"glue_restart %d, decision_rate_restart %d\",\n      fast_glue_ewma, slow_glue_ewma,\n      decision_rate_ewma, prev_decision_rate_ewma,\n      glue_restart, decision_rate_restart\n    );\n    return true;\n  }\n\n  // Update prev_decision_rate_ewma only when a restart is considered\n  // (already updated above if triggered)\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 443, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1083}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692138b77b5c8190b81d8c862820fdfe", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "b893122c5ae78e3751655bf98048fbd3", "body": {"id": "resp_0d503e42cb69f26600692138b2c22081948a54d2c7cab993df", "object": "response", "created_at": 1763784882, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0d503e42cb69f26600692138b3151c8194862f0282ef290a83", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Retrieve EWMA of fast and slow glue\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Retrieve EWMA of decision rate\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Use previous decision rate from solver struct\n  double prev_decision_rate = solver->prev_decision_rate_ewma;\n\n  // Compute thresholds\n  const double glue_margin = 0.98 * slow;\n  const double decision_margin = 0.85 * prev_decision_rate;\n\n  // Condition 1: fast glue EWMA >= 0.98 * slow glue EWMA\n  const bool glue_condition = (fast >= glue_margin);\n\n  // Condition 2: decision rate EWMA < 0.85 * prev_decision_rate_ewma\n  const bool decision_condition = (decision_rate < decision_margin);\n\n  if (glue_condition || decision_condition) {\n    kissat_extremely_verbose (\n      solver,\n      \"hybrid restart trigger: fast_glue_ewma %.2f %s 0.98*slow_glue_ewma %.2f, \"\n      \"decision_rate_ewma %.4f %s 0.85*prev_decision_rate_ewma %.4f\",\n      fast, glue_condition ? \">=\" : \"<\", glue_margin,\n      decision_rate, decision_condition ? \"<\" : \">=\", decision_margin\n    );\n\n    // Update prev_decision_rate_ewma after check, as per algorithm\n    solver->prev_decision_rate_ewma = decision_rate;\n\n    return true;\n  }\n\n  // Update prev_decision_rate_ewma even if no restart (to prevent staleness)\n  solver->prev_decision_rate_ewma = decision_rate;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 449, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1089}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692138b77b248190975fcc5068365277", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "441ee8c915451e6372805b58723f7d6a", "body": {"id": "resp_097376ea3a99148b00692138770f94819594092e7abf7d2be6", "object": "response", "created_at": 1763784823, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_097376ea3a99148b00692138777090819598e89d5b91c2412c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // EWMA for glue\n  const double fast_glue_ewma = AVERAGE(fast_glue);\n  const double slow_glue_ewma = AVERAGE(slow_glue);\n\n  // EWMA for decision rate\n  const double decision_rate_ewma = AVERAGE(decision_rate);\n  double prev_decision_rate_ewma = solver->prev_decision_rate_ewma;\n\n  // Triggers\n  const double glue_margin = 0.98;\n  const double decision_drop = 0.85;\n\n  bool glue_trigger = (fast_glue_ewma >= glue_margin * slow_glue_ewma);\n  bool decision_trigger = (decision_rate_ewma < decision_drop * prev_decision_rate_ewma);\n\n  // Tie-breaking: prioritize glue-trigger\n  bool restart = false;\n  if (glue_trigger || decision_trigger) {\n    restart = true;\n    solver->prev_decision_rate_ewma = decision_rate_ewma;\n  }\n\n  kissat_extremely_verbose(\n    solver,\n    \"hybrid glue/decision restart: fast_glue_ewma %.4f, slow_glue_ewma %.4f, decision_rate_ewma %.4f, prev_decision_rate_ewma %.4f, glue_trigger %d, decision_trigger %d, restart %d\",\n    fast_glue_ewma, slow_glue_ewma,\n    decision_rate_ewma, prev_decision_rate_ewma,\n    glue_trigger, decision_trigger, restart);\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 394, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1034}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692138b77e808190b434d4372acea086", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "79e13015057419e1e9f0ce68f04ac931", "body": {"id": "resp_0512afae58c18447006921387a6468819399f87ff70d6a05b9", "object": "response", "created_at": 1763784826, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0512afae58c18447006921387af19081939c21ef58b0b474b6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Get EWMA values for fast and slow glue.\n  const double fast_glue_ewma = AVERAGE(fast_glue);\n  const double slow_glue_ewma = AVERAGE(slow_glue);\n\n  // Compute threshold for glue.\n  const double glue_threshold = 0.98 * slow_glue_ewma;\n\n  // Decision rate EWMA (assigned variables per conflict)\n  const double decision_rate_ewma = solver->decision_rate_ewma;\n  double prev_decision_rate_ewma = solver->prev_decision_rate_ewma;\n\n  // Compute threshold for decision rate.\n  const double decision_rate_threshold = 0.85 * prev_decision_rate_ewma;\n\n  bool triggered = false;\n\n  if (fast_glue_ewma >= glue_threshold) {\n    kissat_extremely_verbose(\n        solver,\n        \"hybrid glue-drop: fast_glue_ewma %.6f >= %.6f (0.98 * slow_glue_ewma %.6f) [RESTART]\",\n        fast_glue_ewma, glue_threshold, slow_glue_ewma);\n    triggered = true;\n  } else if (decision_rate_ewma < decision_rate_threshold) {\n    kissat_extremely_verbose(\n        solver,\n        \"hybrid adaptive: decision_rate_ewma %.6f < %.6f (0.85 * prev_decision_rate_ewma %.6f) [RESTART]\",\n        decision_rate_ewma, decision_rate_threshold, prev_decision_rate_ewma);\n    triggered = true;\n  }\n\n  // Always update prev_decision_rate_ewma after check.\n  solver->prev_decision_rate_ewma = decision_rate_ewma;\n\n  return triggered;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 435, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1075}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692138b778e08190ae67ee1c974d4396", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "ba0ee9a48fb71e45bea922228e68cf27", "body": {"id": "resp_07ffbaff2477a0490069213877177c8194bb5d486c51cc6ece", "object": "response", "created_at": 1763784823, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_07ffbaff2477a04900692138778c408194991638b90b39e221", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  const double fast_glue_ewma = AVERAGE (fast_glue);\n  const double slow_glue_ewma = AVERAGE (slow_glue);\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n  double prev_decision_rate_ewma = solver->prev_decision_rate_ewma;\n\n  const double glue_margin = 0.98;\n  const double rate_margin = 0.85;\n\n  bool glue_trigger = (fast_glue_ewma >= glue_margin * slow_glue_ewma);\n  bool rate_trigger = (decision_rate_ewma < rate_margin * prev_decision_rate_ewma);\n\n  kissat_extremely_verbose (solver,\n    \"restart hybrid check: fast_glue_ewma=%g slow_glue_ewma=%g \" \n    \"decision_rate_ewma=%g prev_decision_rate_ewma=%g \"\n    \"glue_trigger=%d rate_trigger=%d\",\n    fast_glue_ewma, slow_glue_ewma, decision_rate_ewma, prev_decision_rate_ewma,\n    glue_trigger, rate_trigger);\n\n  if (glue_trigger || rate_trigger) {\n    // Tie-breaking: if both, glue_trigger takes priority, but only one restart occurs.\n    solver->prev_decision_rate_ewma = decision_rate_ewma;\n    return true;\n  }\n\n  solver->prev_decision_rate_ewma = decision_rate_ewma;\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 383, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1023}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692138b784788190901d3a088a40432b", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "c89f98ad4e84845bac8a764f5d22a00b", "body": {"id": "resp_03e87104d7c78153006921387eb800819795aeb0edce552462", "object": "response", "created_at": 1763784830, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_03e87104d7c78153006921387f0d348197982d9e9eba471b37", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // EWMA values for glue (LBD)\n  const double fast_glue_ewma = AVERAGE (fast_glue);\n  const double slow_glue_ewma = AVERAGE (slow_glue);\n\n  // Compute decision rate EWMA: number of decisions per conflict\n  // The EWMA for decision rate should be maintained elsewhere in Kissat\n  // Here, we assume solver->decision_rate_ewma and solver->prev_decision_rate_ewma are available\n  // If not, they need to be added to the solver struct and updated appropriately elsewhere\n\n  const double decision_rate_ewma = solver->decision_rate_ewma;\n  const double prev_decision_rate_ewma = solver->prev_decision_rate_ewma;\n\n  bool glue_condition = (fast_glue_ewma >= 0.98 * slow_glue_ewma);\n  bool decision_condition = (decision_rate_ewma < 0.85 * prev_decision_rate_ewma);\n\n  // Tie-breaking: if both, prioritize glue condition\n  bool restart = false;\n  if (glue_condition)\n    restart = true;\n  else if (decision_condition)\n    restart = true;\n  else\n    restart = false;\n\n  kissat_extremely_verbose (solver,\n    \"hybrid EWMA restart: fast_glue=%.3f slow_glue=%.3f \"\n    \"decision_rate=%.4f prev_decision_rate=%.4f \"\n    \"trigger=%s\",\n    fast_glue_ewma, slow_glue_ewma,\n    decision_rate_ewma, prev_decision_rate_ewma,\n    restart ? \"YES\" : \"no\");\n\n  // After checking, update prev_decision_rate_ewma\n  solver->prev_decision_rate_ewma = decision_rate_ewma;\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 459, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1099}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692138b77bdc8190aff5702dd15e79ae", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "f7c5316386690ae48a1f4a8ce33b9a72", "body": {"id": "resp_0079926a9324550400692138b2e34c819394f1a64c175d86e3", "object": "response", "created_at": 1763784882, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0079926a9324550400692138b373c08193aeeb8470751513d3", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Get EWMA averages for fast and slow glue\n  const double fast_glue_ewma = AVERAGE (fast_glue);\n  const double slow_glue_ewma = AVERAGE (slow_glue);\n\n  // Decision rate and its EWMA\n  const double decision_rate_ewma = solver->averages.decision_rate;\n  double *prev_decision_rate_ewma_ptr = &solver->averages.prev_decision_rate;\n  const double prev_decision_rate_ewma = *prev_decision_rate_ewma_ptr;\n\n  const double glue_margin = 0.98;\n  const double decision_rate_factor = 0.85;\n\n  bool glue_trigger = (fast_glue_ewma >= glue_margin * slow_glue_ewma);\n  bool decision_trigger = (decision_rate_ewma < decision_rate_factor * prev_decision_rate_ewma);\n\n  // For extremely verbose logging\n  kissat_extremely_verbose (\n    solver,\n    \"restart check: fast_glue_ewma = %g, slow_glue_ewma = %g, \"\n    \"decision_rate_ewma = %g, prev_decision_rate_ewma = %g, \"\n    \"glue_trigger %d, decision_trigger %d\",\n    fast_glue_ewma, slow_glue_ewma,\n    decision_rate_ewma, prev_decision_rate_ewma,\n    glue_trigger, decision_trigger);\n\n  bool should_restart = false;\n\n  if (glue_trigger) {\n    should_restart = true;\n    // Tie-breaking: prioritize glue_trigger\n  } else if (decision_trigger) {\n    should_restart = true;\n  }\n\n  // Update prev_decision_rate_ewma after each check\n  *prev_decision_rate_ewma_ptr = decision_rate_ewma;\n\n  return should_restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 455, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1095}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692138b77dfc819095b049a9c0e1ee92", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "dbb7c7d7aa06b04ecc5a3636927947ef", "body": {"id": "resp_0c35f3a6c4d6ae870069213877131081978ee3cbf4f8081bfa", "object": "response", "created_at": 1763784823, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0c35f3a6c4d6ae8700692138777e948197a571def02c1f324c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // EWMA glue values\n  const double fast_glue_ewma = AVERAGE (fast_glue);\n  const double slow_glue_ewma = AVERAGE (slow_glue);\n\n  // Decision rate EWMA: should be maintained in solver->decision_rate_ewma\n  // prev_decision_rate_ewma should be a mutable field in the solver struct\n  const double decision_rate_ewma = solver->decision_rate_ewma;\n  double prev_decision_rate_ewma = solver->prev_decision_rate_ewma;\n\n  // Compute restart conditions\n  const double glue_margin = 0.98;\n  const double decision_rate_factor = 0.85;\n\n  bool glue_trigger = (fast_glue_ewma >= glue_margin * slow_glue_ewma);\n  bool decision_rate_trigger = (decision_rate_ewma < decision_rate_factor * prev_decision_rate_ewma);\n\n  kissat_extremely_verbose (\n    solver,\n    \"hybrid glue/decision restart: fast_glue_ewma = %g, slow_glue_ewma = %g, \"\n    \"decision_rate_ewma = %g, prev_decision_rate_ewma = %g, glue_trigger = %d, decision_rate_trigger = %d\",\n    fast_glue_ewma, slow_glue_ewma,\n    decision_rate_ewma, prev_decision_rate_ewma,\n    glue_trigger, decision_rate_trigger\n  );\n\n  // If either condition triggers, restart (prioritize glue_trigger for verbosity)\n  bool restart = false;\n  if (glue_trigger)\n  {\n    kissat_extremely_verbose (solver,\n      \"restarting: triggered by glue condition (fast_glue_ewma >= 0.98 * slow_glue_ewma)\");\n    restart = true;\n  }\n  else if (decision_rate_trigger)\n  {\n    kissat_extremely_verbose (solver,\n      \"restarting: triggered by adaptive decision rate (decision_rate_ewma < 0.85 * prev_decision_rate_ewma)\");\n    restart = true;\n  }\n\n  // Update prev_decision_rate_ewma after each check, regardless of restart\n  solver->prev_decision_rate_ewma = decision_rate_ewma;\n\n  return restart;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 640, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 550, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1190}, "user": null, "metadata": {}}}, "error": null}
