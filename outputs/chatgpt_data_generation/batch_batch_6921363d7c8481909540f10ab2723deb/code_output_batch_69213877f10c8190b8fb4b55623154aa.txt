{"id": "batch_req_69213c4bfa108190a80ad456c579da28", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "3f95bdeba72294b5d32beae2965f8f12", "body": {"id": "resp_0c7a6398f024e295006921387c712c8197be2b48ce6710dc85", "object": "response", "created_at": 1763784828, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0c7a6398f024e295006921387ccd588197bab370e3f885deef", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    ; // do not return, see tie-breaking\n\n  // Compute EWMA values\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Decision rate EWMA: average decisions per conflict (updated elsewhere)\n  // Use most recent and previous values as tracked in solver\n  const double decision_rate_ewma = solver->averages.decision_rate;\n  const double previous_decision_rate_ewma = solver->averages.previous_decision_rate;\n\n  // Compute glue and decision rate thresholds\n  const double glue_threshold = 0.85 * slow_glue;\n  const double decision_rate_threshold = 0.95 * previous_decision_rate_ewma;\n\n  // Two restart triggers (dual-threshold):\n  bool glue_decision_trigger =\n    (fast_glue > glue_threshold) && (decision_rate_ewma < decision_rate_threshold);\n\n  bool conflicts_trigger =\n    (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // If both triggers fire, prioritize conflicts_trigger (tie-breaking)\n  if (conflicts_trigger) {\n    kissat_extremely_verbose(\n      solver,\n      \"restarting: conflict trigger (conflicts = %ld, limit = %ld)\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    solver->averages.previous_decision_rate = decision_rate_ewma;\n    return true;\n  }\n\n  // Only trigger glue/decision restart in unstable mode (stable==false)\n  if (glue_decision_trigger && !solver->stable) {\n    kissat_extremely_verbose(\n      solver,\n      \"restarting: dual-threshold trigger (fast_glue = %.2f > 0.85*slow_glue = %.2f, decision_rate = %.4f < 0.95*prev = %.4f)\",\n      fast_glue, glue_threshold, decision_rate_ewma, decision_rate_threshold);\n    solver->averages.previous_decision_rate = decision_rate_ewma;\n    return true;\n  }\n\n  // No restart\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 501, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1131}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c4c05a48190803352bc1b00c15e", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "c0a73d0d4fe4efee2c9301fb5adf021c", "body": {"id": "resp_01aa66186ea620ee0069213880cdfc81909553bc523d977638", "object": "response", "created_at": 1763784832, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_01aa66186ea620ee006921388114e08190adff25dd67576c20", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-based restart trigger (always highest priority)\n  if (CONFLICTS >= solver->limits.restart.conflicts) {\n    return true;\n  }\n\n  // Only apply glue/decision-rate restart in unstable mode\n  if (solver->stable)\n    return false;\n\n  // EWMA averages for fast and slow glue\n  const double fast_glue_ewma = AVERAGE (fast_glue);\n  const double slow_glue_ewma = AVERAGE (slow_glue);\n\n  // EWMA for decision rate (decisions per unit time, as maintained by kissat)\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n  const double previous_decision_rate_ewma = solver->previous_decision_rate_ewma;\n\n  // Conditions according to Dual-Threshold Glue-Decision Adaptive Restart\n  const bool glue_condition = (fast_glue_ewma > 0.85 * slow_glue_ewma);\n  const bool decision_condition = (decision_rate_ewma < 0.95 * previous_decision_rate_ewma);\n\n  kissat_extremely_verbose (\n    solver,\n    \"dual-threshold restart: fast_glue=%.2f slow_glue=%.2f (0.85*slow=%.2f) glue_cond=%d, \"\n    \"decision_rate=%.4f prev_decision_rate=%.4f (0.95*prev=%.4f) dec_cond=%d\",\n    fast_glue_ewma, slow_glue_ewma, 0.85 * slow_glue_ewma, glue_condition,\n    decision_rate_ewma, previous_decision_rate_ewma, 0.95 * previous_decision_rate_ewma, decision_condition\n  );\n\n  if (glue_condition && decision_condition) {\n    // After restart, update previous_decision_rate_ewma to current\n    solver->previous_decision_rate_ewma = decision_rate_ewma;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 474, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1104}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c4bfe8c8190bf4209c2449d3ad6", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "b02f560426e373117bfbcb79a122c7d7", "body": {"id": "resp_0ea4c2c63bb074160069213884c5588190a507032edaf9fce4", "object": "response", "created_at": 1763784836, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0ea4c2c63bb07416006921388550008190bcbc62a1c445546e", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // 1. Conflict-based hard restart limit\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Only apply dual-threshold glue-decision heuristic in unstable mode\n  if (!solver->stable) {\n    // EWMA for glue\n    const double fast_glue_ewma = AVERAGE(fast_glue);\n    const double slow_glue_ewma = AVERAGE(slow_glue);\n\n    // Decision rate EWMA: (recent decisions per conflict)\n    const double decision_rate_ewma = solver->averages.decision_rate;\n    const double previous_decision_rate_ewma = solver->averages.previous_decision_rate;\n\n    // Heuristic thresholds\n    const double glue_margin = 0.85;\n    const double decision_margin = 0.95;\n\n    const bool glue_trigger = (fast_glue_ewma > glue_margin * slow_glue_ewma);\n    const bool decision_trigger = (decision_rate_ewma < decision_margin * previous_decision_rate_ewma);\n\n    kissat_extremely_verbose(\n      solver,\n      \"dual-threshold glue-decision heuristic: \"\n      \"fast_glue_ewma = %.2f, slow_glue_ewma = %.2f, \"\n      \"decision_rate_ewma = %.2f, prev_decision_rate_ewma = %.2f, \"\n      \"glue_trigger = %d, decision_trigger = %d\",\n      fast_glue_ewma, slow_glue_ewma,\n      decision_rate_ewma, previous_decision_rate_ewma,\n      glue_trigger, decision_trigger\n    );\n\n    // 2. Dual-threshold: both glue and decision triggers must fire\n    if (glue_trigger && decision_trigger)\n      return true;\n  }\n\n  // In stable mode, only allow reluctant restarts\n  if (solver->stable)\n    return kissat_reluctant_triggered(&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 468, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1098}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c4c05708190ad5d6954251cb418", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "e2eb27d94dd53b97456aa840ef6e4071", "body": {"id": "resp_000b96b92c5b8ce7006921388905c08193bd49a3078cf06829", "object": "response", "created_at": 1763784841, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_000b96b92c5b8ce700692138899fdc8193b8ae0be9a4d13c1d", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Trigger 1: Conflict limit\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Only allow algorithm in unstable mode\n  if (solver->stable)\n    return false;\n\n  // EWMA of glue\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // EWMA of decision rate\n  const double decision_rate = AVERAGE (decision_rate);\n  const double previous_decision_rate = solver->previous_decision_rate_ewma;\n\n  // Thresholds\n  const double glue_threshold = 0.85 * slow_glue;\n  const double decision_rate_threshold = 0.95 * previous_decision_rate;\n\n  // Main trigger: Dual-threshold\n  if (fast_glue > glue_threshold && decision_rate < decision_rate_threshold)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 245, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 875}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c4c13ac8190b025525f36ae70e5", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "2a3197cb7a91e5dcc2a63956e7251542", "body": {"id": "resp_001062f2f46dc6a2006921388d6a5481938421b2aa07ee634d", "object": "response", "created_at": 1763784845, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_001062f2f46dc6a2006921388e49f4819386f1eb067c94b363", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  // Option: check if restarts are enabled\n  if (!GET_OPTION (restart))\n    return false;\n\n  // Only consider non-root level\n  if (!solver->level)\n    return false;\n\n  // Conflict-based restart: highest priority\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Only perform adaptive glue/decision-based restart in unstable mode\n  if (solver->stable)\n    return false;\n\n  // Compute fast and slow glue averages\n  const double fast_glue_ewma = AVERAGE (fast_glue);\n  const double slow_glue_ewma = AVERAGE (slow_glue);\n\n  // Compute decision rate EWMA and previous value\n  // decision_rate_ewma: moving average of decisions per conflict\n  // These are assumed to be updated elsewhere per conflict\n  const double decision_rate_ewma = solver->decision_rate_ewma;\n  const double prev_decision_rate_ewma = solver->prev_decision_rate_ewma;\n\n  // Dual-threshold: glue and decision rate\n  const double glue_threshold = 0.85 * slow_glue_ewma;\n  const double decision_rate_threshold = 0.95 * prev_decision_rate_ewma;\n\n  // Check dual-threshold condition\n  bool glue_cond = fast_glue_ewma > glue_threshold;\n  bool decision_cond = decision_rate_ewma < decision_rate_threshold;\n\n  kissat_extremely_verbose (solver,\n    \"dual-threshold restart: \"\n    \"fast_glue_ewma=%g, slow_glue_ewma=%g, glue_thr=%.3f (%.3f > %.3f=%c), \"\n    \"decision_rate_ewma=%g, prev_decision_rate_ewma=%g, dec_thr=%.3f (%.3f < %.3f=%c)\",\n    fast_glue_ewma, slow_glue_ewma, glue_threshold,\n    fast_glue_ewma, glue_threshold, (fast_glue_ewma > glue_threshold ? 'T' : 'F'),\n    decision_rate_ewma, prev_decision_rate_ewma, decision_rate_threshold,\n    decision_rate_ewma, decision_rate_threshold, (decision_rate_ewma < decision_rate_threshold ? 'T' : 'F'));\n\n  if (glue_cond && decision_cond)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 535, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1165}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c4c05388190af1ef0ecf5749b1c", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "a09e005a4902a85ec31e3b7b57858d2d", "body": {"id": "resp_00e37ee1e8ce79320069213894d92c8190b60acbbf88ec8ad8", "object": "response", "created_at": 1763784852, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_00e37ee1e8ce793200692138953c088190a6138edd65f2b2c6", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Dual-Threshold Glue-Decision Adaptive Restart\n    // -- Conflict limit trigger (highest priority)\n    if (CONFLICTS >= solver->limits.restart.conflicts) {\n        return true;\n    }\n\n    // -- Only check glue/decision heuristics in unstable mode\n    if (solver->stable)\n        return false;\n\n    // EWMA glue statistics\n    const double fast_glue = AVERAGE(fast_glue);\n    const double slow_glue = AVERAGE(slow_glue);\n\n    // Decision rate EWMA statistics\n    const double decision_rate = AVERAGE(decision_rate);\n    const double prev_decision_rate = solver->previous_decision_rate_ewma;\n\n    // Check glue threshold: fast_glue > 0.85 * slow_glue\n    const double glue_threshold = 0.85 * slow_glue;\n\n    // Check decision rate threshold: decision_rate < 0.95 * prev_decision_rate\n    const double decision_rate_threshold = 0.95 * prev_decision_rate;\n\n    bool glue_trigger = (fast_glue > glue_threshold);\n    bool decision_rate_trigger = (decision_rate < decision_rate_threshold);\n\n    if (glue_trigger && decision_rate_trigger) {\n        // After a restart, update previous_decision_rate_ewma with current value\n        solver->previous_decision_rate_ewma = decision_rate;\n        return true;\n    }\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 345, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 975}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c4c04f881909a77abede1e838c4", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "addca847dd58e57e43dffdcb5a991285", "body": {"id": "resp_0975ba73c581b39600692138989fa881969d9ce6414ce8917a", "object": "response", "created_at": 1763784856, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0975ba73c581b3960069213899165081969470a1aae5afe423", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Always trigger restart if conflict limit is reached\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Only use this adaptive heuristic in non-stable (focused) mode\n  if (solver->stable)\n    return false;\n\n  // Get EWMA values for glue and decision rate\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Decision rate = decisions/conflicts; EWMA is tracked across search\n  const double decision_rate = AVERAGE(decision_rate);\n  const double prev_decision_rate = solver->previous_decision_rate_ewma;\n\n  // Check glue and decision rate conditions\n  const double glue_threshold = 0.85 * slow_glue;\n  const double decision_rate_threshold = 0.95 * prev_decision_rate;\n\n  const bool glue_trigger = (fast_glue > glue_threshold);\n  const bool decision_rate_trigger = (decision_rate < decision_rate_threshold);\n\n  // If both glue and decision rate thresholds are met, trigger restart\n  if (glue_trigger && decision_rate_trigger) {\n    kissat_extremely_verbose(\n      solver,\n      \"adaptive restart triggered: fast_glue_ewma %.2f > 0.85*slow_glue_ewma %.2f, \"\n      \"decision_rate_ewma %.2f < 0.95*prev_decision_rate_ewma %.2f\",\n      fast_glue, glue_threshold, decision_rate, decision_rate_threshold);\n    // Update previous_decision_rate_ewma after restart\n    solver->previous_decision_rate_ewma = decision_rate;\n    return true;\n  }\n\n  // If none of the above, do not restart\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 425, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1055}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c4bfde48190b355347b79b86604", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "5b2a21bc7196a00c791ae3867e47c90d", "body": {"id": "resp_036fe77d7141ebd6006921389c5bb081969f866ec3fd300c94", "object": "response", "created_at": 1763784860, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_036fe77d7141ebd6006921389c990481968f007b55332e057c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // --- Dual-Threshold Glue-Decision Adaptive Restart algorithm ---\n\n  // Conflict-based hard limit (as in specification and tie-breaking)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Only allow glue/decision rate-based restart in unstable mode\n  if (solver->stable)\n    return false;\n\n  // Compute EWMA values\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Decision rate EWMA tracking\n  const double decision_rate_ewma = AVERAGE(decision_rate);\n  const double prev_decision_rate_ewma = solver->previous_decision_rate_ewma;\n\n  // Dual-threshold: glue and decision rate\n  const double glue_threshold = 0.85 * slow_glue;\n  const double decision_rate_threshold = 0.95 * prev_decision_rate_ewma;\n\n  bool glue_condition = (fast_glue > glue_threshold);\n  bool decision_condition = (decision_rate_ewma < decision_rate_threshold);\n\n  // Verbose printing for debugging and transparency\n  kissat_extremely_verbose(\n    solver,\n    \"dual-threshold adaptive restart: fast_glue=%.2f slow_glue=%.2f (threshold=%.2f) decision_rate=%.4f previous=%.4f (threshold=%.4f)\",\n    fast_glue, slow_glue, glue_threshold, decision_rate_ewma, prev_decision_rate_ewma, decision_rate_threshold\n  );\n\n  if (glue_condition && decision_condition) {\n    // Update previous_decision_rate_ewma for next comparison (after restart)\n    solver->previous_decision_rate_ewma = decision_rate_ewma;\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 433, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1063}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c4c8968819092cc1e606ede9075", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "c97e5a0097caff722961efb18b4c2e88", "body": {"id": "resp_0319aa9326e1714700692138a21abc8196b1f8684d0868b2e2", "object": "response", "created_at": 1763784866, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0319aa9326e1714700692138a28bfc8196ad5840bd88fe276e", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict-limit trigger\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Only apply dual-threshold glue-decision adaptive restart in unstable mode\n  if (solver->stable)\n    return false;\n\n  // EWMA values for glue and decision rate\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n  const double prev_decision_rate_ewma = solver->previous_decision_rate_ewma;\n\n  // Glue threshold\n  const double glue_limit = 0.85 * slow_glue;\n\n  bool glue_trigger = (fast_glue > glue_limit);\n  bool decision_trigger = (decision_rate_ewma < 0.95 * prev_decision_rate_ewma);\n\n  // Main dual-threshold trigger\n  if (glue_trigger && decision_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 264, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 894}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c4bfe4c81908a6f8ca2c64aec40", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "ec90d132417fdc683c584aaceebd22b5", "body": {"id": "resp_03c7234b9d0e14af0069213c47aee08197a6ad01cfbcd3b20f", "object": "response", "created_at": 1763785799, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_03c7234b9d0e14af0069213c4818e881979ba10cfb6c407bc9", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Dual-Threshold Glue-Decision Adaptive Restart\n\n  // Condition 1: stats.conflicts >= restart_conflict_limit\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true; // Tie-breaker: prioritize this condition\n\n  // Only consider the glue/decision rate heuristic if in unstable mode\n  if (!solver->stable) {\n    // EWMA of glue\n    const double fast = AVERAGE(fast_glue);\n    const double slow = AVERAGE(slow_glue);\n\n    // Decision rate EWMA (decisions per conflict or other Kissat metric)\n    const double decision_rate = AVERAGE(decision_rate);\n    const double prev_decision_rate = solver->previous_decision_rate_ewma;\n\n    // Compute thresholds\n    const double glue_threshold = 0.85 * slow;\n    const double decision_rate_threshold = 0.95 * prev_decision_rate;\n\n    bool glue_condition = (fast > glue_threshold);\n    bool decision_condition = (decision_rate < decision_rate_threshold);\n\n    kissat_extremely_verbose(solver,\n      \"dual-threshold restart: fast_glue=%.2f slow_glue=%.2f (threshold=%.2f) \"\n      \"decision_rate=%.2f (threshold=%.2f, prev=%.2f) glue_cond=%d dec_cond=%d\",\n      fast, slow, glue_threshold,\n      decision_rate, decision_rate_threshold, prev_decision_rate,\n      glue_condition, decision_condition);\n\n    if (glue_condition && decision_condition) {\n      // After restart, update previous_decision_rate_ewma\n      solver->previous_decision_rate_ewma = decision_rate;\n      return true;\n    }\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 630, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 413, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1043}, "user": null, "metadata": {}}}, "error": null}
