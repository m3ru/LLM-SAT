{"id": "batch_req_69213c95e57081908e07b63bffc6971c", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "f1ee74d89e9a0f84c6c04133eb26d2d1", "body": {"id": "resp_06e7aa00c65a8e450069213c483080819aa882dd91cdeb82c8", "object": "response", "created_at": 1763785800, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_06e7aa00c65a8e450069213c48a260819aa50e6242877adc6a", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // 1. Conflict budget check (always required, fallback trigger)\n    if (CONFLICTS < solver->limits.restart.conflicts)\n        return false;\n\n    // Fetch EWMA values\n    const double fast_glue = AVERAGE(fast_glue);\n    const double slow_glue = AVERAGE(slow_glue);\n\n    // Decision rate EWMA and median\n    const double decision_rate = AVERAGE(decision_rate);\n    const double median_decision_rate = solver->median_decision_rate_ewma;\n    const bool has_median = median_decision_rate > 0.0;\n\n    bool glue_trigger = false;\n    bool decision_rate_trigger = false;\n    bool conflict_limit_trigger = false;\n\n    // 2. Glue-based trigger: fast_glue > slow_glue + 0.5\n    if (fast_glue > slow_glue + 0.5)\n        glue_trigger = true;\n\n    // 3. Decision-rate-based trigger: only if median available\n    if (has_median && decision_rate < 0.8 * median_decision_rate)\n        decision_rate_trigger = true;\n\n    // 4. Conflict limit trigger\n    if (CONFLICTS >= solver->limits.restart.conflicts)\n        conflict_limit_trigger = true;\n\n    // 5. Tie-breaking: If glue or decision triggers, restart immediately with priority\n    if (glue_trigger || decision_rate_trigger) {\n        kissat_extremely_verbose(\n            solver,\n            \"DAGR-HR: restart triggered: %s%s\"\n            \" [fast_glue=%.2f, slow_glue=%.2f, decision_rate=%.3f, median_decision_rate=%.3f]\",\n            glue_trigger ? \"glue\" : \"\",\n            (glue_trigger && decision_rate_trigger) ? \"+decision_rate\" : (decision_rate_trigger ? \"decision_rate\" : \"\"),\n            fast_glue, slow_glue, decision_rate, median_decision_rate);\n        return true;\n    }\n\n    // 6. If median unavailable, only use glue-based trigger (already done above)\n\n    // 7. If only conflict limit triggers, only restart if others did not fire\n    if (conflict_limit_trigger) {\n        kissat_extremely_verbose(\n            solver,\n            \"DAGR-HR: restart triggered by conflict limit [conflicts=%\" PRIu64 \", limit=%\" PRIu64 \"]\",\n            CONFLICTS, solver->limits.restart.conflicts);\n        return true;\n    }\n\n    // 8. If stable, also allow reluctant restarts (as in original)\n    if (solver->stable)\n        return kissat_reluctant_triggered(&solver->reluctant);\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 615, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1293}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c95e93481908a4e9353492bf00c", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "e641ef66f7a634a487a6f5ce548d1a1a", "body": {"id": "resp_05f98cc954636cae00692138abc494819ab73a6cf87f403927", "object": "response", "created_at": 1763784875, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_05f98cc954636cae00692138ac4a00819a949a214535a4c164", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // 1. Conflict limit for restart\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // EWMA values for glue\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // Decision rate EWMA\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Median decision rate EWMA (updated at each stable phase transition)\n  const double median_decision_rate = solver->median_decision_rate_ewma;\n\n  // DAGR-HR: 1. Glue trigger\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // DAGR-HR: 2. Decision rate trigger\n  bool decision_trigger = false;\n  if (median_decision_rate > 0.0)\n    decision_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // DAGR-HR: 3. Conflict limit trigger (already passed above)\n\n  // Tie-breaking: if multiple triggers, restart immediately, glue-based prioritized\n  if (glue_trigger || decision_trigger)\n    return true;\n\n  // If median unavailable, use glue only (decision_trigger always false)\n  // If only conflict trigger remains, treat as fallback\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 333, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1011}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c95ea0c8190bfaa74cdabd5d3c1", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "9be62542e04fb82f93187bc3d1701a3f", "body": {"id": "resp_0085a5e5cbdd3b5e00692138ad772081999c56385401261174", "object": "response", "created_at": 1763784877, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0085a5e5cbdd3b5e00692138adfc3881999a05d3a7493057eb", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // DAGR-HR: Glue EWMA values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // DAGR-HR: Decision rate EWMA (decisions per conflict)\n  const double decision_rate_ewma = AVERAGE (decision_rate);\n\n  // Median decision rate EWMA (updated at each stable phase, else 0.0 if never set)\n  const double median_decision_rate_ewma = solver->median_decision_rate_ewma;\n\n  // Restart conflict limit from limits\n  const uint64_t restart_conflict_limit = solver->limits.restart.conflicts;\n\n  // Track if triggers fire\n  bool glue_trigger = false, decision_rate_trigger = false, limit_trigger = false;\n\n  // (1) Glue-based trigger\n  if (fast_glue > slow_glue + 0.5)\n    glue_trigger = true;\n\n  // (2) Decision rate based, only if median is available (>0)\n  if (!glue_trigger && median_decision_rate_ewma > 0.0) {\n    if (decision_rate_ewma < 0.8 * median_decision_rate_ewma)\n      decision_rate_trigger = true;\n  }\n\n  // (3) Conflict limit trigger\n  if (!glue_trigger && !decision_rate_trigger) {\n    if (CONFLICTS >= restart_conflict_limit)\n      limit_trigger = true;\n  }\n\n  // Extremely verbose reporting\n  if (kissat_extremely_verbose_option_enabled (solver)) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR restart: glue_trigger=%d (fast_glue=%g, slow_glue=%g), \"\n      \"decision_rate_trigger=%d (decision_rate_ewma=%g, median=%g), \"\n      \"limit_trigger=%d (CONFLICTS=%\" PRIu64 \", restart_limit=%\" PRIu64 \")\",\n      glue_trigger, fast_glue, slow_glue,\n      decision_rate_trigger, decision_rate_ewma, median_decision_rate_ewma,\n      limit_trigger, CONFLICTS, restart_conflict_limit);\n  }\n\n  // (Tie-breaking): If any trigger fires, restart immediately\n  if (glue_trigger || decision_rate_trigger || limit_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 545, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1223}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c95eb208190ad37c72948b046b8", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "7f91dc11b2e3342c4dad724759ff1438", "body": {"id": "resp_096c4773ea417b7b00692138ad9338819aba81b303ed2822fa", "object": "response", "created_at": 1763784877, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_096c4773ea417b7b00692138adedf4819a945d693b5f5c9b3a", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // (3) Conflict-based limit: always available\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Glue-based values\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Glue-based trigger (1)\n  const bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // Decision-rate-based trigger (2)\n  double decision_rate_ewma = solver->decision_rate_ewma;\n  double median_decision_rate_ewma = solver->median_decision_rate_ewma;\n  bool median_available = (median_decision_rate_ewma > 0.0);\n\n  bool decision_rate_trigger = false;\n  if (median_available)\n    decision_rate_trigger = (decision_rate_ewma < 0.8 * median_decision_rate_ewma);\n\n  // Tie-breaking: If both glue and decision triggers, prefer glue (by order)\n  if (glue_trigger || decision_rate_trigger)\n    return true;\n\n  // If median is not available (e.g., first stable phase not reached), use glue only\n  // (already handled above, since glue_trigger is checked unconditionally)\n\n  // If only conflict-limit triggers, fall through here (already checked above)\n\n  // If solver is in stable mode, update median on phase transition (handled elsewhere)\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 354, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1032}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c95f58c81909123b0c92bfe6236", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "5f3629f4df0cf0f44d6dbfcf6499f77d", "body": {"id": "resp_05b045972637e77800692138a645dc8199aacf8ee24700a852", "object": "response", "created_at": 1763784870, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_05b045972637e77800692138a6c7648199b1061c4a3e083c15", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // DAGR-HR: check if restart_conflict_limit is reached\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n  {\n    // Tie-breaking: if any glue-based trigger also fires, prefer glue-based\n    const double fast_glue = AVERAGE (fast_glue);\n    const double slow_glue = AVERAGE (slow_glue);\n    if (fast_glue > slow_glue + 0.5)\n      return true;\n    // If not, still restart due to conflict limit\n    return true;\n  }\n\n  // DAGR-HR: glue-based trigger\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  if (fast_glue > slow_glue + 0.5)\n    return true;\n\n  // DAGR-HR: decision-rate trigger\n  const double decision_rate = AVERAGE (decision_rate);\n  double median_decision_rate = solver->restarting.median_decision_rate_ewma;\n\n  // If median_decision_rate_ewma is not available, skip this trigger\n  bool median_available =\n    solver->restarting.median_decision_rate_ewma_updated;\n\n  if (median_available) {\n    if (decision_rate < 0.8 * median_decision_rate)\n      return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 344, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1022}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c95ed48819083f9f2f9240012cc", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "f4ff9bd3c65c9e89177907f5e08c4224", "body": {"id": "resp_05f7149a798c6fb100692138fe3864819bad3bc606cc14b44d", "object": "response", "created_at": 1763784958, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_05f7149a798c6fb100692138fecf60819ba70d200fb1f5a1ca", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // 1. Conflict limit\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // 2. Extract averages\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // 3. DAGR-HR: Glue-based restart (trigger if fast_glue > slow_glue + 0.5)\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // 4. Decision rate-based restart\n  // (decision_rate_ewma < 0.8 \u00d7 median_decision_rate_ewma)\n  bool median_valid = solver->restarting.median_decision_rate_ewma >= 0.0;\n  double decision_rate = solver->restarting.decision_rate_ewma;\n  double median_decision_rate = solver->restarting.median_decision_rate_ewma;\n  bool drate_trigger = false;\n  if (median_valid)\n    drate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // 5. Conflict-limit based restart\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // 6. Decision: glue or decision rate triggers fire immediately, with glue-based preferred\n  if (glue_trigger) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR restart: fast_glue %.3f > slow_glue %.3f + 0.5\", fast_glue, slow_glue);\n    return true;\n  }\n  if (drate_trigger) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR restart: decision_rate_ewma %.3f < 0.8 * median_decision_rate_ewma %.3f\",\n      decision_rate, median_decision_rate);\n    return true;\n  }\n\n  // 7. If median is unavailable, only use glue-based trigger (already checked above)\n  // 8. If conflict limit reached, trigger only if glue/decision-rate triggers did not fire\n  if (conflict_trigger) {\n    kissat_extremely_verbose(solver,\n      \"DAGR-HR restart: conflicts %\" PRIu64 \" >= conflict limit %\" PRIu64,\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 559, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1237}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c95fcbc81909909ca90a00efb2a", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "b3a7e66a3d6f51a61dfe139045dc5116", "body": {"id": "resp_068cca4b24e0ea3200692138fe8e2c81989336317fb6e2639a", "object": "response", "created_at": 1763784958, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_068cca4b24e0ea3200692138fef8f481988d28786a2c0bf7ca", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Always available: glue ewmAs, conflicts, restart limit\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Keep track of median_decision_rate_ewma (updated at stable phase transitions)\n  // Assume: solver->median_decision_rate_ewma is maintained externally at phase transition\n\n  // 1. Glue-based trigger\n  bool glue_trigger = (fast > slow + 0.5);\n\n  // 2. Decision-rate trigger\n  double median_decision_rate = solver->median_decision_rate_ewma;\n  bool median_available = (median_decision_rate > 0.0);\n  bool decision_rate_trigger = false;\n  if (median_available)\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // 3. Conflict limit trigger\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Tie-breaking: prefer glue, then decision-rate, then conflict\n  if (glue_trigger) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR: glue trigger: fast_glue %.4f > slow_glue %.4f + 0.5\", fast, slow);\n    return true;\n  }\n\n  if (decision_rate_trigger) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR: decision-rate trigger: decision_rate %.4f < 0.8 * median_decision_rate %.4f\",\n      decision_rate, median_decision_rate);\n    return true;\n  }\n\n  if (conflict_trigger) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR: conflict trigger: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 464, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1142}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c95f734819099e2a94b0c80a9d5", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "8a3786c0168a13666c32eba874123cbd", "body": {"id": "resp_0c0bf12c175398350069213c8c4558819b95820ba381e96b43", "object": "response", "created_at": 1763785868, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0c0bf12c175398350069213c8d8a44819b95d84de0131486a0", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit check (always available)\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // --- DAGR-HR: (1) Glue-based trigger ---\n  bool glue_trigger = (fast > slow + 0.5);\n\n  // --- DAGR-HR: (2) Decision-rate-based trigger ---\n  double decision_rate_ewma = AVERAGE (decision_rate);\n  double median_decision_rate_ewma = solver->median_decision_rate_ewma;\n  bool has_median = (median_decision_rate_ewma > 0.0);\n  bool decision_rate_trigger = false;\n  if (has_median)\n    decision_rate_trigger = (decision_rate_ewma < 0.8 * median_decision_rate_ewma);\n\n  // --- DAGR-HR: (3) Conflict limit trigger (redundant, but required for priority) ---\n  bool conflict_limit_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // --- DAGR-HR: Tie-breaking priority ---\n  // 1. If glue or decision-rate triggers, fire immediately.\n  // 2. If both, fire, but prefer glue for logging.\n  // 3. If only conflict limit, only fire if others aren't true.\n\n  if (glue_trigger || decision_rate_trigger) {\n    if (glue_trigger)\n      kissat_extremely_verbose (solver,\n        \"DAGR-HR restart: fast_glue (%.2f) > slow_glue (%.2f) + 0.5\",\n        fast, slow);\n    else\n      kissat_extremely_verbose (solver,\n        \"DAGR-HR restart: decision_rate_ewma (%.4f) < 0.8 * median_decision_rate_ewma (%.4f)\",\n        decision_rate_ewma, median_decision_rate_ewma);\n    return true;\n  }\n\n  if (conflict_limit_trigger) {\n    kissat_extremely_verbose (solver,\n      \"DAGR-HR restart: conflict limit reached (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 545, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1223}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c95ee688190bf1563508f9043c3", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "30765f7d75fc4bdf6b518af9a4009adc", "body": {"id": "resp_0063dcaf894cacd100692139020bec819ab770d6c410945532", "object": "response", "created_at": 1763784962, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0063dcaf894cacd10069213903affc819aab1969b2c46806df", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // 1. Conflict limit check\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // 2. EWMA for glue and decision rate\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n\n  // Decision rate: EWMA (see solver->decision_rate for the variable)\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // Median decision rate EWMA: updated at phase transitions to stable\n  double median_decision_rate;\n  bool has_median_decision_rate = solver->median_decision_rate_ewma > 0.0;\n  if (has_median_decision_rate)\n    median_decision_rate = solver->median_decision_rate_ewma;\n\n  // 1. Glue-based trigger\n  bool glue_trigger = (fast_glue > slow_glue + 0.5);\n\n  // 2. Decision-rate-based trigger\n  bool decision_rate_trigger = false;\n  if (has_median_decision_rate)\n    decision_rate_trigger = (decision_rate < 0.8 * median_decision_rate);\n\n  // 3. Conflict limit trigger (already checked above, but kept for tie-breaking)\n  bool conflict_trigger = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Tie-breaking: prioritize (1) glue, then (2) decision rate, then (3) conflict\n  if (glue_trigger) {\n    kissat_extremely_verbose(solver,\n      \"restart: fast_glue %.2f > slow_glue %.2f + 0.5 (%.2f)\", \n      fast_glue, slow_glue, slow_glue + 0.5);\n    return true;\n  }\n\n  if (decision_rate_trigger) {\n    kissat_extremely_verbose(solver,\n      \"restart: decision_rate %.4f < 0.8 * median_decision_rate %.4f = %.4f\",\n      decision_rate, has_median_decision_rate ? median_decision_rate : 0.0,\n      has_median_decision_rate ? 0.8 * median_decision_rate : 0.0);\n    return true;\n  }\n\n  if (conflict_trigger) {\n    kissat_extremely_verbose(solver,\n      \"restart: conflicts %ld >= restart_conflict_limit %ld\",\n      (long)CONFLICTS, (long)solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 580, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1258}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_69213c95eadc8190b912f0ff6adaa13b", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "19f2700feff818644dfe17cc389d24fb", "body": {"id": "resp_0232e1d1f029946c00692138a66024819bb2901d4b82a96fa5", "object": "response", "created_at": 1763784870, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0232e1d1f029946c00692138a6d8f8819ba9dc46ae6e3a6e3f", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // --- DAGR-HR algorithm implementation ---\n\n  // Gather EWMA values\n  const double fast = AVERAGE (fast_glue);\n  const double slow = AVERAGE (slow_glue);\n\n  // Decision rate EWMA\n  const double decision_ewma = AVERAGE (decision_rate);\n\n  // Median decision rate EWMA (updated at phase transitions)\n  const double median_decision_ewma = solver->median_decision_rate_ewma;\n\n  // Restart conflict limit\n  const uint64_t limit_conflicts = solver->limits.restart.conflicts;\n\n  // Glue-based trigger: fast_glue > slow_glue + 0.5\n  const bool glue_trigger = (fast > slow + 0.5);\n\n  // Decision rate trigger: decision_rate < 0.8 * median_decision_rate\n  bool median_available = (median_decision_ewma > 0.0);\n  bool decision_trigger = false;\n  if (median_available)\n    decision_trigger = (decision_ewma < 0.8 * median_decision_ewma);\n\n  // Conflict-based trigger: conflicts >= restart_conflict_limit\n  const bool conflict_trigger = (CONFLICTS >= limit_conflicts);\n\n  // Logging for debug and verbosity\n  kissat_extremely_verbose (solver,\n    \"dagr-hr: fast_glue=%.4g slow_glue=%.4g median_decision_ewma=%.4g \"\n    \"decision_ewma=%.4g glue_trigger=%d decision_trigger=%d conflict_trigger=%d\",\n    fast, slow, median_decision_ewma, decision_ewma,\n    glue_trigger, decision_trigger, conflict_trigger);\n\n  // Tie-breaking: prefer glue/decision triggers over conflict limit\n  if (glue_trigger || decision_trigger)\n    return true;\n\n  if (conflict_trigger)\n    return true;\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 678, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 467, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1145}, "user": null, "metadata": {}}}, "error": null}
