{"id": "batch_req_692225dc51108190977f0c7720962e99", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "28db0642dc759b34b25130102086ad70", "body": {"id": "resp_01846cb3e253ba6c00692225d6279c81a1bab724e1e349829c", "object": "response", "created_at": 1763845590, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_01846cb3e253ba6c00692225d66e4881a18d2370a60a1c3eca", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n    assert (solver->unassigned);\n    if (!GET_OPTION (restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Conflict limit check (fallback)\n    if (CONFLICTS >= solver->limits.restart.conflicts)\n        return true;\n\n    // In stable mode, use reluctant restart\n    if (solver->stable)\n        return kissat_reluctant_triggered (&solver->reluctant);\n\n    // Get averages\n    const double fast_glue = AVERAGE (fast_glue);\n    const double slow_glue = AVERAGE (slow_glue);\n    const double glue_ratio = (slow_glue > 0.0) ? (fast_glue / slow_glue) : 0.0;\n\n    // Decision rate\n    const double decision_rate = AVERAGE (decision_rate);\n\n    // Maintain historical max decision rate\n    static double max_decision_rate = 0.0;\n    if (decision_rate > max_decision_rate)\n        max_decision_rate = decision_rate;\n\n    // Restart triggers:\n    // 1. Glue ratio exceeds 1.10 (fast_glue > 1.10 * slow_glue)\n    if (glue_ratio > 1.10) {\n        kissat_extremely_verbose (solver,\n            \"restart: glue ratio %.3f (fast %.3f / slow %.3f) > 1.10\",\n            glue_ratio, fast_glue, slow_glue);\n        return true;\n    }\n\n    // 2. Decision rate drops below 75% of max seen\n    if (max_decision_rate > 0.0 && decision_rate < 0.75 * max_decision_rate) {\n        kissat_extremely_verbose (solver,\n            \"restart: decision rate %.3f < 0.75 * max %.3f\",\n            decision_rate, max_decision_rate);\n        return true;\n    }\n\n    // 3. Conflict limit fallback (already checked above)\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 437, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1754}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225dc5cb081908045e2d5f9bfe71a", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "d6d0a1b59c336def5200725d822f383b", "body": {"id": "resp_0670dc8511d6c15a006922257caa3c819fae586b95f0085c9c", "object": "response", "created_at": 1763845500, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0670dc8511d6c15a006922257d1588819f8472cc3722238a8c", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // 1. If not yet seen any conflicts, do not restart.\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double glue_ratio = slow_glue > 0 ? fast_glue / slow_glue : 0.0;\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Static variable to track historical max decision rate per phase.\n  static double max_decision_rate_seen = 0.0;\n  if (decision_rate > max_decision_rate_seen)\n    max_decision_rate_seen = decision_rate;\n\n  // In stable mode, use only the reluctant restart trigger.\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // 1. Glue-based trigger (prefer if both fire)\n  if (glue_ratio > 1.10)\n  {\n    kissat_extremely_verbose (solver,\n      \"restarting: glue ratio %.3f (fast %.2f / slow %.2f) > 1.10\",\n      glue_ratio, fast_glue, slow_glue);\n    return true;\n  }\n\n  // 2. Decision rate drop trigger\n  if (max_decision_rate_seen > 0.0 && decision_rate < 0.75 * max_decision_rate_seen)\n  {\n    kissat_extremely_verbose (solver,\n      \"restarting: decision rate %.2f < 0.75 * max_decision_rate_seen %.2f\",\n      decision_rate, max_decision_rate_seen);\n    return true;\n  }\n\n  // 3. Fallback: conflict limit.\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n  {\n    kissat_extremely_verbose (solver,\n      \"restarting: reached conflict limit (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 490, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1807}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225dc5ec08190a2c6e632d040b47e", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "bbf7702c16712efff966a3b3037aff35", "body": {"id": "resp_08b6c7c73e666fb80069222581a7bc819fa2f0e7b4842a9bd1", "object": "response", "created_at": 1763845505, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_08b6c7c73e666fb80069222581f3d4819f85d72ca4d8f0262f", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit check (fallback trigger)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Stable phase: use reluctant restarts as before\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // --- Adaptive Dual-Glue & Decision Rate Restart (ADGDRR) ---\n\n  // Fetch fast and slow glue averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // Avoid division by zero\n  double glue_ratio = 1.0;\n  if (slow_glue > 0.0)\n    glue_ratio = fast_glue / slow_glue;\n\n  // Fetch moving average of decision rate\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Maintain and update max decision rate seen so far\n  // We store it in solver->restart_max_decision_rate (add double restart_max_decision_rate to 'kissat' struct if needed)\n  if (decision_rate > solver->restart_max_decision_rate)\n    solver->restart_max_decision_rate = decision_rate;\n\n  // Compute threshold for decision rate drop\n  const double decision_rate_threshold = 0.75 * solver->restart_max_decision_rate;\n\n  // Trigger 1: glue ratio > 1.10 (fast glue exceeds slow glue by 10%)\n  const bool glue_trigger = glue_ratio > 1.10;\n\n  // Trigger 2: decision rate drops below 75% of peak\n  const bool decision_rate_trigger = decision_rate < decision_rate_threshold;\n\n  // Prefer glue trigger if both fire\n  if (glue_trigger) {\n    kissat_extremely_verbose (solver,\n      \"restart: glue ratio %.3f (fast: %.3f, slow: %.3f) > 1.10, triggering restart\",\n      glue_ratio, fast_glue, slow_glue);\n    return true;\n  }\n\n  if (decision_rate_trigger) {\n    kissat_extremely_verbose (solver,\n      \"restart: decision rate %.3f < 0.75 * max_decision_rate %.3f, triggering restart\",\n      decision_rate, solver->restart_max_decision_rate);\n    return true;\n  }\n\n  // No trigger: do not restart yet\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 554, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1871}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225dc60c881909886e639b8371232", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "180cc2b801e52642674f91ed75e740cf", "body": {"id": "resp_0138975d369701580069222586c790819ca87609c690e9f431", "object": "response", "created_at": 1763845510, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0138975d36970158006922258741dc819ca46e36869dc819d7", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Get current conflict count and limit\n  uint64_t conflicts = solver->statistics.conflicts;\n  uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n  // If conflict limit reached or exceeded, restart (fallback)\n  if (conflicts >= conflict_limit)\n    return true;\n\n  // Extract relevant averages\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double glue_ratio = (slow_glue > 0.0) ? (fast_glue / slow_glue) : 1.0;\n\n  // Extract decision rate average\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Track and update the maximum decision rate seen so far (per phase)\n  double *max_decision_rate_seen = &solver->restart_max_decision_rate;\n  if (decision_rate > *max_decision_rate_seen)\n    *max_decision_rate_seen = decision_rate;\n\n  // Compute decision rate threshold (75% of max seen so far)\n  const double decision_rate_threshold = 0.75 * (*max_decision_rate_seen);\n\n  // Dual-trigger: glue ratio or decision rate drop\n  bool glue_trigger = (glue_ratio > 1.10);\n  bool rate_trigger = (decision_rate < decision_rate_threshold);\n\n  // If both triggers fire, prefer glue trigger as reason\n  if (glue_trigger) {\n    kissat_extremely_verbose (solver,\n      \"restarting: fast_glue/slow_glue ratio %.3f > 1.10 (fast=%.2f slow=%.2f)\",\n      glue_ratio, fast_glue, slow_glue);\n    return true;\n  }\n\n  if (rate_trigger) {\n    kissat_extremely_verbose (solver,\n      \"restarting: decision rate %.2f < 0.75 * max_decision_rate %.2f\",\n      decision_rate, *max_decision_rate_seen);\n    return true;\n  }\n\n  // Otherwise, don't restart yet\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 488, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1805}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225dc5ffc8190b69c619900ec1ecd", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "e3ee5b29bc2b2c0e159ee5e157bb476d", "body": {"id": "resp_0c6056fa1171546c006922258c1bf481a3bcb79ef8771eb116", "object": "response", "created_at": 1763845516, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0c6056fa1171546c006922258c6a9081a3a9a04160c1c37f7e", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Fetch statistics and averages\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n  const double fast_glue = solver->averages[solver->stable].fast_glue.value;\n  const double slow_glue = solver->averages[solver->stable].slow_glue.value;\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Maintain and update the max decision rate seen so far\n  double *max_decision_rate_ptr = &solver->restart_max_decision_rate;\n  if (decision_rate > *max_decision_rate_ptr)\n    *max_decision_rate_ptr = decision_rate;\n  const double max_decision_rate_seen = *max_decision_rate_ptr;\n\n  // Compute glue ratio\n  double glue_ratio = slow_glue > 0 ? fast_glue / slow_glue : 0.0;\n\n  // Check ADGDRR restart criteria\n  bool glue_trigger = glue_ratio > 1.10;\n  bool decision_rate_trigger = \n    max_decision_rate_seen > 0 && decision_rate < 0.75 * max_decision_rate_seen;\n  bool conflict_limit_trigger = conflicts >= conflict_limit;\n\n  // Tie-breaker: prefer glue trigger if both fire\n  if (glue_trigger) {\n    kissat_extremely_verbose(solver,\n      \"restart: glue ratio %.3f > 1.10 (fast %.2f, slow %.2f)\",\n      glue_ratio, fast_glue, slow_glue);\n    return true;\n  }\n  if (decision_rate_trigger) {\n    kissat_extremely_verbose(solver,\n      \"restart: decision rate %.2f < 0.75 * max %.2f\",\n      decision_rate, max_decision_rate_seen);\n    return true;\n  }\n  if (conflict_limit_trigger) {\n    kissat_extremely_verbose(solver,\n      \"restart: conflict limit reached (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      conflicts, conflict_limit);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 493, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1810}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225dc5d988190b2715ab31687ff24", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "e8d48870eede9de73a057ade983342ff", "body": {"id": "resp_079020f90e80b72b0069222590fee8819f99d7bec5a0c2bf79", "object": "response", "created_at": 1763845521, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_079020f90e80b72b00692225915b8c819f9b379e754ca0d113", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit fallback\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Reluctant restart in stable mode\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // --- Adaptive Dual-Glue & Decision Rate Restart (ADGDRR) ---\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n\n  // Defensive: avoid division by zero\n  if (slow_glue <= 0.0)\n    return false;\n\n  const double glue_ratio = fast_glue / slow_glue;\n\n  // Decision rate\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Maintain historical max decision rate\n  double *max_decision_rate_ptr = &solver->restart.max_decision_rate;\n  if (decision_rate > *max_decision_rate_ptr)\n    *max_decision_rate_ptr = decision_rate;\n  const double max_decision_rate = *max_decision_rate_ptr;\n\n  // ADGDRR triggers\n  const bool glue_trigger = (glue_ratio > 1.10);\n  const bool drate_trigger =\n    (max_decision_rate > 0.0) && (decision_rate < 0.75 * max_decision_rate);\n\n  // If both triggers, prefer glue as per tie-breaker\n  if (glue_trigger) {\n    kissat_extremely_verbose (solver,\n      \"restart by glue: fast_glue %.2f / slow_glue %.2f = %.3f > 1.10\",\n      fast_glue, slow_glue, glue_ratio);\n    return true;\n  }\n\n  if (drate_trigger) {\n    kissat_extremely_verbose (solver,\n      \"restart by decision rate: avg %.2f < 0.75 * max %.2f\",\n      decision_rate, max_decision_rate);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 473, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1790}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225dc5f988190af6331efd5c2d40f", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "c46dce160c0046646195ec2d4cb64a74", "body": {"id": "resp_0fc73ada55e3ca0d0069222597b87881a380766f77640c4b5e", "object": "response", "created_at": 1763845527, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0fc73ada55e3ca0d0069222597f9f481a3a196855eb41e108f", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n    assert(solver->unassigned);\n    if (!GET_OPTION(restart))\n        return false;\n    if (!solver->level)\n        return false;\n\n    // Gather statistics\n    const uint64_t conflicts = solver->statistics.conflicts;\n    const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n    // Get averages for the current mode (stable or not)\n    const int mode = solver->stable;\n    const double fast_glue = solver->averages[mode].fast_glue.value;\n    const double slow_glue = solver->averages[mode].slow_glue.value;\n    const double decision_rate = solver->averages[mode].decision_rate.value;\n\n    // Track the observed peak decision rate\n    static double max_decision_rate_seen = 0.0;\n    if (decision_rate > max_decision_rate_seen)\n        max_decision_rate_seen = decision_rate;\n\n    // Compute glue ratio\n    double glue_ratio = (slow_glue > 0.0) ? (fast_glue / slow_glue) : 1.0;\n\n    // Compute the 75% threshold for decision rate\n    double decision_rate_threshold = 0.75 * max_decision_rate_seen;\n\n    // Triggers:\n    bool glue_trigger = glue_ratio > 1.10;\n    bool dec_rate_trigger = decision_rate < decision_rate_threshold;\n    bool conflict_limit_trigger = conflicts >= conflict_limit;\n\n    // Tie-breaker: prefer glue-trigger if both fire\n    if (glue_trigger) {\n        kissat_extremely_verbose(\n            solver,\n            \"restart by glue ratio %.3f = %.3f / %.3f > 1.10\",\n            glue_ratio, fast_glue, slow_glue\n        );\n        return true;\n    }\n    if (dec_rate_trigger) {\n        kissat_extremely_verbose(\n            solver,\n            \"restart by decision rate %.3f < 0.75 * %.3f = %.3f\",\n            decision_rate, max_decision_rate_seen, decision_rate_threshold\n        );\n        return true;\n    }\n    if (conflict_limit_trigger) {\n        kissat_extremely_verbose(\n            solver,\n            \"restart by conflict limit: %\" PRIu64 \" >= %\" PRIu64,\n            conflicts, conflict_limit\n        );\n        return true;\n    }\n\n    return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 505, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1822}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225dc654c8190878dd74f500042be", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "8687ccf56794b5a9a5a1f772dcef8753", "body": {"id": "resp_066edc84d7155cf5006922259d5f4481918a973c5a0e0f0b55", "object": "response", "created_at": 1763845533, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_066edc84d7155cf5006922259da8fc81919273189dddf45162", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Stable-phase: use reluctant restarts as usual\n  if (solver->stable)\n    return kissat_reluctant_triggered(&solver->reluctant);\n\n  // --- ADGDRR heuristic ---\n\n  // Get glue values\n  const double fast = AVERAGE(fast_glue);\n  const double slow = AVERAGE(slow_glue);\n  const double glue_ratio = (slow > 0.0) ? (fast / slow) : 0.0;\n\n  // Get decision rate\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Track historical max decision rate (per phase)\n  double *max_decision_rate = &solver->restart_max_decision_rate;\n  if (decision_rate > *max_decision_rate)\n    *max_decision_rate = decision_rate;\n\n  // (1) Glue ratio trigger\n  if (glue_ratio > 1.10) {\n    kissat_extremely_verbose(solver,\n      \"restart: glue_ratio %.3f > 1.10 (fast=%.3f slow=%.3f)\",\n      glue_ratio, fast, slow);\n    return true;\n  }\n\n  // (2) Decision rate drop trigger\n  if (*max_decision_rate > 0.0 && decision_rate < 0.75 * (*max_decision_rate)) {\n    kissat_extremely_verbose(solver,\n      \"restart: decision_rate %.3f < 0.75*%.3f (max)\",\n      decision_rate, *max_decision_rate);\n    return true;\n  }\n\n  // (3) Fallback: no trigger\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 422, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1739}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225dc61a881909bc2d41e452f9e2a", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "0375b5c9cbd55a91ec94ff4419df543c", "body": {"id": "resp_076435b55f40e85f00692225a2414c819f96bc42248246cde5", "object": "response", "created_at": 1763845538, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_076435b55f40e85f00692225a284ec819f9e30824c8b1625db", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  // Conflict limit fallback\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // Stable phase: keep default reluctant schedule\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // --- Begin Adaptive Dual-Glue & Decision Rate Restart ---\n\n  // Compute glue statistics\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double glue_ratio = slow_glue > 0.0 ? (fast_glue / slow_glue) : 0.0;\n\n  // Compute decision rate statistics\n  double curr_decision_rate = AVERAGE (decision_rate);\n\n  // Maintain historical max decision rate (per solver instance)\n  if (curr_decision_rate > solver->restart_max_decision_rate)\n    solver->restart_max_decision_rate = curr_decision_rate;\n\n  const double max_decision_rate = solver->restart_max_decision_rate;\n\n  // Condition 1: Glue ratio exceeded threshold\n  const bool glue_cond = glue_ratio > 1.10;\n\n  // Condition 2: Decision rate dropped below 75% of historical max\n  const bool drate_cond = (max_decision_rate > 0.0) ?\n    (curr_decision_rate < 0.75 * max_decision_rate) : false;\n\n  // Prefer glue condition when both trigger\n  if (glue_cond) {\n    kissat_extremely_verbose (\n      solver,\n      \"restart triggered: glue ratio %.3f > 1.10 (fast=%.3f, slow=%.3f)\",\n      glue_ratio, fast_glue, slow_glue);\n    return true;\n  }\n\n  if (drate_cond) {\n    kissat_extremely_verbose (\n      solver,\n      \"restart triggered: decision rate %.3f < 75%% of max %.3f\",\n      curr_decision_rate, max_decision_rate);\n    return true;\n  }\n\n  // Otherwise, fallback to conflict limit (already checked above)\n  return true;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 493, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1810}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225dc65988190bf1ab6e21ca26e48", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "6cfaf0d527ea0694274bc06273ef1076", "body": {"id": "resp_0fdba6b8a3e278ff00692225a720588192a6269dcbde1c345d", "object": "response", "created_at": 1763845543, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0fdba6b8a3e278ff00692225a756788192a11de8a387825935", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict upper bound always triggers a restart if exceeded.\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Fetch averages and decision rate.\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double glue_ratio = slow_glue > 0 ? fast_glue / slow_glue : 1.0;\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Maintain max_decision_rate_seen (persistent, per-phase or global).\n  // We'll use a member variable in solver for this purpose.\n  // INIT: If first call, initialize.\n  if (solver->max_decision_rate_seen < decision_rate)\n    solver->max_decision_rate_seen = decision_rate;\n\n  // (1) Glue ratio trigger\n  const double glue_threshold = 1.10;\n  const bool glue_triggered = (glue_ratio > glue_threshold);\n\n  // (2) Decision rate drop trigger\n  const double decision_rate_threshold = 0.75 * solver->max_decision_rate_seen;\n  const bool decision_rate_triggered = (decision_rate < decision_rate_threshold);\n\n  // (3) Conflict limit fallback is handled at top.\n\n  // Prefer (1) glue ratio as tie-breaker.\n  if (glue_triggered) {\n    kissat_extremely_verbose (solver,\n      \"restart: fast_glue %.2f / slow_glue %.2f = %.3f > %.2f (glue triggered)\",\n      fast_glue, slow_glue, glue_ratio, glue_threshold);\n    return true;\n  }\n  if (decision_rate_triggered) {\n    kissat_extremely_verbose (solver,\n      \"restart: decision_rate %.2f < 0.75 * max_decision_rate_seen %.2f = %.2f (decision rate triggered)\",\n      decision_rate, solver->max_decision_rate_seen, decision_rate_threshold);\n    return true;\n  }\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1317, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 475, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1792}, "user": null, "metadata": {}}}, "error": null}
