{"id": "batch_req_6922259145048190b71d01ed19789214", "custom_id": "req-0001", "response": {"status_code": 200, "request_id": "d305a70973d762987c6deac0135434d8", "body": {"id": "resp_0acbd1a90b9233c50069222579fee88190b48efba2969e293b", "object": "response", "created_at": 1763845498, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0acbd1a90b9233c5006922257a64f48190b646d91b8eadc2e2", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Shortcuts to stats and averages\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n  const bool stable = solver->stable;\n  const double fast_glue = solver->averages[stable].fast_glue.value;\n  const double slow_glue = solver->averages[stable].slow_glue.value;\n  const double decision_rate = solver->averages[stable].decision_rate.value;\n\n  // Maintain historical slow maximum of decision_rate per stage\n  // (Assume this is defined in the solver struct)\n  double *max_decision_rate = &solver->averages[stable].max_decision_rate;\n  if (decision_rate > *max_decision_rate)\n    *max_decision_rate = decision_rate;\n\n  // Condition 1: Glue Spike\n  bool glue_spike = fast_glue > slow_glue * 1.1;\n\n  // Condition 2: Stagnating Decision Rate\n  bool stagnating_decision_rate = false;\n  if (*max_decision_rate > 0.0)\n    stagnating_decision_rate = decision_rate < 0.75 * (*max_decision_rate);\n\n  // Condition 3: Conflict Limit\n  bool conflict_limit_reached = conflicts >= conflict_limit;\n\n  // Tie-breaker: prefer glue spike, then stagnating decision rate, then conflict limit\n  if (glue_spike) {\n    kissat_extremely_verbose (\n      solver, \"restarting: glue spike: fast_glue %.2f > slow_glue*1.1 %.2f\",\n      fast_glue, slow_glue * 1.1);\n    return true;\n  }\n  if (stagnating_decision_rate) {\n    kissat_extremely_verbose (\n      solver, \"restarting: decision rate stagnation: %.2f < 0.75 * historical max %.2f\",\n      decision_rate, 0.75 * (*max_decision_rate));\n    return true;\n  }\n  if (conflict_limit_reached) {\n    kissat_extremely_verbose (\n      solver, \"restarting: conflict limit reached: %\" PRIu64 \" >= %\" PRIu64,\n      conflicts, conflict_limit);\n    return true;\n  }\n\n  // Optionally, for stable phase, keep reluctant restarts (as in original)\n  if (stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 569, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1952}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225914b008190824e2ddac7a33fe1", "custom_id": "req-0002", "response": {"status_code": 200, "request_id": "0fb745233ac46d6cd3fff5efab2598a4", "body": {"id": "resp_0ccf4b012edae9db006922257e7f3481968c140301062257f0", "object": "response", "created_at": 1763845502, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0ccf4b012edae9db006922257ec96081969868c06593555c12", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = AVERAGE (decision_rate);\n\n  // Maintain historical slow maximum of decision_rate for this stage\n  double *historical_max_decision_rate =\n    solver->stable ? &solver->restart.stable_max_decision_rate\n                   : &solver->restart.unstable_max_decision_rate;\n\n  // Initialize if necessary\n  if (*historical_max_decision_rate < 0)\n    *historical_max_decision_rate = decision_rate;\n  if (decision_rate > *historical_max_decision_rate)\n    *historical_max_decision_rate = decision_rate;\n\n  const double glue_spike_limit = slow_glue * 1.1;\n  const double stagnation_limit = 0.75 * (*historical_max_decision_rate);\n\n  bool glue_spike = (fast_glue > glue_spike_limit);\n  bool stagnating_decision_rate = (decision_rate < stagnation_limit);\n  bool conflict_limit = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  kissat_extremely_verbose (\n    solver,\n    \"restart triggers: glue_spike=%d (fast_glue %.2f > slow_glue*1.1 %.2f), \"\n    \"stagnating_decision_rate=%d (decision_rate %.2f < 0.75*max %.2f), \"\n    \"conflict_limit=%d (%\" PRIu64 \" >= %\" PRIu64 \")\",\n    glue_spike, fast_glue, glue_spike_limit,\n    stagnating_decision_rate, decision_rate, stagnation_limit,\n    conflict_limit, CONFLICTS, solver->limits.restart.conflicts);\n\n  // Tie-breaker: glue spike > stagnation > conflict limit\n  if (glue_spike)\n    return true;\n  if (stagnating_decision_rate)\n    return true;\n  if (conflict_limit)\n    return true;\n\n  // If in stable mode, fallback to original reluctant trigger\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 536, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1919}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225914da4819087181041d8059424", "custom_id": "req-0003", "response": {"status_code": 200, "request_id": "37624d6e2e9d921a4635a6251f47f78d", "body": {"id": "resp_025cc223170739150069222582f8b881939c40f2bbd31b583d", "object": "response", "created_at": 1763845507, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_025cc223170739150069222583b1a881938bb15fffca58144b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n\n  if (!solver->level)\n    return false;\n\n  // Conflict limit condition\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // For stable phase, use reluctant restarts\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // --- Dynamic Glue Decision Hybrid Restart (DGDHR) ---\n\n  // Gather current statistics\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Maintain historical maximum decision rate per phase (stable/unstable)\n  double *historical_max_decision_rate;\n  if (solver->stable)\n    historical_max_decision_rate = &solver->restart_stats.stable_max_decision_rate;\n  else\n    historical_max_decision_rate = &solver->restart_stats.unstable_max_decision_rate;\n\n  // Initialize maximum if unset (0.0 means uninitialized)\n  if (*historical_max_decision_rate < decision_rate)\n    *historical_max_decision_rate = decision_rate;\n\n  // 1. Glue Spike: fast_glue > slow_glue * 1.1 (10% degradation)\n  bool glue_spike = fast_glue > slow_glue * 1.1;\n\n  // 2. Stagnating Decision Rate: decision_rate < 0.75 * (historical slow maximum)\n  bool stagnating_decision_rate = false;\n  if (*historical_max_decision_rate > 0.0)\n    stagnating_decision_rate = decision_rate < 0.75 * (*historical_max_decision_rate);\n\n  // 3. Conflict limit: conflicts >= limit (already checked above)\n\n  // Tie-breaker: prefer glue spike over stagnation, then conflict limit\n  if (glue_spike) {\n    kissat_extremely_verbose (solver,\n      \"restart by glue spike: fast_glue %g > 1.1 * slow_glue %g\",\n      fast_glue, slow_glue);\n    return true;\n  } else if (stagnating_decision_rate) {\n    kissat_extremely_verbose (solver,\n      \"restart by decision rate: decision_rate %g < 0.75 * historical max %g\",\n      decision_rate, *historical_max_decision_rate);\n    return true;\n  } else {\n    // Fallback: restart on hitting the conflict limit\n    kissat_extremely_verbose (solver,\n      \"restart by conflict limit: conflicts %\" PRIu64 \" >= limit %\" PRIu64,\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 619, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 2002}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922259148108190a272563b3667450b", "custom_id": "req-0004", "response": {"status_code": 200, "request_id": "0d3bd6f0be5dab135fa58238140be75a", "body": {"id": "resp_0fa84cd922c6c6f9006922253e16688194b094876349092b9b", "object": "response", "created_at": 1763845438, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0fa84cd922c6c6f9006922253e5ea881949dcce70ccd25a5b8", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting(kissat *solver) {\n  assert(solver->unassigned);\n  if (!GET_OPTION(restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  const uint64_t num_conflicts = solver->statistics.conflicts;\n  const uint64_t restart_conflict_limit = solver->limits.restart.conflicts;\n  const double fast_glue = AVERAGE(fast_glue);\n  const double slow_glue = AVERAGE(slow_glue);\n  const double decision_rate = AVERAGE(decision_rate);\n\n  // Maintain historical slow maximum for decision_rate per stable/unstable stage.\n  // We use a static variable indexed by stable/unstable stage (0/1).\n  static double historical_slow_decision_rate_max[2] = {0.0, 0.0};\n  const int stage = solver->stable ? 1 : 0;\n  if (decision_rate > historical_slow_decision_rate_max[stage])\n    historical_slow_decision_rate_max[stage] = decision_rate;\n  const double historical_max = historical_slow_decision_rate_max[stage];\n\n  // 1. Glue Spike: fast_glue > slow_glue * 1.1\n  const double glue_spike_limit = 1.1 * slow_glue;\n  const bool glue_spike = (fast_glue > glue_spike_limit);\n\n  // 2. Stagnating Decision Rate: decision_rate < 0.75 * historical_max\n  const double decision_rate_threshold = 0.75 * historical_max;\n  const bool stagnating_decision_rate = (historical_max > 0.0) && (decision_rate < decision_rate_threshold);\n\n  // 3. Conflict Limit\n  const bool conflict_limit = (num_conflicts >= restart_conflict_limit);\n\n  // Tie-breaker: prefer (1) glue spike, else (2) decision rate, else (3) conflict limit\n  if (glue_spike) {\n    kissat_extremely_verbose(solver,\n      \"restarting: glue spike (fast_glue %.2f > slow_glue*1.1 %.2f)\",\n      fast_glue, glue_spike_limit);\n    return true;\n  }\n  if (stagnating_decision_rate) {\n    kissat_extremely_verbose(solver,\n      \"restarting: stagnating decision rate (current %.2f < 0.75*max %.2f)\",\n      decision_rate, historical_max);\n    return true;\n  }\n  if (conflict_limit) {\n    if (solver->stable)\n      return kissat_reluctant_triggered(&solver->reluctant);\n    kissat_extremely_verbose(solver,\n      \"restarting: conflict limit reached (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      num_conflicts, restart_conflict_limit);\n    return true;\n  }\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 616, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1999}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225914f5c8190a5258d879fa06e71", "custom_id": "req-0005", "response": {"status_code": 200, "request_id": "58a9b0c076a145efd6f4cff6abc5212f", "body": {"id": "resp_0a9495bf25fd5fa9006922253e57e48194ac05b8c54e59f9ca", "object": "response", "created_at": 1763845438, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0a9495bf25fd5fa9006922253f16308194bf4ecf3fd364cadc", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Retrieve relevant values\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n  const uint64_t num_conflicts = CONFLICTS;\n  const uint64_t restart_conflict_limit = solver->limits.restart.conflicts;\n\n  // Maintain historical slow max for decision_rate (per stage)\n  double *historical_max_decision_rate =\n    &solver->averages[solver->stable].decision_rate.max_value;\n  if (decision_rate > *historical_max_decision_rate)\n    *historical_max_decision_rate = decision_rate;\n\n  // 1. Glue Spike: fast_glue > slow_glue * 1.1\n  if (fast_glue > slow_glue * 1.1) {\n    kissat_extremely_verbose (solver,\n      \"restart: GLUE spike: fast_glue %.2f > 1.1 * slow_glue %.2f (%.2f)\",\n      fast_glue, slow_glue, slow_glue * 1.1);\n    return true;\n  }\n\n  // 2. Stagnating Decision Rate: decision_rate < 0.75 * historical slow max\n  const double max_decision_rate = *historical_max_decision_rate;\n  if (max_decision_rate > 0.0 && decision_rate < 0.75 * max_decision_rate) {\n    kissat_extremely_verbose (solver,\n      \"restart: DECISION RATE stagnation: %.2f < 0.75 * max %.2f (%.2f)\",\n      decision_rate, max_decision_rate, 0.75 * max_decision_rate);\n    return true;\n  }\n\n  // 3. Conflict Limit\n  if (num_conflicts >= restart_conflict_limit) {\n    kissat_extremely_verbose (solver,\n      \"restart: CONFLICT LIMIT reached: %\" PRIu64 \" >= %\" PRIu64,\n      num_conflicts, restart_conflict_limit);\n    return true;\n  }\n\n  // No restart trigger\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 507, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1890}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225914d5481909cb2f3db5385286c", "custom_id": "req-0006", "response": {"status_code": 200, "request_id": "ba1cbebdc4556a69096c191cb08e3d51", "body": {"id": "resp_0ebc97565f5b2edf006922258806e08194a9782ca66b489411", "object": "response", "created_at": 1763845512, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0ebc97565f5b2edf00692225885f4c819486c9be8d53e5d43b", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger (third priority)\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Historical slow maximum for decision_rate (per stable/unstable)\n  double *slow_max_ptr = &solver->averages[solver->stable].decision_rate_slow_max;\n  if (decision_rate > *slow_max_ptr)\n    *slow_max_ptr = decision_rate;\n  const double decision_rate_slow_max = *slow_max_ptr;\n\n  // 1. Glue Spike: fast_glue > slow_glue * 1.1\n  bool glue_spike = fast_glue > slow_glue * 1.1;\n\n  // 2. Stagnating Decision Rate: decision_rate < 0.75 * slow_max\n  bool stagnating_decision = decision_rate < 0.75 * decision_rate_slow_max;\n\n  // 3. Conflict limit (always reached here)\n  bool conflict_limit = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Tie-breaking: Prefer glue spike, then decision rate, then conflict limit\n  if (glue_spike) {\n    kissat_extremely_verbose (solver,\n      \"restarting: glue spike (fast_glue %.2f > slow_glue %.2f * 1.1)\",\n      fast_glue, slow_glue);\n    return true;\n  }\n  if (stagnating_decision) {\n    kissat_extremely_verbose (solver,\n      \"restarting: stagnating decision rate (%.2f < 0.75 * %.2f)\",\n      decision_rate, decision_rate_slow_max);\n    return true;\n  }\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // Default: conflict limit (for unstable)\n  kissat_extremely_verbose (solver, \"restarting: conflict limit reached (%ld >= %ld)\",\n    CONFLICTS, solver->limits.restart.conflicts);\n  return conflict_limit;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 518, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1901}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225914c0c8190bd06d99d8e212f0e", "custom_id": "req-0007", "response": {"status_code": 200, "request_id": "576c316bcac4ea120927e614898e6a10", "body": {"id": "resp_06fb43116c468f89006922253e1b54819385e07647bab3a94c", "object": "response", "created_at": 1763845438, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_06fb43116c468f89006922253e75a08193b5235f640449d98e", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n  const int stable = solver->stable;\n\n  const double fast_glue = solver->averages[stable].fast_glue.value;\n  const double slow_glue = solver->averages[stable].slow_glue.value;\n  const double decision_rate = solver->averages[stable].decision_rate.value;\n\n  // Maintain and update the historical slow maximum of decision_rate\n  // Use: solver->averages[stable].decision_rate_max as the historical max\n  double *decision_rate_max_ptr = &solver->averages[stable].decision_rate_max;\n  if (decision_rate > *decision_rate_max_ptr)\n    *decision_rate_max_ptr = decision_rate;\n  const double decision_rate_max = *decision_rate_max_ptr;\n\n  // 1. Glue Spike: fast_glue > slow_glue * 1.1\n  const double glue_spike_threshold = 1.1 * slow_glue;\n  const bool glue_spike = (fast_glue > glue_spike_threshold);\n\n  // 2. Stagnating Decision Rate: decision_rate < 0.75 * decision_rate_max\n  const double rate_stagnate_threshold = 0.75 * decision_rate_max;\n  const bool decision_rate_stagnate = (decision_rate < rate_stagnate_threshold);\n\n  // 3. Conflict Limit\n  const bool conflict_limit_reached = (conflicts >= conflict_limit);\n\n  // Tie-breaker: prefer glue spike, then decision rate, then conflict limit\n  if (glue_spike) {\n    kissat_extremely_verbose (solver,\n      \"restart: glue spike detected (fast_glue %.2f > slow_glue*1.10 %.2f)\",\n      fast_glue, glue_spike_threshold);\n    return true;\n  }\n  if (decision_rate_stagnate) {\n    kissat_extremely_verbose (solver,\n      \"restart: decision rate stagnation detected (decision_rate %.2f < 0.75 * max %.2f)\",\n      decision_rate, decision_rate_max);\n    return true;\n  }\n  if (conflict_limit_reached) {\n    if (stable)\n      return kissat_reluctant_triggered (&solver->reluctant);\n    kissat_extremely_verbose (solver,\n      \"restart: conflict limit reached (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      conflicts, conflict_limit);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 581, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1964}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225914f4c8190ad5a20422f7288c0", "custom_id": "req-0008", "response": {"status_code": 200, "request_id": "c0f83190a9af82e8c8f9123ccb276d02", "body": {"id": "resp_0eda86532db3a4cc006922258c363c819782a1b17278b87b48", "object": "response", "created_at": 1763845516, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_0eda86532db3a4cc006922258c76b88197aa2708f162d0ea61", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver)\n{\n  assert (solver->unassigned);\n\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  const uint64_t conflicts = solver->statistics.conflicts;\n  const uint64_t conflict_limit = solver->limits.restart.conflicts;\n\n  // If conflict limit is not reached and no other trigger, don't restart.\n  if (conflicts < conflict_limit)\n    ; // Continue to check other triggers.\n  else\n    // Conflict limit is always a valid trigger (lowest priority)\n    return true;\n\n  // Get averages for current stage (stable/unstable)\n  const int mode = solver->stable;\n  const double fast_glue = solver->averages[mode].fast_glue.value;\n  const double slow_glue = solver->averages[mode].slow_glue.value;\n  const double decision_rate = solver->averages[mode].decision_rate.value;\n\n  // --- Condition 1: Glue Spike (highest priority) ---\n  // Restart if fast_glue > slow_glue * 1.1\n  const double glue_margin = 1.1;\n  if (fast_glue > glue_margin * slow_glue)\n  {\n    kissat_extremely_verbose (solver,\n      \"restart: GLUE-SPIKE triggered: fast_glue %.2f > %.2f (1.1 * slow_glue %.2f)\",\n      fast_glue, glue_margin * slow_glue, slow_glue);\n    return true;\n  }\n\n  // --- Condition 2: Decision Rate Stagnation ---\n  // Maintain a historical maximum of decision_rate for current mode\n  double *max_decision_rate = &solver->averages[mode].decision_rate_max;\n  if (decision_rate > *max_decision_rate)\n    *max_decision_rate = decision_rate;\n\n  // Restart if decision_rate < 0.75 * max_decision_rate\n  const double rate_margin = 0.75;\n  if (decision_rate < rate_margin * (*max_decision_rate))\n  {\n    kissat_extremely_verbose (solver,\n      \"restart: DECISION-RATE-STAGNATION triggered: decision_rate %.2f < 0.75 * max_decision_rate %.2f\",\n      decision_rate, *max_decision_rate);\n    return true;\n  }\n\n  // --- Condition 3: Conflict Limit (lowest priority) ---\n  // (Already handled above.)\n\n  // If in stable phase, allow reluctant restarts as in original code\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // None of the hybrid triggers fired, so do not restart.\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 580, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1963}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_6922259159808190928b8733925d9337", "custom_id": "req-0009", "response": {"status_code": 200, "request_id": "c568fbd3c929fb961b7c9de207d36e19", "body": {"id": "resp_04285209bd2f0b4c006922254292e48196b35a070a61da9947", "object": "response", "created_at": 1763845442, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_04285209bd2f0b4c0069222542c3b8819695dbe59b08a2260a", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit check\n  if (CONFLICTS < solver->limits.restart.conflicts)\n    return false;\n\n  // For \"stable\" stage, use the reluctant schedule as usual\n  if (solver->stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // Get current glue and decision rate statistics\n  const double fast_glue = AVERAGE (fast_glue);\n  const double slow_glue = AVERAGE (slow_glue);\n  const double decision_rate = solver->averages[solver->stable].decision_rate.value;\n\n  // Store and update the historical slow maximum of decision_rate per stage\n  // We'll use the existing solver->restart_decision_rate_max[stage]\n  double *max_decision_rate =\n    &solver->restart_decision_rate_max[solver->stable];\n  if (decision_rate > *max_decision_rate)\n    *max_decision_rate = decision_rate;\n\n  // Condition 1: Glue Spike (>10% degradation)\n  const double glue_spike_threshold = 1.1;\n  bool glue_spike = (fast_glue > glue_spike_threshold * slow_glue);\n\n  // Condition 2: Stagnating Decision Rate (<75% of historical slow maximum)\n  const double stagnation_factor = 0.75;\n  bool dec_rate_stagnate = (decision_rate < stagnation_factor * (*max_decision_rate));\n\n  // Condition 3: Conflict limit reached (should always be true here)\n  bool conflict_limit = (CONFLICTS >= solver->limits.restart.conflicts);\n\n  // Tie-break: prefer glue spike, then decision rate stagnation, then conflict limit\n  if (glue_spike) {\n    kissat_extremely_verbose (solver,\n      \"DGDHR: restart by glue spike (fast_glue %.2f > %.2f * slow_glue %.2f)\",\n      fast_glue, glue_spike_threshold, slow_glue);\n    return true;\n  }\n  if (dec_rate_stagnate) {\n    kissat_extremely_verbose (solver,\n      \"DGDHR: restart by decision rate stagnation (current %.2f < %.2f * max %.2f)\",\n      decision_rate, stagnation_factor, *max_decision_rate);\n    return true;\n  }\n  if (conflict_limit) {\n    kissat_extremely_verbose (solver,\n      \"DGDHR: restart by conflict limit (%\" PRIu64 \" >= %\" PRIu64 \")\",\n      CONFLICTS, solver->limits.restart.conflicts);\n    return true;\n  }\n\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 593, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1976}, "user": null, "metadata": {}}}, "error": null}
{"id": "batch_req_692225914f8c8190b7a54cbc75a90c75", "custom_id": "req-0010", "response": {"status_code": 200, "request_id": "2f70469d6978b058cd4478ec8ed0bb89", "body": {"id": "resp_067f2098b0982007006922253e0f588197bd4197e2c5595eb5", "object": "response", "created_at": 1763845438, "status": "completed", "background": false, "billing": {"payer": "developer"}, "error": null, "incomplete_details": null, "instructions": null, "max_output_tokens": null, "max_tool_calls": null, "model": "gpt-4.1-2025-04-14", "output": [{"id": "msg_067f2098b0982007006922253e4e6481978f40a4b9ff13ce87", "type": "message", "status": "completed", "content": [{"type": "output_text", "annotations": [], "logprobs": [], "text": "<code>\nbool kissat_restarting (kissat *solver) {\n  assert (solver->unassigned);\n  if (!GET_OPTION (restart))\n    return false;\n  if (!solver->level)\n    return false;\n\n  // Conflict limit trigger (lowest priority)\n  if (CONFLICTS >= solver->limits.restart.conflicts)\n    return true;\n\n  // Fetch relevant averages for the current stage\n  const bool stable = solver->stable;\n  const double fast_glue = solver->averages[stable].fast_glue.value;\n  const double slow_glue = solver->averages[stable].slow_glue.value;\n  const double decision_rate = solver->averages[stable].decision_rate.value;\n\n  // Maintain historical slow maximum for decision rate\n  double *max_decision_rate_ptr = &solver->averages[stable].decision_rate.max_value;\n  if (decision_rate > *max_decision_rate_ptr)\n    *max_decision_rate_ptr = decision_rate;\n  const double historical_max_decision_rate = *max_decision_rate_ptr;\n\n  // 1. Glue Spike: fast_glue > 1.1 * slow_glue\n  if (fast_glue > 1.1 * slow_glue) {\n    kissat_extremely_verbose (solver,\n      \"restart: glue spike (fast_glue %.2f > 1.1 * slow_glue %.2f)\",\n      fast_glue, slow_glue);\n    return true;\n  }\n\n  // 2. Stagnating decision rate: decision_rate < 0.75 * historical slow max\n  if (decision_rate < 0.75 * historical_max_decision_rate) {\n    kissat_extremely_verbose (solver,\n      \"restart: stagnating decision rate (decision_rate %.2f < 0.75 * max_decision_rate %.2f)\",\n      decision_rate, historical_max_decision_rate);\n    return true;\n  }\n\n  // 3. If in stable mode, apply the reluctant restart trigger\n  if (stable)\n    return kissat_reluctant_triggered (&solver->reluctant);\n\n  // No restart condition met\n  return false;\n}\n</code>"}], "role": "assistant"}], "parallel_tool_calls": true, "previous_response_id": null, "prompt_cache_key": null, "prompt_cache_retention": null, "reasoning": {"effort": null, "summary": null}, "safety_identifier": null, "service_tier": "default", "store": true, "temperature": 0.7, "text": {"format": {"type": "text"}, "verbosity": "medium"}, "tool_choice": "auto", "tools": [], "top_logprobs": 0, "top_p": 1.0, "truncation": "disabled", "usage": {"input_tokens": 1383, "input_tokens_details": {"cached_tokens": 0}, "output_tokens": 454, "output_tokens_details": {"reasoning_tokens": 0}, "total_tokens": 1837}, "user": null, "metadata": {}}}, "error": null}
